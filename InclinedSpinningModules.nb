(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    321626,       8093]
NotebookOptionsPosition[    318886,       8039]
NotebookOutlinePosition[    319353,       8057]
CellTagsIndexPosition[    319310,       8054]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 "Recall ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["Z", "in"], TraditionalForm]],ExpressionUUID->
  "4b7182d6-2fa9-4eb6-9840-81b426724afb"],
 " -> Z@\[Infinity] + Vice versa, following Scott\[CloseCurlyQuote]s 2000 \
paper"
}], "Text",
 CellChangeTimes->{{3.8654988434488506`*^9, 
  3.86549889308159*^9}},ExpressionUUID->"ecbcd7f2-558d-4e34-8a9c-\
1a49d73942f6"],

Cell[BoxData[
 RowBox[{"<<", "Teukolsky`"}]], "Input",
 CellChangeTimes->{{3.8630642816948104`*^9, 3.863064308110795*^9}, {
  3.8653991105220594`*^9, 
  3.865399116121131*^9}},ExpressionUUID->"164ca871-b8f6-4082-a520-\
06881cd4ed43"],

Cell[CellGroupData[{

Cell["1st term Stress-Energy (\[OpenCurlyDoubleQuote]Normal\
\[CloseCurlyDoubleQuote] term)", "Subsubsection",
 CellChangeTimes->{{3.8654002271715937`*^9, 3.8654002388157363`*^9}, {
  3.8654028385431643`*^9, 
  3.8654028498725348`*^9}},ExpressionUUID->"ffe987ed-03a8-41a4-b0f3-\
f49110920027"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Source1", "[", 
   RowBox[{"l_", ",", "m_", ",", "k_", ",", "orbit_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "a", ",", "r0", ",", "e", ",", "x", ",", "\[ScriptCapitalE]", ",", 
      "\[ScriptCapitalL]", ",", "\[ScriptCapitalQ]", ",", "\[Beta]", ",", 
      "zm", ",", "zp", ",", "\[Theta]", ",", "z", ",", "\[CapitalDelta]", ",",
       "\[CapitalSigma]", ",", "\[Rho]", ",", "\[Rho]b", ",", "ut", ",", 
      "\[CapitalTheta]", ",", "\[Chi]", ",", "CnnPlus", ",", "CnnMinus", ",", 
      "CnmPlus", ",", "CnmMinus", ",", "CmmPlus", ",", "CmmMinus", ",", 
      "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"Orbital", " ", "Params"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"a", "   ", "=", " ", 
      RowBox[{"orbit", "[", "\"\<a\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"r0", " ", "=", " ", 
      RowBox[{"orbit", "[", "\"\<p\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"e", "   ", "=", " ", 
      RowBox[{"orbit", "[", "\"\<Eccentricity\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"x", "   ", "=", " ", 
      RowBox[{"orbit", "[", "\"\<Inclination\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"Constants", " ", "of", " ", "motion"}], " ", "&"}], " ", 
       "Frequencies"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"\[ScriptCapitalE]", " ", "=", " ", 
      RowBox[{"orbit", "[", "\"\<Energy\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[ScriptCapitalL]", " ", "=", " ", 
      RowBox[{"orbit", "[", "\"\<AngularMomentum\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[ScriptCapitalQ]", " ", "=", " ", 
      RowBox[{"orbit", "[", "\"\<CarterConstant\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Definitions", " ", "and", " ", "reparameterisation"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"\[Beta]", "=", 
      RowBox[{
       SuperscriptBox["a", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SuperscriptBox["\[ScriptCapitalE]", "2"]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"zm", ",", "zp"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        FractionBox[
         RowBox[{
          SuperscriptBox["\[ScriptCapitalL]", "2"], "+", "\[ScriptCapitalQ]", 
          "+", "\[Beta]", "-", 
          RowBox[{"\[Beta]", " ", 
           SqrtBox[
            FractionBox[
             RowBox[{
              SuperscriptBox["\[ScriptCapitalL]", "4"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"\[ScriptCapitalQ]", "-", "\[Beta]"}], ")"}], "2"], 
              "+", 
              RowBox[{"2", " ", 
               SuperscriptBox["\[ScriptCapitalL]", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"\[ScriptCapitalQ]", "+", "\[Beta]"}], ")"}]}]}], 
             SuperscriptBox["\[Beta]", "2"]]]}]}], 
         RowBox[{"2", " ", "\[Beta]"}]], ",", 
        FractionBox[
         RowBox[{
          SuperscriptBox["\[ScriptCapitalL]", "2"], "+", "\[ScriptCapitalQ]", 
          "+", "\[Beta]", "+", 
          RowBox[{"\[Beta]", " ", 
           SqrtBox[
            FractionBox[
             RowBox[{
              SuperscriptBox["\[ScriptCapitalL]", "4"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"\[ScriptCapitalQ]", "-", "\[Beta]"}], ")"}], "2"], 
              "+", 
              RowBox[{"2", " ", 
               SuperscriptBox["\[ScriptCapitalL]", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"\[ScriptCapitalQ]", "+", "\[Beta]"}], ")"}]}]}], 
             SuperscriptBox["\[Beta]", "2"]]]}]}], 
         RowBox[{"2", " ", "\[Beta]"}]]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\[Theta]", "=", 
      RowBox[{"ArcCos", "[", 
       RowBox[{
        SqrtBox["zm"], " ", 
        RowBox[{"Cos", "[", "\[Chi]", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\[CapitalDelta]", "=", 
      RowBox[{
       SuperscriptBox["r0", "2"], "-", 
       RowBox[{"2", "r0"}], "+", 
       SuperscriptBox["a", "2"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[CapitalSigma]", "=", 
      RowBox[{
       SuperscriptBox["r0", "2"], "+", 
       RowBox[{
        SuperscriptBox["a", "2"], 
        SuperscriptBox[
         RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Rho]", "=", 
      FractionBox[
       RowBox[{"-", "1"}], 
       RowBox[{"r0", "-", 
        RowBox[{"I", " ", "a", " ", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Rho]b", "=", 
      FractionBox[
       RowBox[{"-", "1"}], 
       RowBox[{"r0", "+", 
        RowBox[{"I", " ", "a", " ", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}]]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"ut", "=", 
      RowBox[{
       FractionBox["1", "\[CapitalSigma]"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[ScriptCapitalE]", 
          RowBox[{"(", 
           RowBox[{
            FractionBox[
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["r0", "2"], "+", 
                SuperscriptBox["a", "2"]}], ")"}], "2"], "\[CapitalDelta]"], 
            "-", 
            RowBox[{
             SuperscriptBox["a", "2"], 
             SuperscriptBox[
              RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]}], ")"}]}], "+", 
         RowBox[{"a", " ", "\[ScriptCapitalL]", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            FractionBox[
             RowBox[{
              SuperscriptBox["r0", "2"], "+", 
              SuperscriptBox["a", "2"]}], "\[CapitalDelta]"]}], ")"}]}]}], 
        ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[CapitalTheta]", "=", 
      SqrtBox[
       RowBox[{"\[ScriptCapitalQ]", "-", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"Cot", "[", "\[Theta]", "]"}], "2"], 
         SuperscriptBox["\[ScriptCapitalL]", "2"]}], "-", 
        RowBox[{
         SuperscriptBox["a", "2"], 
         SuperscriptBox[
          RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           SuperscriptBox["\[ScriptCapitalE]", "2"]}], ")"}]}]}]]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Stress", " ", "energy", " ", "projected", " ", "onto", " ", "tetrad", 
       " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[PlusMinus]", "\[CapitalTheta]"}], " ", "for", " ", 
         "travelling", " ", "up", " ", "or", " ", "down"}], ")"}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       SubscriptBox["C", "ab"], " ", "to", " ", "be", " ", "replaced", " ", 
       "by", " ", "Josh"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"CnnPlus", "=", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"4", " ", 
         SuperscriptBox["\[CapitalSigma]", "3"], "ut"}]], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[ScriptCapitalE]", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["r0", "2"], "+", 
             SuperscriptBox["a", "2"]}], ")"}]}], "-", 
          RowBox[{"a", " ", "\[ScriptCapitalL]"}]}], ")"}], "2"]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"CnmPlus", "=", 
      RowBox[{
       FractionBox["\[Rho]", 
        RowBox[{"2", 
         SqrtBox["2"], 
         SuperscriptBox["\[CapitalSigma]", "2"], "ut"}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[ScriptCapitalE]", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["r0", "2"], "+", 
            SuperscriptBox["a", "2"]}], ")"}]}], "-", 
         RowBox[{"a", " ", "\[ScriptCapitalL]"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"I", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a", " ", "\[ScriptCapitalE]"}], "-", 
            FractionBox["\[ScriptCapitalL]", 
             SuperscriptBox[
              RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]]}], ")"}]}], "+", 
         " ", "\[CapitalTheta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"CmmPlus", "=", 
      RowBox[{
       FractionBox[
        SuperscriptBox["\[Rho]", "2"], 
        RowBox[{"2", "\[CapitalSigma]", " ", "ut"}]], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"I", " ", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"a", " ", "\[ScriptCapitalE]"}], "-", 
             FractionBox["\[ScriptCapitalL]", 
              SuperscriptBox[
               RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]]}], ")"}]}], "+", 
          " ", "\[CapitalTheta]"}], ")"}], "2"]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"CnnMinus", "=", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"4", " ", 
         SuperscriptBox["\[CapitalSigma]", "3"], "ut"}]], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[ScriptCapitalE]", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["r0", "2"], "+", 
             SuperscriptBox["a", "2"]}], ")"}]}], "-", 
          RowBox[{"a", " ", "\[ScriptCapitalL]"}]}], ")"}], "2"]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"CnmMinus", "=", 
      RowBox[{
       FractionBox["\[Rho]", 
        RowBox[{"2", 
         SqrtBox["2"], 
         SuperscriptBox["\[CapitalSigma]", "2"], "ut"}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[ScriptCapitalE]", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["r0", "2"], "+", 
            SuperscriptBox["a", "2"]}], ")"}]}], "-", 
         RowBox[{"a", " ", "\[ScriptCapitalL]"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"I", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a", " ", "\[ScriptCapitalE]"}], "-", 
            FractionBox["\[ScriptCapitalL]", 
             SuperscriptBox[
              RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]]}], ")"}]}], "-", 
         " ", "\[CapitalTheta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"CmmMinus", "=", 
      RowBox[{
       FractionBox[
        SuperscriptBox["\[Rho]", "2"], 
        RowBox[{"2", "\[CapitalSigma]", " ", "ut"}]], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"I", " ", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"a", " ", "\[ScriptCapitalE]"}], "-", 
             FractionBox["\[ScriptCapitalL]", 
              SuperscriptBox[
               RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]]}], ")"}]}], "-", 
          " ", "\[CapitalTheta]"}], ")"}], "2"]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Rewriting", " ", "source"}], "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"assoc", " ", "=", " ", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<l\>\"", "->", "l"}], ",", 
        RowBox[{"\"\<m\>\"", "->", "m"}], ",", 
        RowBox[{"\"\<k\>\"", "->", "k"}], ",", 
        RowBox[{"\"\<Orbit\>\"", "->", "orbit"}], ",", 
        RowBox[{"\"\<Cnn+\>\"", "->", "CnnPlus"}], ",", 
        RowBox[{"\"\<Cnn-\>\"", "->", "CnnMinus"}], ",", 
        RowBox[{"\"\<Cnm+\>\"", "->", "CnmPlus"}], ",", 
        RowBox[{"\"\<Cnm-\>\"", "->", "CnmMinus"}], ",", 
        RowBox[{"\"\<Cmm+\>\"", "->", "CmmPlus"}], ",", 
        RowBox[{"\"\<Cmm-\>\"", "->", "CmmMinus"}], ",", 
        RowBox[{"\"\<\[Chi]\>\"", "->", "\[Chi]"}]}], "|>"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.863064392688677*^9, 3.863064407539926*^9}, {
   3.8630644384479046`*^9, 3.8630645730536547`*^9}, {3.8630647327124577`*^9, 
   3.863065010967542*^9}, {3.863065595137276*^9, 3.8630657256165733`*^9}, {
   3.8630659328082924`*^9, 3.863066078780984*^9}, {3.863066286367327*^9, 
   3.8630664628716264`*^9}, {3.86306652610196*^9, 3.8630665698176208`*^9}, {
   3.8630666112779694`*^9, 3.8630667320621233`*^9}, {3.863066796329895*^9, 
   3.8630668951959147`*^9}, {3.8630670912329826`*^9, 3.8630671051992865`*^9}, 
   3.8630682128098726`*^9, 3.86539916495327*^9, {3.8653991954138117`*^9, 
   3.865399208534622*^9}, 
   3.865400198828169*^9},ExpressionUUID->"5174a2c4-79fb-432f-acbe-\
f3cff5cf3533"]
}, Open  ]],

Cell[CellGroupData[{

Cell["1st Term Convolution (\[OpenCurlyDoubleQuote]Normal\
\[CloseCurlyDoubleQuote] term)", "Subsubsection",
 CellChangeTimes->{{3.865400312322049*^9, 3.8654003163014383`*^9}, {
  3.8654003548487973`*^9, 3.865400355408903*^9}, {3.865402924718504*^9, 
  3.8654029446003027`*^9}},ExpressionUUID->"275a2d89-4f47-4862-85e4-\
6732839700a1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Convolver1", "[", "source_", "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "l", ",", "m", ",", "k", ",", "orbit", ",", "a", ",", "r0", ",", "e", 
      ",", "x", ",", "\[ScriptCapitalE]", ",", "\[ScriptCapitalL]", ",", 
      "\[ScriptCapitalQ]", ",", "\[Beta]", ",", "\[Gamma]", ",", "\[Delta]", 
      ",", "zm", ",", "zp", ",", "\[Theta]", ",", "z", ",", "\[CapitalDelta]",
       ",", "\[CapitalSigma]", ",", "\[Rho]", ",", "\[Rho]b", ",", 
      "\[CapitalOmega]\[Theta]", ",", "\[CapitalOmega]\[Phi]", ",", 
      "T\[Theta]", ",", "\[Omega]", ",", "S", ",", "Ld2S", ",", "Ld1Ld2S", 
      ",", "Kf", ",", "dK\[CapitalDelta]", ",", "ut", ",", "\[CapitalTheta]", 
      ",", "\[Chi]", ",", "t0", ",", "t0\[Pi]2", ",", "t0\[Chi]m\[Pi]2", ",", 
      "\[Phi]0", ",", "\[Phi]0\[Pi]2", ",", "\[Phi]0\[Chi]m\[Pi]2", ",", 
      "CnnPlus", ",", "CnnMinus", ",", "CnmPlus", ",", "CnmMinus", ",", 
      "CmmPlus", ",", "CmmMinus", ",", "Ann0Plus", ",", "Anm0Plus", ",", 
      "Amm0Plus", ",", "Anm1Plus", ",", "Amm1Plus", ",", "Amm2Plus", ",", 
      "Ann0Minus", ",", "Anm0Minus", ",", "Amm0Minus", ",", "Anm1Minus", ",", 
      "Amm1Minus", ",", "Amm2Minus", ",", "R", ",", "Rin", ",", "Rup", ",", 
      "Const", ",", "IUpPlus", ",", "IUpMinus", ",", "IInPlus", ",", 
      "IInMinus", ",", "Zin", ",", "Zup", ",", "assoc", ",", " ", 
      "amplitudes", ",", "eval", ",", "Bin", ",", "Bhole", ",", "\[Sigma]"}], 
     "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
      "Print", "[", "\"\<Getting l, m, k, orbital params, constants\>\"", 
       "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"l", " ", "=", " ", 
      RowBox[{"source", "[", "\"\<l\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"m", " ", "=", " ", 
      RowBox[{"source", "[", "\"\<m\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"k", " ", "=", " ", 
      RowBox[{"source", "[", "\"\<k\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"orbit", " ", "=", " ", 
      RowBox[{"source", "[", "\"\<Orbit\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Chi]", " ", "=", " ", 
      RowBox[{"source", "[", "\"\<\[Chi]\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"a", "   ", "=", " ", 
      RowBox[{"orbit", "[", "\"\<a\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"r0", " ", "=", " ", 
      RowBox[{"orbit", "[", "\"\<p\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"e", "   ", "=", " ", 
      RowBox[{"orbit", "[", "\"\<e\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"x", "   ", "=", " ", 
      RowBox[{"orbit", "[", "\"\<Inclination\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"StringJoin", "[", 
         RowBox[{"\"\<a = \>\"", ",", 
          RowBox[{"ToString", "[", "a", "]"}], ",", "\"\<, r0 = \>\"", ",", 
          RowBox[{"ToString", "[", "r0", "]"}], ",", "\"\<, e = \>\"", ",", 
          RowBox[{"ToString", "[", "e", "]"}], ",", "\"\<, x = \>\"", ",", 
          RowBox[{"ToString", "[", "x", "]"}]}], "]"}], "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"Constants", " ", "of", " ", "motion"}], " ", "&"}], " ", 
       "Frequencies"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"\[ScriptCapitalE]", " ", "=", " ", 
      RowBox[{"orbit", "[", "\"\<Energy\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[ScriptCapitalL]", " ", "=", " ", 
      RowBox[{"orbit", "[", "\"\<AngularMomentum\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[ScriptCapitalQ]", " ", "=", " ", 
      RowBox[{"orbit", "[", "\"\<CarterConstant\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"StringJoin", "[", 
         RowBox[{"\"\<Energy = \>\"", ",", 
          RowBox[{"ToString", "[", "\[ScriptCapitalE]", "]"}], ",", 
          "\"\<, Angular Momentum = \>\"", ",", 
          RowBox[{"ToString", "[", "\[ScriptCapitalL]", "]"}], ",", 
          "\"\<, Carter constant = \>\"", ",", 
          RowBox[{"ToString", "[", "\[ScriptCapitalQ]", "]"}]}], "]"}], "]"}],
        ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "\"\<Calculating Frequencies\>\"", "]"}], ";"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[CapitalOmega]\[Theta]", ",", "\[CapitalOmega]\[Phi]"}], 
       "}"}], "=", 
      RowBox[{
       RowBox[{"Values", "[", 
        RowBox[{"KerrGeoFrequencies", "[", 
         RowBox[{"a", ",", "r0", ",", "e", ",", "x"}], "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"2", ";;", "3"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"T\[Theta]", " ", "=", " ", 
      FractionBox[
       RowBox[{"2", "\[Pi]"}], "\[CapitalOmega]\[Theta]"]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Omega]", " ", "=", " ", 
      RowBox[{
       RowBox[{"m", " ", "\[CapitalOmega]\[Phi]"}], " ", "+", " ", 
       RowBox[{"k", " ", "\[CapitalOmega]\[Theta]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Sigma]", " ", "=", 
      RowBox[{".7", " ", 
       RowBox[{"Precision", "[", "\[Omega]", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"StringJoin", "[", 
         RowBox[{"\"\<\[CapitalOmega]\[Theta] = \>\"", ",", 
          RowBox[{"ToString", "[", "\[CapitalOmega]\[Theta]", "]"}], ",", 
          "\"\<, \[CapitalOmega]\[Phi] = \>\"", ",", 
          RowBox[{"ToString", "[", "\[CapitalOmega]\[Phi]", "]"}], ",", 
          "\"\<, \[Omega] = \>\"", ",", 
          RowBox[{"ToString", "[", "\[Omega]", "]"}]}], "]"}], "]"}], ";"}], 
      "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"\[CapitalDelta]", "=", 
      RowBox[{
       SuperscriptBox["r0", "2"], "-", 
       RowBox[{"2", "r0"}], "+", 
       SuperscriptBox["a", "2"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[CapitalSigma]", "=", 
      RowBox[{
       SuperscriptBox["r0", "2"], "+", 
       RowBox[{
        SuperscriptBox["a", "2"], 
        SuperscriptBox[
         RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Rho]", "=", 
      FractionBox[
       RowBox[{"-", "1"}], 
       RowBox[{"r0", "-", 
        RowBox[{"I", " ", "a", " ", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Rho]b", "=", 
      FractionBox[
       RowBox[{"-", "1"}], 
       RowBox[{"r0", "+", 
        RowBox[{"I", " ", "a", " ", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Beta]", "=", 
      RowBox[{
       SuperscriptBox["a", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SuperscriptBox["\[ScriptCapitalE]", "2"]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]", " ", "=", " ", 
      RowBox[{
       RowBox[{"\[ScriptCapitalE]", " ", 
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["r0", "2"], "+", 
              SuperscriptBox["a", "2"]}], ")"}], "2"], "\[CapitalDelta]"], 
          "-", 
          SuperscriptBox["a", "2"]}], ")"}]}], "+", 
       RowBox[{"a", " ", "\[ScriptCapitalL]", " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          FractionBox[
           RowBox[{
            SuperscriptBox["r0", "2"], "+", 
            SuperscriptBox["a", "2"]}], "\[CapitalDelta]"]}], ")"}]}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"\[Delta]", " ", "=", " ", 
      RowBox[{
       RowBox[{"a", " ", "\[ScriptCapitalE]", 
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           RowBox[{
            SuperscriptBox["r0", "2"], "+", 
            SuperscriptBox["a", "2"]}], "\[CapitalDelta]"], "-", "1"}], 
         ")"}]}], "-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["a", "2"], "\[ScriptCapitalL]"}], 
        "\[CapitalDelta]"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"zm", ",", "zp"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        FractionBox[
         RowBox[{
          SuperscriptBox["\[ScriptCapitalL]", "2"], "+", "\[ScriptCapitalQ]", 
          "+", "\[Beta]", "-", 
          RowBox[{"\[Beta]", " ", 
           SqrtBox[
            FractionBox[
             RowBox[{
              SuperscriptBox["\[ScriptCapitalL]", "4"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"\[ScriptCapitalQ]", "-", "\[Beta]"}], ")"}], "2"], 
              "+", 
              RowBox[{"2", " ", 
               SuperscriptBox["\[ScriptCapitalL]", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"\[ScriptCapitalQ]", "+", "\[Beta]"}], ")"}]}]}], 
             SuperscriptBox["\[Beta]", "2"]]]}]}], 
         RowBox[{"2", " ", "\[Beta]"}]], ",", 
        FractionBox[
         RowBox[{
          SuperscriptBox["\[ScriptCapitalL]", "2"], "+", "\[ScriptCapitalQ]", 
          "+", "\[Beta]", "+", 
          RowBox[{"\[Beta]", " ", 
           SqrtBox[
            FractionBox[
             RowBox[{
              SuperscriptBox["\[ScriptCapitalL]", "4"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"\[ScriptCapitalQ]", "-", "\[Beta]"}], ")"}], "2"], 
              "+", 
              RowBox[{"2", " ", 
               SuperscriptBox["\[ScriptCapitalL]", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"\[ScriptCapitalQ]", "+", "\[Beta]"}], ")"}]}]}], 
             SuperscriptBox["\[Beta]", "2"]]]}]}], 
         RowBox[{"2", " ", "\[Beta]"}]]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"z", "=", 
      RowBox[{"zm", " ", 
       SuperscriptBox[
        RowBox[{"Cos", "[", "\[Chi]", "]"}], "2"]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Theta]", "=", 
      RowBox[{"ArcCos", "[", 
       RowBox[{
        SqrtBox["zm"], " ", 
        RowBox[{"Cos", "[", "\[Chi]", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"t0", "[", "\[Chi]", "]"}], "/", 
       RowBox[{"\[Phi]0", "[", "\[Chi]", "]"}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"t0", "=", 
      RowBox[{
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"zm", "-", 
           RowBox[{"2", " ", "zp"}], "+", 
           RowBox[{"zm", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "\[Chi]"}], "]"}]}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"zm", "-", "zp"}], ")"}]}], "]"}], " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"a", "^", "2"}], " ", 
           RowBox[{"(", 
            RowBox[{"zm", "-", "zp"}], ")"}], " ", "\[ScriptCapitalE]", " ", 
           RowBox[{"EllipticE", "[", 
            RowBox[{"\[Chi]", ",", 
             RowBox[{"zm", "/", 
              RowBox[{"(", 
               RowBox[{"zm", "-", "zp"}], ")"}]}]}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"a", "^", "2"}], " ", "zp", " ", "\[ScriptCapitalE]"}], 
             "+", "\[Gamma]"}], ")"}], " ", 
           RowBox[{"EllipticF", "[", 
            RowBox[{"\[Chi]", ",", 
             RowBox[{"zm", "/", 
              RowBox[{"(", 
               RowBox[{"zm", "-", "zp"}], ")"}]}]}], "]"}]}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"Sqrt", "[", 
          RowBox[{
           RowBox[{"-", "\[Beta]"}], " ", 
           RowBox[{"(", 
            RowBox[{"zm", "-", 
             RowBox[{"2", " ", "zp"}], "+", 
             RowBox[{"zm", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"2", " ", "\[Chi]"}], "]"}]}]}], ")"}]}], "]"}], 
         ")"}]}]}]}], ";", "\n", "     ", 
     RowBox[{"\[Phi]0", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"zm", "-", 
             RowBox[{"2", " ", "zp"}], "+", 
             RowBox[{"zm", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"2", " ", "\[Chi]"}], "]"}]}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"zm", "-", "zp"}], ")"}]}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "zm"}], ")"}], " ", "\[Delta]", " ", 
            RowBox[{"EllipticF", "[", 
             RowBox[{"\[Chi]", ",", 
              RowBox[{"zm", "/", 
               RowBox[{"(", 
                RowBox[{"zm", "-", "zp"}], ")"}]}]}], "]"}]}], "-", 
           RowBox[{"\[ScriptCapitalL]", " ", 
            RowBox[{"EllipticPi", "[", 
             RowBox[{
              RowBox[{"zm", "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "zm"}], ")"}]}], ",", "\[Chi]", ",", 
              RowBox[{"zm", "/", 
               RowBox[{"(", 
                RowBox[{"zm", "-", "zp"}], ")"}]}]}], "]"}]}]}], ")"}]}], 
        ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "zm"}], ")"}], " ", 
         RowBox[{"Sqrt", "[", 
          RowBox[{
           RowBox[{"-", "\[Beta]"}], " ", 
           RowBox[{"(", 
            RowBox[{"zm", "-", 
             RowBox[{"2", " ", "zp"}], "+", 
             RowBox[{"zm", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"2", " ", "\[Chi]"}], "]"}]}]}], ")"}]}], "]"}]}], 
        ")"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "Print", "[", 
        "\"\<Calculating Homogeneous Radial Solution, and SWSH\>\"", "]"}], 
       ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"R", " ", "=", " ", 
      RowBox[{"TeukolskyRadial", "[", 
       RowBox[{
        RowBox[{"-", "2"}], ",", "l", ",", "m", ",", "a", ",", "\[Omega]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Rup", " ", "=", " ", 
      RowBox[{"R", "[", "\"\<Up\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Rin", " ", "=", " ", 
      RowBox[{"R", "[", "\"\<In\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Bin", " ", "=", " ", 
      RowBox[{
       RowBox[{"Rin", "[", "\"\<Amplitudes\>\"", "]"}], "[", 
       "\"\<Incidence\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Bhole", " ", "=", " ", 
      RowBox[{
       RowBox[{"Rin", "[", "\"\<Amplitudes\>\"", "]"}], "[", 
       "\"\<Reflection\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Const", " ", "=", 
      RowBox[{"2", "I", " ", "\[Omega]", " ", "Bin"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"eval", " ", "=", " ", 
      RowBox[{"Rup", "[", "\"\<Eigenvalue\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"S", "  ", "=", " ", 
      RowBox[{"SpinWeightedSpheroidalHarmonicS", "[", 
       RowBox[{
        RowBox[{"-", "2"}], ",", "l", ",", "m", ",", 
        RowBox[{"a", " ", "\[Omega]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Ld2S", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Derivative", "[", 
          RowBox[{"1", ",", "0"}], "]"}], "[", "S", "]"}], "[", 
        RowBox[{"\[Theta]", ",", "0"}], "]"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", " ", "m"}], " ", 
           RowBox[{"Csc", "[", "\[Theta]", "]"}]}], "+", 
          RowBox[{"a", " ", "\[Omega]", " ", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"Cot", "[", "\[Theta]", "]"}]}]}], ")"}], 
        RowBox[{"S", "[", 
         RowBox[{"\[Theta]", ",", "0"}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Ld1Ld2S", " ", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Derivative", "[", 
          RowBox[{"2", ",", "0"}], "]"}], "[", "S", "]"}], "[", 
        RowBox[{"\[Theta]", ",", "0"}], "]"}], " ", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", " ", "m"}], " ", 
           RowBox[{"Csc", "[", "\[Theta]", "]"}]}], "+", 
          RowBox[{"a", " ", "\[Omega]", " ", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"Cot", "[", "\[Theta]", "]"}]}]}], ")"}], 
        RowBox[{
         RowBox[{
          RowBox[{"Derivative", "[", 
           RowBox[{"1", ",", "0"}], "]"}], "[", "S", "]"}], "[", 
         RowBox[{"\[Theta]", ",", "0"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", " ", "\[Omega]", " ", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", " ", 
          RowBox[{"m", " ", 
           RowBox[{"Cot", "[", "\[Theta]", "]"}], 
           RowBox[{"Csc", "[", "\[Theta]", "]"}]}], "-", 
          RowBox[{"2", 
           SuperscriptBox[
            RowBox[{"Csc", "[", "\[Theta]", "]"}], "2"]}]}], ")"}], 
        RowBox[{"S", "[", 
         RowBox[{"\[Theta]", ",", "0"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", " ", "m"}], " ", 
           RowBox[{"Csc", "[", "\[Theta]", "]"}]}], "+", 
          RowBox[{"a", " ", "\[Omega]", " ", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "+", " ", 
          RowBox[{"Cot", "[", "\[Theta]", "]"}]}], ")"}], "Ld2S"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Kf", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["r0", "2"], "+", 
          SuperscriptBox["a", "2"]}], ")"}], "\[Omega]"}], "-", 
       RowBox[{"m", " ", "a"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dK\[CapitalDelta]", "=", 
      FractionBox[
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", " ", "m", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "r0"}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["a", "2"], " ", "\[Omega]"}], "-", 
          RowBox[{
           SuperscriptBox["r0", "2"], " ", "\[Omega]"}]}], ")"}]}], 
       SuperscriptBox["\[CapitalDelta]", "2"]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "Print", "[", "\"\<Retrieving Stress-energy information\>\"", "]"}], 
       ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"CnnPlus", "=", 
      RowBox[{"source", "[", "\"\<Cnn+\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"CnmPlus", "=", 
      RowBox[{"source", "[", "\"\<Cnm+\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"CmmPlus", "=", 
      RowBox[{"source", "[", "\"\<Cmm+\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"CnnMinus", "=", 
      RowBox[{"source", "[", "\"\<Cnn-\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"CnmMinus", "=", 
      RowBox[{"source", "[", "\"\<Cnm-\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"CmmMinus", "=", 
      RowBox[{"source", "[", "\"\<Cmm-\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "Print", "[", 
        "\"\<Calculating \!\(\*SubscriptBox[\(A\), \(abi\)]\) terms\>\"", 
        "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Ann0Plus", "=", " ", 
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"-", "2"}], " ", 
         SuperscriptBox["\[Rho]", 
          RowBox[{"-", "3"}]], 
         SuperscriptBox["\[Rho]b", 
          RowBox[{"-", "1"}]], "CnnPlus"}], 
        SuperscriptBox["\[CapitalDelta]", "2"]], 
       RowBox[{"(", 
        RowBox[{"Ld1Ld2S", "+", 
         RowBox[{"2", "I", " ", "a", " ", "\[Rho]", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}], "Ld2S"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Anm0Plus", "=", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"2", 
          SqrtBox["2"], 
          SuperscriptBox["\[Rho]", 
           RowBox[{"-", "3"}]], " ", "CnmPlus"}], "\[CapitalDelta]"]}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            FractionBox[
             RowBox[{"I", " ", "Kf"}], "\[CapitalDelta]"], "-", "\[Rho]", "-",
             "\[Rho]b"}], ")"}], "Ld2S"}], "-", 
         RowBox[{
          FractionBox[
           RowBox[{" ", "Kf"}], "\[CapitalDelta]"], "a", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}], 
          RowBox[{"S", "[", 
           RowBox[{"\[Theta]", ",", "0"}], "]"}], 
          RowBox[{"(", 
           RowBox[{"\[Rho]", "-", "\[Rho]b"}], ")"}]}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Amm0Plus", "=", 
      RowBox[{
       RowBox[{"S", "[", 
        RowBox[{"\[Theta]", ",", "0"}], "]"}], 
       SuperscriptBox["\[Rho]", 
        RowBox[{"-", "3"}]], "\[Rho]b", " ", "CmmPlus", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           FractionBox["Kf", "\[CapitalDelta]"], ")"}], "2"], "+", 
         RowBox[{"2", "I", " ", "\[Rho]", 
          FractionBox["Kf", "\[CapitalDelta]"]}], "+", 
         RowBox[{"I", " ", "dK\[CapitalDelta]"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Anm1Plus", "=", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"2", 
          SqrtBox["2"], 
          SuperscriptBox["\[Rho]", 
           RowBox[{"-", "3"}]], "CnmPlus"}], "\[CapitalDelta]"]}], 
       RowBox[{"(", 
        RowBox[{"Ld2S", "+", 
         RowBox[{"I", " ", "a", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}], 
          RowBox[{"(", 
           RowBox[{"\[Rho]", "-", "\[Rho]b"}], ")"}], 
          RowBox[{"S", "[", 
           RowBox[{"\[Theta]", ",", "0"}], "]"}]}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Amm1Plus", "=", 
      RowBox[{"2", 
       RowBox[{"S", "[", 
        RowBox[{"\[Theta]", ",", "0"}], "]"}], 
       SuperscriptBox["\[Rho]", 
        RowBox[{"-", "3"}]], "\[Rho]b", " ", "CmmPlus", 
       RowBox[{"(", 
        RowBox[{"\[Rho]", "-", 
         FractionBox[
          RowBox[{"I", " ", "Kf"}], "\[CapitalDelta]"]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Amm2Plus", "=", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"S", "[", 
         RowBox[{"\[Theta]", ",", "0"}], "]"}]}], 
       SuperscriptBox["\[Rho]", 
        RowBox[{"-", "3"}]], "\[Rho]b", " ", "CmmPlus"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Ann0Minus", "=", " ", 
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"-", "2"}], " ", 
         SuperscriptBox["\[Rho]", 
          RowBox[{"-", "3"}]], 
         SuperscriptBox["\[Rho]b", 
          RowBox[{"-", "1"}]], "CnnMinus"}], 
        SuperscriptBox["\[CapitalDelta]", "2"]], 
       RowBox[{"(", 
        RowBox[{"Ld1Ld2S", "+", 
         RowBox[{"2", "I", " ", "a", " ", "\[Rho]", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}], "Ld2S"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Anm0Minus", "=", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"2", 
          SqrtBox["2"], 
          SuperscriptBox["\[Rho]", 
           RowBox[{"-", "3"}]], " ", "CnmMinus"}], "\[CapitalDelta]"]}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            FractionBox[
             RowBox[{"I", " ", "Kf"}], "\[CapitalDelta]"], "-", "\[Rho]", "-",
             "\[Rho]b"}], ")"}], "Ld2S"}], "-", 
         RowBox[{
          FractionBox[
           RowBox[{" ", "Kf"}], "\[CapitalDelta]"], "a", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}], 
          RowBox[{"S", "[", 
           RowBox[{"\[Theta]", ",", "0"}], "]"}], 
          RowBox[{"(", 
           RowBox[{"\[Rho]", "-", "\[Rho]b"}], ")"}]}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Amm0Minus", "=", 
      RowBox[{
       RowBox[{"S", "[", 
        RowBox[{"\[Theta]", ",", "0"}], "]"}], 
       SuperscriptBox["\[Rho]", 
        RowBox[{"-", "3"}]], "\[Rho]b", " ", "CmmMinus", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           FractionBox["Kf", "\[CapitalDelta]"], ")"}], "2"], "+", 
         RowBox[{"2", "I", " ", "\[Rho]", 
          FractionBox["Kf", "\[CapitalDelta]"]}], "+", 
         RowBox[{"I", " ", "dK\[CapitalDelta]"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Anm1Minus", "=", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"2", 
          SqrtBox["2"], 
          SuperscriptBox["\[Rho]", 
           RowBox[{"-", "3"}]], "CnmMinus"}], "\[CapitalDelta]"]}], 
       RowBox[{"(", 
        RowBox[{"Ld2S", "+", 
         RowBox[{"I", " ", "a", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}], 
          RowBox[{"(", 
           RowBox[{"\[Rho]", "-", "\[Rho]b"}], ")"}], 
          RowBox[{"S", "[", 
           RowBox[{"\[Theta]", ",", "0"}], "]"}]}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Amm1Minus", "=", 
      RowBox[{"2", 
       RowBox[{"S", "[", 
        RowBox[{"\[Theta]", ",", "0"}], "]"}], 
       SuperscriptBox["\[Rho]", 
        RowBox[{"-", "3"}]], "\[Rho]b", " ", "CmmMinus", 
       RowBox[{"(", 
        RowBox[{"\[Rho]", "-", 
         FractionBox[
          RowBox[{"I", " ", "Kf"}], "\[CapitalDelta]"]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Amm2Minus", "=", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"S", "[", 
         RowBox[{"\[Theta]", ",", "0"}], "]"}]}], 
       SuperscriptBox["\[Rho]", 
        RowBox[{"-", "3"}]], "\[Rho]b", " ", "CmmMinus"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "\"\<Preparing integrand\>\"", "]"}], ";"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"IUpPlus", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Rup", "[", "r0", "]"}], 
        RowBox[{"(", 
         RowBox[{
         "Ann0Plus", " ", "+", " ", "Anm0Plus", " ", "+", " ", "Amm0Plus"}], 
         ")"}]}], "-", 
       RowBox[{
        RowBox[{
         RowBox[{"Rup", "'"}], "[", "r0", "]"}], 
        RowBox[{"(", 
         RowBox[{"Anm1Plus", "+", "Amm1Plus"}], ")"}]}], "+", 
       RowBox[{
        RowBox[{
         RowBox[{"Rup", "''"}], "[", "r0", "]"}], "Amm2Plus"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"IUpMinus", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Rup", "[", "r0", "]"}], 
        RowBox[{"(", 
         RowBox[{
         "Ann0Minus", " ", "+", " ", "Anm0Minus", " ", "+", " ", 
          "Amm0Minus"}], ")"}]}], "-", 
       RowBox[{
        RowBox[{
         RowBox[{"Rup", "'"}], "[", "r0", "]"}], 
        RowBox[{"(", 
         RowBox[{"Anm1Minus", "+", "Amm1Minus"}], ")"}]}], "+", 
       RowBox[{
        RowBox[{
         RowBox[{"Rup", "''"}], "[", "r0", "]"}], "Amm2Minus"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"IInPlus", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Rin", "[", "r0", "]"}], 
        RowBox[{"(", 
         RowBox[{
         "Ann0Plus", " ", "+", " ", "Anm0Plus", " ", "+", " ", "Amm0Plus"}], 
         ")"}]}], "-", 
       RowBox[{
        RowBox[{
         RowBox[{"Rin", "'"}], "[", "r0", "]"}], 
        RowBox[{"(", 
         RowBox[{"Anm1Plus", "+", "Amm1Plus"}], ")"}]}], "+", 
       RowBox[{
        RowBox[{
         RowBox[{"Rin", "''"}], "[", "r0", "]"}], "Amm2Plus"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"IInMinus", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Rin", "[", "r0", "]"}], 
        RowBox[{"(", 
         RowBox[{
         "Ann0Minus", " ", "+", " ", "Anm0Minus", " ", "+", " ", 
          "Amm0Minus"}], ")"}]}], "-", 
       RowBox[{
        RowBox[{
         RowBox[{"Rin", "'"}], "[", "r0", "]"}], 
        RowBox[{"(", 
         RowBox[{"Anm1Minus", "+", "Amm1Minus"}], ")"}]}], "+", 
       RowBox[{
        RowBox[{
         RowBox[{"Rin", "''"}], "[", "r0", "]"}], "Amm2Minus"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "\"\<Integrating\>\"", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Zin", " ", "=", " ", 
      RowBox[{"Quiet", "[", 
       RowBox[{
        FractionBox["1", "Const"], 
        FractionBox[
         RowBox[{"2", "\[Pi]"}], "T\[Theta]"], 
        RowBox[{"(", 
         RowBox[{"NIntegrate", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              FractionBox[
               RowBox[{"\[Gamma]", "+", 
                RowBox[{
                 SuperscriptBox["a", "2"], "\[ScriptCapitalE]", " ", "z"}]}], 
               SqrtBox[
                RowBox[{"\[Beta]", 
                 RowBox[{"(", 
                  RowBox[{"zp", "-", "z"}], ")"}]}]]], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SuperscriptBox["E", 
                  RowBox[{"I", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Omega]", " ", "t0"}], "-", 
                    RowBox[{"m", " ", "\[Phi]0"}]}], ")"}]}]], "IInPlus"}], 
                "+", 
                RowBox[{
                 SuperscriptBox["E", 
                  RowBox[{
                   RowBox[{"-", "I"}], 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Omega]", " ", "t0"}], "-", 
                    RowBox[{"m", " ", "\[Phi]0"}]}], ")"}]}]], "IInMinus"}]}],
                ")"}]}], ")"}], "/.", 
            RowBox[{"{", 
             RowBox[{"\[Chi]", "->", "\[Chi]0"}], "}"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Chi]0", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
           RowBox[{"WorkingPrecision", "\[Rule]", "\[Sigma]"}]}], "]"}], 
         RowBox[{"(*", 
          RowBox[{"+", 
           RowBox[{"NIntegrate", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                FractionBox[
                 RowBox[{"\[Gamma]", "+", 
                  RowBox[{
                   SuperscriptBox["a", "2"], "\[ScriptCapitalE]", " ", 
                   "z"}]}], 
                 SqrtBox[
                  RowBox[{"\[Beta]", 
                   RowBox[{"(", 
                    RowBox[{"zp", "-", "z"}], ")"}]}]]], 
                SuperscriptBox["E", 
                 RowBox[{
                  RowBox[{"-", "I"}], 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"\[Omega]", " ", "t0"}], "-", 
                    RowBox[{"m", " ", "\[Phi]0"}]}], ")"}]}]], "IInMinus"}], 
               ")"}], "/.", 
              RowBox[{"{", 
               RowBox[{"\[Chi]", "->", "\[Chi]0"}], "}"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Chi]0", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
             RowBox[{"WorkingPrecision", "\[Rule]", "\[Sigma]"}]}], "]"}]}], 
          "*)"}], 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
            RowBox[{"+", 
             SuperscriptBox["E", 
              RowBox[{"I", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"\[Omega]", " ", "t0\[Pi]2"}], "-", 
                 RowBox[{"m", " ", "\[Phi]0\[Pi]2"}]}], ")"}]}]]}], 
            RowBox[{"NIntegrate", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{"\[Gamma]", "+", 
                   RowBox[{
                    SuperscriptBox["a", "2"], "\[ScriptCapitalE]", " ", 
                    "z"}]}], 
                  SqrtBox[
                   RowBox[{"\[Beta]", 
                    RowBox[{"(", 
                    RowBox[{"zp", "-", "z"}], ")"}]}]]], 
                 SuperscriptBox["E", 
                  RowBox[{"I", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Omega]", " ", "t0\[Chi]m\[Pi]2"}], "-", 
                    RowBox[{"m", " ", "\[Phi]0\[Chi]m\[Pi]2"}]}], ")"}]}]], 
                 "IInPlus"}], ")"}], "/.", 
               RowBox[{"{", 
                RowBox[{"\[Chi]", "->", "\[Chi]0"}], "}"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"\[Chi]0", ",", 
                FractionBox["\[Pi]", "2"], ",", "\[Pi]"}], "}"}], ",", 
              RowBox[{"WorkingPrecision", "\[Rule]", "\[Sigma]"}]}], "]"}]}], 
           "+", 
           RowBox[{
            SuperscriptBox["E", 
             RowBox[{
              RowBox[{"-", "I"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[Omega]", " ", "t0\[Pi]2"}], "-", 
                RowBox[{"m", " ", "\[Phi]0\[Pi]2"}]}], ")"}]}]], 
            RowBox[{"NIntegrate", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{"\[Gamma]", "+", 
                   RowBox[{
                    SuperscriptBox["a", "2"], "\[ScriptCapitalE]", " ", 
                    "z"}]}], 
                  SqrtBox[
                   RowBox[{"\[Beta]", 
                    RowBox[{"(", 
                    RowBox[{"zp", "-", "z"}], ")"}]}]]], 
                 SuperscriptBox["E", 
                  RowBox[{
                   RowBox[{"-", "I"}], 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Omega]", " ", "t0\[Chi]m\[Pi]2"}], "-", 
                    RowBox[{"m", " ", "\[Phi]0\[Chi]m\[Pi]2"}]}], ")"}]}]], 
                 "IInMinus"}], ")"}], "/.", 
               RowBox[{"{", 
                RowBox[{"\[Chi]", "->", "\[Chi]0"}], "}"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"\[Chi]0", ",", 
                FractionBox["\[Pi]", "2"], ",", "\[Pi]"}], "}"}], ",", 
              RowBox[{"WorkingPrecision", "\[Rule]", "\[Sigma]"}]}], 
             "]"}]}]}], "*)"}], ")"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Zup", " ", "=", " ", 
      RowBox[{"Quiet", "[", 
       RowBox[{
        FractionBox["1", "Const"], 
        FractionBox[
         RowBox[{"2", "\[Pi]"}], "T\[Theta]"], 
        RowBox[{"(", 
         RowBox[{"NIntegrate", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              FractionBox[
               RowBox[{"\[Gamma]", "+", 
                RowBox[{
                 SuperscriptBox["a", "2"], "\[ScriptCapitalE]", " ", "z"}]}], 
               SqrtBox[
                RowBox[{"\[Beta]", 
                 RowBox[{"(", 
                  RowBox[{"zp", "-", "z"}], ")"}]}]]], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SuperscriptBox["E", 
                  RowBox[{"I", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Omega]", " ", "t0"}], "-", 
                    RowBox[{"m", " ", "\[Phi]0"}]}], ")"}]}]], "IUpPlus"}], 
                "+", 
                RowBox[{
                 SuperscriptBox["E", 
                  RowBox[{
                   RowBox[{"-", "I"}], 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Omega]", " ", "t0"}], "-", 
                    RowBox[{"m", " ", "\[Phi]0"}]}], ")"}]}]], "IUpMinus"}]}],
                ")"}]}], ")"}], "/.", 
            RowBox[{"{", 
             RowBox[{"\[Chi]", "->", "\[Chi]0"}], "}"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Chi]0", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
           RowBox[{"WorkingPrecision", "\[Rule]", "\[Sigma]"}]}], "]"}], 
         RowBox[{"(*", 
          RowBox[{"+", 
           RowBox[{"NIntegrate", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                FractionBox[
                 RowBox[{"\[Gamma]", "+", 
                  RowBox[{
                   SuperscriptBox["a", "2"], "\[ScriptCapitalE]", " ", 
                   "z"}]}], 
                 SqrtBox[
                  RowBox[{"\[Beta]", 
                   RowBox[{"(", 
                    RowBox[{"zp", "-", "z"}], ")"}]}]]], 
                SuperscriptBox["E", 
                 RowBox[{
                  RowBox[{"-", "I"}], 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"\[Omega]", " ", "t0"}], "-", 
                    RowBox[{"m", " ", "\[Phi]0"}]}], ")"}]}]], "IUpMinus"}], 
               ")"}], "/.", 
              RowBox[{"{", 
               RowBox[{"\[Chi]", "->", "\[Chi]0"}], "}"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Chi]0", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
             RowBox[{"WorkingPrecision", "\[Rule]", "\[Sigma]"}]}], "]"}]}], 
          "*)"}], 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
            RowBox[{"+", 
             SuperscriptBox["E", 
              RowBox[{"I", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"\[Omega]", " ", "t0\[Pi]2"}], "-", 
                 RowBox[{"m", " ", "\[Phi]0\[Pi]2"}]}], ")"}]}]]}], 
            RowBox[{"NIntegrate", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{"\[Gamma]", "+", 
                   RowBox[{
                    SuperscriptBox["a", "2"], "\[ScriptCapitalE]", " ", 
                    "z"}]}], 
                  SqrtBox[
                   RowBox[{"\[Beta]", 
                    RowBox[{"(", 
                    RowBox[{"zp", "-", "z"}], ")"}]}]]], 
                 SuperscriptBox["E", 
                  RowBox[{"I", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Omega]", " ", "t0\[Chi]m\[Pi]2"}], "-", 
                    RowBox[{"m", " ", "\[Phi]0\[Chi]m\[Pi]2"}]}], ")"}]}]], 
                 "IUpPlus"}], ")"}], "/.", 
               RowBox[{"{", 
                RowBox[{"\[Chi]", "->", "\[Chi]0"}], "}"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"\[Chi]0", ",", 
                FractionBox["\[Pi]", "2"], ",", "\[Pi]"}], "}"}], ",", 
              RowBox[{"WorkingPrecision", "\[Rule]", "\[Sigma]"}]}], "]"}]}], 
           "+", 
           RowBox[{
            SuperscriptBox["E", 
             RowBox[{
              RowBox[{"-", "I"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[Omega]", " ", "t0\[Pi]2"}], "-", 
                RowBox[{"m", " ", "\[Phi]0\[Pi]2"}]}], ")"}]}]], 
            RowBox[{"NIntegrate", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{"\[Gamma]", "+", 
                   RowBox[{
                    SuperscriptBox["a", "2"], "\[ScriptCapitalE]", " ", 
                    "z"}]}], 
                  SqrtBox[
                   RowBox[{"\[Beta]", 
                    RowBox[{"(", 
                    RowBox[{"zp", "-", "z"}], ")"}]}]]], 
                 SuperscriptBox["E", 
                  RowBox[{
                   RowBox[{"-", "I"}], 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Omega]", " ", "t0\[Chi]m\[Pi]2"}], "-", 
                    RowBox[{"m", " ", "\[Phi]0\[Chi]m\[Pi]2"}]}], ")"}]}]], 
                 "IUpMinus"}], ")"}], "/.", 
               RowBox[{"{", 
                RowBox[{"\[Chi]", "->", "\[Chi]0"}], "}"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"\[Chi]0", ",", 
                FractionBox["\[Pi]", "2"], ",", "\[Pi]"}], "}"}], ",", 
              RowBox[{"WorkingPrecision", "\[Rule]", "\[Sigma]"}]}], 
             "]"}]}]}], "*)"}], ")"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"amplitudes", " ", "=", " ", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<\[ScriptCapitalI]\>\"", "->", "Zin"}], ",", 
        RowBox[{"\"\<\[ScriptCapitalH]\>\"", "->", "Zup"}]}], "|>"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"assoc", " ", "=", " ", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<l\>\"", "->", "l"}], ",", 
        RowBox[{"\"\<m\>\"", "->", "m"}], ",", 
        RowBox[{"\"\<k\>\"", "->", "k"}], ",", 
        RowBox[{"\"\<\[Omega]\>\"", "->", "\[Omega]"}], ",", 
        RowBox[{"\"\<Eigenvalue\>\"", "->", "eval"}], ",", " ", 
        RowBox[{"\"\<Orbit\>\"", "->", "orbit"}], ",", " ", 
        RowBox[{"\"\<Amplitudes\>\"", "->", "amplitudes"}]}], "|>"}]}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.863064392688677*^9, 3.8630644321799965`*^9}, {
   3.8630664684735265`*^9, 3.8630665183028584`*^9}, {3.8630665528830776`*^9, 
   3.8630665884999046`*^9}, 3.863066635902318*^9, 3.8630666792159247`*^9, {
   3.863067189225557*^9, 3.8630672384371624`*^9}, 3.863067275299808*^9, {
   3.86306730638356*^9, 3.8630674580903645`*^9}, {3.8630674976397486`*^9, 
   3.8630676785692396`*^9}, {3.8630677489235706`*^9, 
   3.8630678181629267`*^9}, {3.863067849955527*^9, 3.8630678519500203`*^9}, {
   3.8630678824147377`*^9, 3.863068172950236*^9}, {3.863068219150898*^9, 
   3.8630682604208226`*^9}, {3.8630684235914*^9, 3.8630685404537597`*^9}, {
   3.863068575129217*^9, 3.8630688440729036`*^9}, {3.8630689345192795`*^9, 
   3.863068974643854*^9}, {3.863069023305098*^9, 3.8630690539257383`*^9}, {
   3.863069468962616*^9, 3.863069603529193*^9}, 3.863069668608444*^9, {
   3.86306971383498*^9, 3.863069786577263*^9}, {3.863069835576913*^9, 
   3.863069963714973*^9}, {3.863070002189682*^9, 3.863070128074911*^9}, 
   3.8630703069492626`*^9, 3.863070337806199*^9, {3.8630703935871997`*^9, 
   3.863070524108426*^9}, {3.8630706197810955`*^9, 3.8630707301722617`*^9}, {
   3.8630707939797115`*^9, 3.8630707967605567`*^9}, {3.8630708734442744`*^9, 
   3.86307093550029*^9}, 3.8630710579715023`*^9, {3.863071294576641*^9, 
   3.863071336027204*^9}, {3.8630804946490984`*^9, 3.863080499058425*^9}, {
   3.863080559742588*^9, 3.8630805739910603`*^9}, {3.8630807687734413`*^9, 
   3.863080804531021*^9}, {3.8630821052165427`*^9, 3.863082199249623*^9}, {
   3.863082229400874*^9, 3.8630822316161633`*^9}, {3.863082769148796*^9, 
   3.863082783162854*^9}, {3.863083478012878*^9, 3.8630835286484513`*^9}, 
   3.8630842261809263`*^9, {3.8630873848220634`*^9, 3.863087454599044*^9}, {
   3.863087488366107*^9, 3.863087506902504*^9}, {3.863087582841058*^9, 
   3.8630875832900925`*^9}, {3.863087783174302*^9, 3.8630878001995387`*^9}, {
   3.863089936549639*^9, 3.8630899509174767`*^9}, {3.8630912421019773`*^9, 
   3.8630912471100216`*^9}, 3.863153507448406*^9, 3.863153609375703*^9, 
   3.863153642952876*^9, 3.86315520073193*^9, {3.8631552391393485`*^9, 
   3.863155258679782*^9}, {3.8631575336988363`*^9, 3.8631575937423697`*^9}, 
   3.8631752807750883`*^9, {3.8631755578527217`*^9, 3.8631755597710066`*^9}, {
   3.8631756020498424`*^9, 3.863175606386402*^9}, {3.863599131205424*^9, 
   3.8635991390654335`*^9}, {3.8636002885523453`*^9, 3.86360029067037*^9}, {
   3.8636004059795303`*^9, 3.863600415250534*^9}, {3.8636004725983553`*^9, 
   3.86360047577489*^9}, {3.8636037639761333`*^9, 3.8636038007051473`*^9}, {
   3.863603867502675*^9, 3.8636038835401077`*^9}, {3.8636732824677873`*^9, 
   3.8636732853960876`*^9}, {3.863673322291748*^9, 3.8636733298601136`*^9}, {
   3.8636743566289825`*^9, 3.8636743706025968`*^9}, {3.8636744046275496`*^9, 
   3.8636744188062267`*^9}, {3.8636744514546833`*^9, 3.8636744603389006`*^9}, 
   3.8653995948064113`*^9, {3.8653996769864783`*^9, 3.865399715023604*^9}, 
   3.8654003280161753`*^9, 3.8654144811107073`*^9, {3.8654987647645574`*^9, 
   3.8654987656604614`*^9}, {3.8654987986846867`*^9, 3.865498799182976*^9}, {
   3.8662753401618223`*^9, 
   3.866275344689164*^9}},ExpressionUUID->"6ac2a461-428a-44f6-a4a4-\
a405bac3aa14"]
}, Open  ]],

Cell[CellGroupData[{

Cell["2nd Term Stress-Energy (\[OpenCurlyDoubleQuote]\[Phi]\
\[CloseCurlyDoubleQuote] term)", "Subsubsection",
 CellChangeTimes->{{3.8654002454759917`*^9, 3.8654002516807947`*^9}, {
  3.8654028533277783`*^9, 
  3.86540286189021*^9}},ExpressionUUID->"0a279877-a40b-4778-aed3-\
118a411b2399"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Source2", "[", 
   RowBox[{"l_", ",", "m_", ",", "k_", ",", "orbit_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "a", ",", "r0", ",", "e", ",", "x", ",", "\[ScriptCapitalE]", ",", 
      "\[ScriptCapitalL]", ",", "\[ScriptCapitalQ]", ",", "\[Beta]", ",", 
      "zm", ",", "zp", ",", "\[Theta]", ",", "z", ",", "\[CapitalDelta]", ",",
       "\[CapitalSigma]", ",", "\[Rho]", ",", "\[Rho]b", ",", "ut", ",", 
      "\[CapitalTheta]", ",", "\[Chi]", ",", "CnnPlus", ",", "CnnMinus", ",", 
      "CnmPlus", ",", "CnmMinus", ",", "CmmPlus", ",", "CmmMinus", ",", 
      "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"Orbital", " ", "Params"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"a", "   ", "=", " ", 
      RowBox[{"orbit", "[", "\"\<a\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"r0", " ", "=", " ", 
      RowBox[{"orbit", "[", "\"\<p\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"e", "   ", "=", " ", 
      RowBox[{"orbit", "[", "\"\<Eccentricity\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"x", "   ", "=", " ", 
      RowBox[{"orbit", "[", "\"\<Inclination\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"Constants", " ", "of", " ", "motion"}], " ", "&"}], " ", 
       "Frequencies"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"\[ScriptCapitalE]", " ", "=", " ", 
      RowBox[{"orbit", "[", "\"\<Energy\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[ScriptCapitalL]", " ", "=", " ", 
      RowBox[{"orbit", "[", "\"\<AngularMomentum\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[ScriptCapitalQ]", " ", "=", " ", 
      RowBox[{"orbit", "[", "\"\<CarterConstant\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Definitions", " ", "and", " ", "reparameterisation"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"\[Beta]", "=", 
      RowBox[{
       SuperscriptBox["a", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SuperscriptBox["\[ScriptCapitalE]", "2"]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"zm", ",", "zp"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        FractionBox[
         RowBox[{
          SuperscriptBox["\[ScriptCapitalL]", "2"], "+", "\[ScriptCapitalQ]", 
          "+", "\[Beta]", "-", 
          RowBox[{"\[Beta]", " ", 
           SqrtBox[
            FractionBox[
             RowBox[{
              SuperscriptBox["\[ScriptCapitalL]", "4"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"\[ScriptCapitalQ]", "-", "\[Beta]"}], ")"}], "2"], 
              "+", 
              RowBox[{"2", " ", 
               SuperscriptBox["\[ScriptCapitalL]", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"\[ScriptCapitalQ]", "+", "\[Beta]"}], ")"}]}]}], 
             SuperscriptBox["\[Beta]", "2"]]]}]}], 
         RowBox[{"2", " ", "\[Beta]"}]], ",", 
        FractionBox[
         RowBox[{
          SuperscriptBox["\[ScriptCapitalL]", "2"], "+", "\[ScriptCapitalQ]", 
          "+", "\[Beta]", "+", 
          RowBox[{"\[Beta]", " ", 
           SqrtBox[
            FractionBox[
             RowBox[{
              SuperscriptBox["\[ScriptCapitalL]", "4"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"\[ScriptCapitalQ]", "-", "\[Beta]"}], ")"}], "2"], 
              "+", 
              RowBox[{"2", " ", 
               SuperscriptBox["\[ScriptCapitalL]", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"\[ScriptCapitalQ]", "+", "\[Beta]"}], ")"}]}]}], 
             SuperscriptBox["\[Beta]", "2"]]]}]}], 
         RowBox[{"2", " ", "\[Beta]"}]]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\[Theta]", "=", 
      RowBox[{"ArcCos", "[", 
       RowBox[{
        SqrtBox["zm"], " ", 
        RowBox[{"Cos", "[", "\[Chi]", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\[CapitalDelta]", "=", 
      RowBox[{
       SuperscriptBox["r0", "2"], "-", 
       RowBox[{"2", "r0"}], "+", 
       SuperscriptBox["a", "2"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[CapitalSigma]", "=", 
      RowBox[{
       SuperscriptBox["r0", "2"], "+", 
       RowBox[{
        SuperscriptBox["a", "2"], 
        SuperscriptBox[
         RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Rho]", "=", 
      FractionBox[
       RowBox[{"-", "1"}], 
       RowBox[{"r0", "-", 
        RowBox[{"I", " ", "a", " ", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Rho]b", "=", 
      FractionBox[
       RowBox[{"-", "1"}], 
       RowBox[{"r0", "+", 
        RowBox[{"I", " ", "a", " ", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}]]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"ut", "=", 
      RowBox[{
       FractionBox["1", "\[CapitalSigma]"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[ScriptCapitalE]", 
          RowBox[{"(", 
           RowBox[{
            FractionBox[
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["r0", "2"], "+", 
                SuperscriptBox["a", "2"]}], ")"}], "2"], "\[CapitalDelta]"], 
            "-", 
            RowBox[{
             SuperscriptBox["a", "2"], 
             SuperscriptBox[
              RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]}], ")"}]}], "+", 
         RowBox[{"a", " ", "\[ScriptCapitalL]", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            FractionBox[
             RowBox[{
              SuperscriptBox["r0", "2"], "+", 
              SuperscriptBox["a", "2"]}], "\[CapitalDelta]"]}], ")"}]}]}], 
        ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[CapitalTheta]", "=", 
      SqrtBox[
       RowBox[{"\[ScriptCapitalQ]", "-", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"Cot", "[", "\[Theta]", "]"}], "2"], 
         SuperscriptBox["\[ScriptCapitalL]", "2"]}], "-", 
        RowBox[{
         SuperscriptBox["a", "2"], 
         SuperscriptBox[
          RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           SuperscriptBox["\[ScriptCapitalE]", "2"]}], ")"}]}]}]]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Stress", " ", "energy", " ", "projected", " ", "onto", " ", "tetrad", 
       " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[PlusMinus]", "\[CapitalTheta]"}], " ", "for", " ", 
         "travelling", " ", "up", " ", "or", " ", "down"}], ")"}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       SubscriptBox["C", "ab"], " ", "to", " ", "be", " ", "replaced", " ", 
       "by", " ", "Josh"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"CnnPlus", "=", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"4", " ", 
         SuperscriptBox["\[CapitalSigma]", "3"], "ut"}]], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[ScriptCapitalE]", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["r0", "2"], "+", 
             SuperscriptBox["a", "2"]}], ")"}]}], "-", 
          RowBox[{"a", " ", "\[ScriptCapitalL]"}]}], ")"}], "2"]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"CnmPlus", "=", 
      RowBox[{
       FractionBox["\[Rho]", 
        RowBox[{"2", 
         SqrtBox["2"], 
         SuperscriptBox["\[CapitalSigma]", "2"], "ut"}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[ScriptCapitalE]", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["r0", "2"], "+", 
            SuperscriptBox["a", "2"]}], ")"}]}], "-", 
         RowBox[{"a", " ", "\[ScriptCapitalL]"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"I", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a", " ", "\[ScriptCapitalE]"}], "-", 
            FractionBox["\[ScriptCapitalL]", 
             SuperscriptBox[
              RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]]}], ")"}]}], "+", 
         " ", "\[CapitalTheta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"CmmPlus", "=", 
      RowBox[{
       FractionBox[
        SuperscriptBox["\[Rho]", "2"], 
        RowBox[{"2", "\[CapitalSigma]", " ", "ut"}]], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"I", " ", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"a", " ", "\[ScriptCapitalE]"}], "-", 
             FractionBox["\[ScriptCapitalL]", 
              SuperscriptBox[
               RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]]}], ")"}]}], "+", 
          " ", "\[CapitalTheta]"}], ")"}], "2"]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"CnnMinus", "=", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"4", " ", 
         SuperscriptBox["\[CapitalSigma]", "3"], "ut"}]], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[ScriptCapitalE]", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["r0", "2"], "+", 
             SuperscriptBox["a", "2"]}], ")"}]}], "-", 
          RowBox[{"a", " ", "\[ScriptCapitalL]"}]}], ")"}], "2"]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"CnmMinus", "=", 
      RowBox[{
       FractionBox["\[Rho]", 
        RowBox[{"2", 
         SqrtBox["2"], 
         SuperscriptBox["\[CapitalSigma]", "2"], "ut"}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[ScriptCapitalE]", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["r0", "2"], "+", 
            SuperscriptBox["a", "2"]}], ")"}]}], "-", 
         RowBox[{"a", " ", "\[ScriptCapitalL]"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"I", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a", " ", "\[ScriptCapitalE]"}], "-", 
            FractionBox["\[ScriptCapitalL]", 
             SuperscriptBox[
              RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]]}], ")"}]}], "-", 
         " ", "\[CapitalTheta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"CmmMinus", "=", 
      RowBox[{
       FractionBox[
        SuperscriptBox["\[Rho]", "2"], 
        RowBox[{"2", "\[CapitalSigma]", " ", "ut"}]], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"I", " ", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"a", " ", "\[ScriptCapitalE]"}], "-", 
             FractionBox["\[ScriptCapitalL]", 
              SuperscriptBox[
               RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]]}], ")"}]}], "-", 
          " ", "\[CapitalTheta]"}], ")"}], "2"]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Rewriting", " ", "source"}], "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"assoc", " ", "=", " ", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<l\>\"", "->", "l"}], ",", 
        RowBox[{"\"\<m\>\"", "->", "m"}], ",", 
        RowBox[{"\"\<k\>\"", "->", "k"}], ",", 
        RowBox[{"\"\<Orbit\>\"", "->", "orbit"}], ",", 
        RowBox[{"\"\<Cnn+\>\"", "->", "CnnPlus"}], ",", 
        RowBox[{"\"\<Cnn-\>\"", "->", "CnnMinus"}], ",", 
        RowBox[{"\"\<Cnm+\>\"", "->", "CnmPlus"}], ",", 
        RowBox[{"\"\<Cnm-\>\"", "->", "CnmMinus"}], ",", 
        RowBox[{"\"\<Cmm+\>\"", "->", "CmmPlus"}], ",", 
        RowBox[{"\"\<Cmm-\>\"", "->", "CmmMinus"}], ",", 
        RowBox[{"\"\<\[Chi]\>\"", "->", "\[Chi]"}]}], "|>"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.865399621613571*^9, 
  3.865399621951419*^9}},ExpressionUUID->"2e5bebd0-f957-40b3-a833-\
19256ef4691a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["2nd Term Convolution (\[OpenCurlyDoubleQuote]\[Phi]\
\[CloseCurlyDoubleQuote] term)", "Subsubsection",
 CellChangeTimes->{{3.8654003321398687`*^9, 3.865400347006817*^9}, {
  3.865402951679491*^9, 
  3.865402959657445*^9}},ExpressionUUID->"ee314e84-787c-4545-af72-\
1cf992f2ee8b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Convolver2", "[", "source_", "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "l", ",", "m", ",", "k", ",", "orbit", ",", "a", ",", "r0", ",", "e", 
      ",", "x", ",", "\[ScriptCapitalE]", ",", "\[ScriptCapitalL]", ",", 
      "\[ScriptCapitalQ]", ",", "\[Beta]", ",", "\[Gamma]", ",", "\[Delta]", 
      ",", "zm", ",", "zp", ",", "\[Theta]", ",", "z", ",", "\[CapitalDelta]",
       ",", "\[CapitalSigma]", ",", "\[Rho]", ",", "\[Rho]b", ",", 
      "\[CapitalOmega]\[Theta]", ",", "\[CapitalOmega]\[Phi]", ",", 
      "T\[Theta]", ",", "\[Omega]", ",", "S", ",", "Ld2S", ",", "Ld1Ld2S", 
      ",", "Kf", ",", "dK\[CapitalDelta]", ",", "ut", ",", "\[CapitalTheta]", 
      ",", "\[Chi]", ",", "t0", ",", "t0\[Pi]2", ",", "t0\[Chi]m\[Pi]2", ",", 
      "\[Phi]0", ",", "\[Phi]0\[Pi]2", ",", "\[Phi]0\[Chi]m\[Pi]2", ",", 
      "CnnPlus", ",", "CnnMinus", ",", "CnmPlus", ",", "CnmMinus", ",", 
      "CmmPlus", ",", "CmmMinus", ",", "Ann0Plus", ",", "Anm0Plus", ",", 
      "Amm0Plus", ",", "Anm1Plus", ",", "Amm1Plus", ",", "Amm2Plus", ",", 
      "Ann0Minus", ",", "Anm0Minus", ",", "Amm0Minus", ",", "Anm1Minus", ",", 
      "Amm1Minus", ",", "Amm2Minus", ",", "R", ",", "Rin", ",", "Rup", ",", 
      "Const", ",", "IUpPlus", ",", "IUpMinus", ",", "IInPlus", ",", 
      "IInMinus", ",", "Zin", ",", "Zup", ",", "assoc", ",", " ", 
      "amplitudes", ",", "eval", ",", "Bin", ",", "Bhole", ",", "\[Sigma]"}], 
     "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
      "Print", "[", "\"\<Getting l, m, k, orbital params, constants\>\"", 
       "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"l", " ", "=", " ", 
      RowBox[{"source", "[", "\"\<l\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"m", " ", "=", " ", 
      RowBox[{"source", "[", "\"\<m\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"k", " ", "=", " ", 
      RowBox[{"source", "[", "\"\<k\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"orbit", " ", "=", " ", 
      RowBox[{"source", "[", "\"\<Orbit\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Chi]", " ", "=", " ", 
      RowBox[{"source", "[", "\"\<\[Chi]\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"a", "   ", "=", " ", 
      RowBox[{"orbit", "[", "\"\<a\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"r0", " ", "=", " ", 
      RowBox[{"orbit", "[", "\"\<p\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"e", "   ", "=", " ", 
      RowBox[{"orbit", "[", "\"\<e\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"x", "   ", "=", " ", 
      RowBox[{"orbit", "[", "\"\<Inclination\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"StringJoin", "[", 
         RowBox[{"\"\<a = \>\"", ",", 
          RowBox[{"ToString", "[", "a", "]"}], ",", "\"\<, r0 = \>\"", ",", 
          RowBox[{"ToString", "[", "r0", "]"}], ",", "\"\<, e = \>\"", ",", 
          RowBox[{"ToString", "[", "e", "]"}], ",", "\"\<, x = \>\"", ",", 
          RowBox[{"ToString", "[", "x", "]"}]}], "]"}], "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"Constants", " ", "of", " ", "motion"}], " ", "&"}], " ", 
       "Frequencies"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"\[ScriptCapitalE]", " ", "=", " ", 
      RowBox[{"orbit", "[", "\"\<Energy\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[ScriptCapitalL]", " ", "=", " ", 
      RowBox[{"orbit", "[", "\"\<AngularMomentum\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[ScriptCapitalQ]", " ", "=", " ", 
      RowBox[{"orbit", "[", "\"\<CarterConstant\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"StringJoin", "[", 
         RowBox[{"\"\<Energy = \>\"", ",", 
          RowBox[{"ToString", "[", "\[ScriptCapitalE]", "]"}], ",", 
          "\"\<, Angular Momentum = \>\"", ",", 
          RowBox[{"ToString", "[", "\[ScriptCapitalL]", "]"}], ",", 
          "\"\<, Carter constant = \>\"", ",", 
          RowBox[{"ToString", "[", "\[ScriptCapitalQ]", "]"}]}], "]"}], "]"}],
        ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "\"\<Calculating Frequencies\>\"", "]"}], ";"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[CapitalOmega]\[Theta]", ",", "\[CapitalOmega]\[Phi]"}], 
       "}"}], "=", 
      RowBox[{
       RowBox[{"Values", "[", 
        RowBox[{"KerrGeoFrequencies", "[", 
         RowBox[{"a", ",", "r0", ",", "e", ",", "x"}], "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"2", ";;", "3"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"T\[Theta]", " ", "=", " ", 
      FractionBox[
       RowBox[{"2", "\[Pi]"}], "\[CapitalOmega]\[Theta]"]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Omega]", " ", "=", " ", 
      RowBox[{
       RowBox[{"m", " ", "\[CapitalOmega]\[Phi]"}], " ", "+", " ", 
       RowBox[{"k", " ", "\[CapitalOmega]\[Theta]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Sigma]", " ", "=", 
      RowBox[{".7", " ", 
       RowBox[{"Precision", "[", "\[Omega]", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"StringJoin", "[", 
         RowBox[{"\"\<\[CapitalOmega]\[Theta] = \>\"", ",", 
          RowBox[{"ToString", "[", "\[CapitalOmega]\[Theta]", "]"}], ",", 
          "\"\<, \[CapitalOmega]\[Phi] = \>\"", ",", 
          RowBox[{"ToString", "[", "\[CapitalOmega]\[Phi]", "]"}], ",", 
          "\"\<, \[Omega] = \>\"", ",", 
          RowBox[{"ToString", "[", "\[Omega]", "]"}]}], "]"}], "]"}], ";"}], 
      "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"\[CapitalDelta]", "=", 
      RowBox[{
       SuperscriptBox["r0", "2"], "-", 
       RowBox[{"2", "r0"}], "+", 
       SuperscriptBox["a", "2"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[CapitalSigma]", "=", 
      RowBox[{
       SuperscriptBox["r0", "2"], "+", 
       RowBox[{
        SuperscriptBox["a", "2"], 
        SuperscriptBox[
         RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Rho]", "=", 
      FractionBox[
       RowBox[{"-", "1"}], 
       RowBox[{"r0", "-", 
        RowBox[{"I", " ", "a", " ", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Rho]b", "=", 
      FractionBox[
       RowBox[{"-", "1"}], 
       RowBox[{"r0", "+", 
        RowBox[{"I", " ", "a", " ", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Beta]", "=", 
      RowBox[{
       SuperscriptBox["a", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SuperscriptBox["\[ScriptCapitalE]", "2"]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]", " ", "=", " ", 
      RowBox[{
       RowBox[{"\[ScriptCapitalE]", " ", 
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["r0", "2"], "+", 
              SuperscriptBox["a", "2"]}], ")"}], "2"], "\[CapitalDelta]"], 
          "-", 
          SuperscriptBox["a", "2"]}], ")"}]}], "+", 
       RowBox[{"a", " ", "\[ScriptCapitalL]", " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          FractionBox[
           RowBox[{
            SuperscriptBox["r0", "2"], "+", 
            SuperscriptBox["a", "2"]}], "\[CapitalDelta]"]}], ")"}]}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"\[Delta]", " ", "=", " ", 
      RowBox[{
       RowBox[{"a", " ", "\[ScriptCapitalE]", 
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           RowBox[{
            SuperscriptBox["r0", "2"], "+", 
            SuperscriptBox["a", "2"]}], "\[CapitalDelta]"], "-", "1"}], 
         ")"}]}], "-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["a", "2"], "\[ScriptCapitalL]"}], 
        "\[CapitalDelta]"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"zm", ",", "zp"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        FractionBox[
         RowBox[{
          SuperscriptBox["\[ScriptCapitalL]", "2"], "+", "\[ScriptCapitalQ]", 
          "+", "\[Beta]", "-", 
          RowBox[{"\[Beta]", " ", 
           SqrtBox[
            FractionBox[
             RowBox[{
              SuperscriptBox["\[ScriptCapitalL]", "4"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"\[ScriptCapitalQ]", "-", "\[Beta]"}], ")"}], "2"], 
              "+", 
              RowBox[{"2", " ", 
               SuperscriptBox["\[ScriptCapitalL]", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"\[ScriptCapitalQ]", "+", "\[Beta]"}], ")"}]}]}], 
             SuperscriptBox["\[Beta]", "2"]]]}]}], 
         RowBox[{"2", " ", "\[Beta]"}]], ",", 
        FractionBox[
         RowBox[{
          SuperscriptBox["\[ScriptCapitalL]", "2"], "+", "\[ScriptCapitalQ]", 
          "+", "\[Beta]", "+", 
          RowBox[{"\[Beta]", " ", 
           SqrtBox[
            FractionBox[
             RowBox[{
              SuperscriptBox["\[ScriptCapitalL]", "4"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"\[ScriptCapitalQ]", "-", "\[Beta]"}], ")"}], "2"], 
              "+", 
              RowBox[{"2", " ", 
               SuperscriptBox["\[ScriptCapitalL]", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"\[ScriptCapitalQ]", "+", "\[Beta]"}], ")"}]}]}], 
             SuperscriptBox["\[Beta]", "2"]]]}]}], 
         RowBox[{"2", " ", "\[Beta]"}]]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"z", "=", 
      RowBox[{"zm", " ", 
       SuperscriptBox[
        RowBox[{"Cos", "[", "\[Chi]", "]"}], "2"]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Theta]", "=", 
      RowBox[{"ArcCos", "[", 
       RowBox[{
        SqrtBox["zm"], " ", 
        RowBox[{"Cos", "[", "\[Chi]", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"t0", "[", "\[Chi]", "]"}], "/", 
       RowBox[{"\[Phi]0", "[", "\[Chi]", "]"}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"t0", "=", 
      RowBox[{
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"zm", "-", 
           RowBox[{"2", " ", "zp"}], "+", 
           RowBox[{"zm", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "\[Chi]"}], "]"}]}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"zm", "-", "zp"}], ")"}]}], "]"}], " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"a", "^", "2"}], " ", 
           RowBox[{"(", 
            RowBox[{"zm", "-", "zp"}], ")"}], " ", "\[ScriptCapitalE]", " ", 
           RowBox[{"EllipticE", "[", 
            RowBox[{"\[Chi]", ",", 
             RowBox[{"zm", "/", 
              RowBox[{"(", 
               RowBox[{"zm", "-", "zp"}], ")"}]}]}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"a", "^", "2"}], " ", "zp", " ", "\[ScriptCapitalE]"}], 
             "+", "\[Gamma]"}], ")"}], " ", 
           RowBox[{"EllipticF", "[", 
            RowBox[{"\[Chi]", ",", 
             RowBox[{"zm", "/", 
              RowBox[{"(", 
               RowBox[{"zm", "-", "zp"}], ")"}]}]}], "]"}]}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"Sqrt", "[", 
          RowBox[{
           RowBox[{"-", "\[Beta]"}], " ", 
           RowBox[{"(", 
            RowBox[{"zm", "-", 
             RowBox[{"2", " ", "zp"}], "+", 
             RowBox[{"zm", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"2", " ", "\[Chi]"}], "]"}]}]}], ")"}]}], "]"}], 
         ")"}]}]}]}], ";", "\n", "     ", 
     RowBox[{"\[Phi]0", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"zm", "-", 
             RowBox[{"2", " ", "zp"}], "+", 
             RowBox[{"zm", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"2", " ", "\[Chi]"}], "]"}]}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"zm", "-", "zp"}], ")"}]}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "zm"}], ")"}], " ", "\[Delta]", " ", 
            RowBox[{"EllipticF", "[", 
             RowBox[{"\[Chi]", ",", 
              RowBox[{"zm", "/", 
               RowBox[{"(", 
                RowBox[{"zm", "-", "zp"}], ")"}]}]}], "]"}]}], "-", 
           RowBox[{"\[ScriptCapitalL]", " ", 
            RowBox[{"EllipticPi", "[", 
             RowBox[{
              RowBox[{"zm", "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "zm"}], ")"}]}], ",", "\[Chi]", ",", 
              RowBox[{"zm", "/", 
               RowBox[{"(", 
                RowBox[{"zm", "-", "zp"}], ")"}]}]}], "]"}]}]}], ")"}]}], 
        ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "zm"}], ")"}], " ", 
         RowBox[{"Sqrt", "[", 
          RowBox[{
           RowBox[{"-", "\[Beta]"}], " ", 
           RowBox[{"(", 
            RowBox[{"zm", "-", 
             RowBox[{"2", " ", "zp"}], "+", 
             RowBox[{"zm", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"2", " ", "\[Chi]"}], "]"}]}]}], ")"}]}], "]"}]}], 
        ")"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "Print", "[", 
        "\"\<Calculating Homogeneous Radial Solution, and SWSH\>\"", "]"}], 
       ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"R", " ", "=", " ", 
      RowBox[{"TeukolskyRadial", "[", 
       RowBox[{
        RowBox[{"-", "2"}], ",", "l", ",", "m", ",", "a", ",", "\[Omega]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Rup", " ", "=", " ", 
      RowBox[{"R", "[", "\"\<Up\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Rin", " ", "=", " ", 
      RowBox[{"R", "[", "\"\<In\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Bin", " ", "=", " ", 
      RowBox[{
       RowBox[{"Rin", "[", "\"\<Amplitudes\>\"", "]"}], "[", 
       "\"\<Incidence\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Bhole", " ", "=", " ", 
      RowBox[{
       RowBox[{"Rin", "[", "\"\<Amplitudes\>\"", "]"}], "[", 
       "\"\<Reflection\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Const", " ", "=", 
      RowBox[{"2", "I", " ", "\[Omega]", " ", "Bin"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"eval", " ", "=", " ", 
      RowBox[{"Rup", "[", "\"\<Eigenvalue\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"S", "  ", "=", " ", 
      RowBox[{"SpinWeightedSpheroidalHarmonicS", "[", 
       RowBox[{
        RowBox[{"-", "2"}], ",", "l", ",", "m", ",", 
        RowBox[{"a", " ", "\[Omega]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Ld2S", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Derivative", "[", 
          RowBox[{"1", ",", "0"}], "]"}], "[", "S", "]"}], "[", 
        RowBox[{"\[Theta]", ",", "0"}], "]"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", " ", "m"}], " ", 
           RowBox[{"Csc", "[", "\[Theta]", "]"}]}], "+", 
          RowBox[{"a", " ", "\[Omega]", " ", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"Cot", "[", "\[Theta]", "]"}]}]}], ")"}], 
        RowBox[{"S", "[", 
         RowBox[{"\[Theta]", ",", "0"}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Ld1Ld2S", " ", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Derivative", "[", 
          RowBox[{"2", ",", "0"}], "]"}], "[", "S", "]"}], "[", 
        RowBox[{"\[Theta]", ",", "0"}], "]"}], " ", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", " ", "m"}], " ", 
           RowBox[{"Csc", "[", "\[Theta]", "]"}]}], "+", 
          RowBox[{"a", " ", "\[Omega]", " ", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"Cot", "[", "\[Theta]", "]"}]}]}], ")"}], 
        RowBox[{
         RowBox[{
          RowBox[{"Derivative", "[", 
           RowBox[{"1", ",", "0"}], "]"}], "[", "S", "]"}], "[", 
         RowBox[{"\[Theta]", ",", "0"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", " ", "\[Omega]", " ", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", " ", 
          RowBox[{"m", " ", 
           RowBox[{"Cot", "[", "\[Theta]", "]"}], 
           RowBox[{"Csc", "[", "\[Theta]", "]"}]}], "-", 
          RowBox[{"2", 
           SuperscriptBox[
            RowBox[{"Csc", "[", "\[Theta]", "]"}], "2"]}]}], ")"}], 
        RowBox[{"S", "[", 
         RowBox[{"\[Theta]", ",", "0"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", " ", "m"}], " ", 
           RowBox[{"Csc", "[", "\[Theta]", "]"}]}], "+", 
          RowBox[{"a", " ", "\[Omega]", " ", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "+", " ", 
          RowBox[{"Cot", "[", "\[Theta]", "]"}]}], ")"}], "Ld2S"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Kf", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["r0", "2"], "+", 
          SuperscriptBox["a", "2"]}], ")"}], "\[Omega]"}], "-", 
       RowBox[{"m", " ", "a"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dK\[CapitalDelta]", "=", 
      FractionBox[
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", " ", "m", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "r0"}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["a", "2"], " ", "\[Omega]"}], "-", 
          RowBox[{
           SuperscriptBox["r0", "2"], " ", "\[Omega]"}]}], ")"}]}], 
       SuperscriptBox["\[CapitalDelta]", "2"]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "Print", "[", "\"\<Retrieving Stress-energy information\>\"", "]"}], 
       ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"CnnPlus", "=", 
      RowBox[{"source", "[", "\"\<Cnn+\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"CnmPlus", "=", 
      RowBox[{"source", "[", "\"\<Cnm+\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"CmmPlus", "=", 
      RowBox[{"source", "[", "\"\<Cmm+\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"CnnMinus", "=", 
      RowBox[{"source", "[", "\"\<Cnn-\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"CnmMinus", "=", 
      RowBox[{"source", "[", "\"\<Cnm-\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"CmmMinus", "=", 
      RowBox[{"source", "[", "\"\<Cmm-\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "Print", "[", 
        "\"\<Calculating \!\(\*SubscriptBox[\(A\), \(abi\)]\) terms\>\"", 
        "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Ann0Plus", "=", " ", 
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"-", "2"}], " ", 
         SuperscriptBox["\[Rho]", 
          RowBox[{"-", "3"}]], 
         SuperscriptBox["\[Rho]b", 
          RowBox[{"-", "1"}]], "CnnPlus"}], 
        SuperscriptBox["\[CapitalDelta]", "2"]], 
       RowBox[{"(", 
        RowBox[{"Ld1Ld2S", "+", 
         RowBox[{"2", "I", " ", "a", " ", "\[Rho]", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}], "Ld2S"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Anm0Plus", "=", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"2", 
          SqrtBox["2"], 
          SuperscriptBox["\[Rho]", 
           RowBox[{"-", "3"}]], " ", "CnmPlus"}], "\[CapitalDelta]"]}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            FractionBox[
             RowBox[{"I", " ", "Kf"}], "\[CapitalDelta]"], "-", "\[Rho]", "-",
             "\[Rho]b"}], ")"}], "Ld2S"}], "-", 
         RowBox[{
          FractionBox[
           RowBox[{" ", "Kf"}], "\[CapitalDelta]"], "a", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}], 
          RowBox[{"S", "[", 
           RowBox[{"\[Theta]", ",", "0"}], "]"}], 
          RowBox[{"(", 
           RowBox[{"\[Rho]", "-", "\[Rho]b"}], ")"}]}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Amm0Plus", "=", 
      RowBox[{
       RowBox[{"S", "[", 
        RowBox[{"\[Theta]", ",", "0"}], "]"}], 
       SuperscriptBox["\[Rho]", 
        RowBox[{"-", "3"}]], "\[Rho]b", " ", "CmmPlus", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           FractionBox["Kf", "\[CapitalDelta]"], ")"}], "2"], "+", 
         RowBox[{"2", "I", " ", "\[Rho]", 
          FractionBox["Kf", "\[CapitalDelta]"]}], "+", 
         RowBox[{"I", " ", "dK\[CapitalDelta]"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Anm1Plus", "=", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"2", 
          SqrtBox["2"], 
          SuperscriptBox["\[Rho]", 
           RowBox[{"-", "3"}]], "CnmPlus"}], "\[CapitalDelta]"]}], 
       RowBox[{"(", 
        RowBox[{"Ld2S", "+", 
         RowBox[{"I", " ", "a", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}], 
          RowBox[{"(", 
           RowBox[{"\[Rho]", "-", "\[Rho]b"}], ")"}], 
          RowBox[{"S", "[", 
           RowBox[{"\[Theta]", ",", "0"}], "]"}]}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Amm1Plus", "=", 
      RowBox[{"2", 
       RowBox[{"S", "[", 
        RowBox[{"\[Theta]", ",", "0"}], "]"}], 
       SuperscriptBox["\[Rho]", 
        RowBox[{"-", "3"}]], "\[Rho]b", " ", "CmmPlus", 
       RowBox[{"(", 
        RowBox[{"\[Rho]", "-", 
         FractionBox[
          RowBox[{"I", " ", "Kf"}], "\[CapitalDelta]"]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Amm2Plus", "=", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"S", "[", 
         RowBox[{"\[Theta]", ",", "0"}], "]"}]}], 
       SuperscriptBox["\[Rho]", 
        RowBox[{"-", "3"}]], "\[Rho]b", " ", "CmmPlus"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Ann0Minus", "=", " ", 
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"-", "2"}], " ", 
         SuperscriptBox["\[Rho]", 
          RowBox[{"-", "3"}]], 
         SuperscriptBox["\[Rho]b", 
          RowBox[{"-", "1"}]], "CnnMinus"}], 
        SuperscriptBox["\[CapitalDelta]", "2"]], 
       RowBox[{"(", 
        RowBox[{"Ld1Ld2S", "+", 
         RowBox[{"2", "I", " ", "a", " ", "\[Rho]", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}], "Ld2S"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Anm0Minus", "=", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"2", 
          SqrtBox["2"], 
          SuperscriptBox["\[Rho]", 
           RowBox[{"-", "3"}]], " ", "CnmMinus"}], "\[CapitalDelta]"]}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            FractionBox[
             RowBox[{"I", " ", "Kf"}], "\[CapitalDelta]"], "-", "\[Rho]", "-",
             "\[Rho]b"}], ")"}], "Ld2S"}], "-", 
         RowBox[{
          FractionBox[
           RowBox[{" ", "Kf"}], "\[CapitalDelta]"], "a", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}], 
          RowBox[{"S", "[", 
           RowBox[{"\[Theta]", ",", "0"}], "]"}], 
          RowBox[{"(", 
           RowBox[{"\[Rho]", "-", "\[Rho]b"}], ")"}]}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Amm0Minus", "=", 
      RowBox[{
       RowBox[{"S", "[", 
        RowBox[{"\[Theta]", ",", "0"}], "]"}], 
       SuperscriptBox["\[Rho]", 
        RowBox[{"-", "3"}]], "\[Rho]b", " ", "CmmMinus", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           FractionBox["Kf", "\[CapitalDelta]"], ")"}], "2"], "+", 
         RowBox[{"2", "I", " ", "\[Rho]", 
          FractionBox["Kf", "\[CapitalDelta]"]}], "+", 
         RowBox[{"I", " ", "dK\[CapitalDelta]"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Anm1Minus", "=", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"2", 
          SqrtBox["2"], 
          SuperscriptBox["\[Rho]", 
           RowBox[{"-", "3"}]], "CnmMinus"}], "\[CapitalDelta]"]}], 
       RowBox[{"(", 
        RowBox[{"Ld2S", "+", 
         RowBox[{"I", " ", "a", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}], 
          RowBox[{"(", 
           RowBox[{"\[Rho]", "-", "\[Rho]b"}], ")"}], 
          RowBox[{"S", "[", 
           RowBox[{"\[Theta]", ",", "0"}], "]"}]}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Amm1Minus", "=", 
      RowBox[{"2", 
       RowBox[{"S", "[", 
        RowBox[{"\[Theta]", ",", "0"}], "]"}], 
       SuperscriptBox["\[Rho]", 
        RowBox[{"-", "3"}]], "\[Rho]b", " ", "CmmMinus", 
       RowBox[{"(", 
        RowBox[{"\[Rho]", "-", 
         FractionBox[
          RowBox[{"I", " ", "Kf"}], "\[CapitalDelta]"]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Amm2Minus", "=", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"S", "[", 
         RowBox[{"\[Theta]", ",", "0"}], "]"}]}], 
       SuperscriptBox["\[Rho]", 
        RowBox[{"-", "3"}]], "\[Rho]b", " ", "CmmMinus"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "\"\<Preparing integrand\>\"", "]"}], ";"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"IUpPlus", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Rup", "[", "r0", "]"}], 
        RowBox[{"(", 
         RowBox[{
         "Ann0Plus", " ", "+", " ", "Anm0Plus", " ", "+", " ", "Amm0Plus"}], 
         ")"}]}], "-", 
       RowBox[{
        RowBox[{
         RowBox[{"Rup", "'"}], "[", "r0", "]"}], 
        RowBox[{"(", 
         RowBox[{"Anm1Plus", "+", "Amm1Plus"}], ")"}]}], "+", 
       RowBox[{
        RowBox[{
         RowBox[{"Rup", "''"}], "[", "r0", "]"}], "Amm2Plus"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"IUpMinus", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Rup", "[", "r0", "]"}], 
        RowBox[{"(", 
         RowBox[{
         "Ann0Minus", " ", "+", " ", "Anm0Minus", " ", "+", " ", 
          "Amm0Minus"}], ")"}]}], "-", 
       RowBox[{
        RowBox[{
         RowBox[{"Rup", "'"}], "[", "r0", "]"}], 
        RowBox[{"(", 
         RowBox[{"Anm1Minus", "+", "Amm1Minus"}], ")"}]}], "+", 
       RowBox[{
        RowBox[{
         RowBox[{"Rup", "''"}], "[", "r0", "]"}], "Amm2Minus"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"IInPlus", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Rin", "[", "r0", "]"}], 
        RowBox[{"(", 
         RowBox[{
         "Ann0Plus", " ", "+", " ", "Anm0Plus", " ", "+", " ", "Amm0Plus"}], 
         ")"}]}], "-", 
       RowBox[{
        RowBox[{
         RowBox[{"Rin", "'"}], "[", "r0", "]"}], 
        RowBox[{"(", 
         RowBox[{"Anm1Plus", "+", "Amm1Plus"}], ")"}]}], "+", 
       RowBox[{
        RowBox[{
         RowBox[{"Rin", "''"}], "[", "r0", "]"}], "Amm2Plus"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"IInMinus", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Rin", "[", "r0", "]"}], 
        RowBox[{"(", 
         RowBox[{
         "Ann0Minus", " ", "+", " ", "Anm0Minus", " ", "+", " ", 
          "Amm0Minus"}], ")"}]}], "-", 
       RowBox[{
        RowBox[{
         RowBox[{"Rin", "'"}], "[", "r0", "]"}], 
        RowBox[{"(", 
         RowBox[{"Anm1Minus", "+", "Amm1Minus"}], ")"}]}], "+", 
       RowBox[{
        RowBox[{
         RowBox[{"Rin", "''"}], "[", "r0", "]"}], "Amm2Minus"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "\"\<Integrating\>\"", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Zin", " ", "=", " ", 
      RowBox[{"Quiet", "[", 
       RowBox[{
        FractionBox[
         RowBox[{"I", " ", "m"}], "Const"], 
        FractionBox[
         RowBox[{"2", "\[Pi]"}], "T\[Theta]"], 
        RowBox[{"(", 
         RowBox[{"NIntegrate", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              FractionBox[
               RowBox[{"\[Gamma]", "+", 
                RowBox[{
                 SuperscriptBox["a", "2"], "\[ScriptCapitalE]", " ", "z"}]}], 
               SqrtBox[
                RowBox[{"\[Beta]", 
                 RowBox[{"(", 
                  RowBox[{"zp", "-", "z"}], ")"}]}]]], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SuperscriptBox["E", 
                  RowBox[{"I", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Omega]", " ", "t0"}], "-", 
                    RowBox[{"m", " ", "\[Phi]0"}]}], ")"}]}]], "IInPlus"}], 
                "+", 
                RowBox[{
                 SuperscriptBox["E", 
                  RowBox[{
                   RowBox[{"-", "I"}], 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Omega]", " ", "t0"}], "-", 
                    RowBox[{"m", " ", "\[Phi]0"}]}], ")"}]}]], "IInMinus"}]}],
                ")"}]}], ")"}], "/.", 
            RowBox[{"{", 
             RowBox[{"\[Chi]", "->", "\[Chi]0"}], "}"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Chi]0", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
           RowBox[{"WorkingPrecision", "\[Rule]", "\[Sigma]"}]}], "]"}], 
         RowBox[{"(*", 
          RowBox[{"+", 
           RowBox[{"NIntegrate", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                FractionBox[
                 RowBox[{"\[Gamma]", "+", 
                  RowBox[{
                   SuperscriptBox["a", "2"], "\[ScriptCapitalE]", " ", 
                   "z"}]}], 
                 SqrtBox[
                  RowBox[{"\[Beta]", 
                   RowBox[{"(", 
                    RowBox[{"zp", "-", "z"}], ")"}]}]]], 
                SuperscriptBox["E", 
                 RowBox[{
                  RowBox[{"-", "I"}], 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"\[Omega]", " ", "t0"}], "-", 
                    RowBox[{"m", " ", "\[Phi]0"}]}], ")"}]}]], "IInMinus"}], 
               ")"}], "/.", 
              RowBox[{"{", 
               RowBox[{"\[Chi]", "->", "\[Chi]0"}], "}"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Chi]0", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
             RowBox[{"WorkingPrecision", "\[Rule]", "\[Sigma]"}]}], "]"}]}], 
          "*)"}], 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
            RowBox[{"+", 
             SuperscriptBox["E", 
              RowBox[{"I", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"\[Omega]", " ", "t0\[Pi]2"}], "-", 
                 RowBox[{"m", " ", "\[Phi]0\[Pi]2"}]}], ")"}]}]]}], 
            RowBox[{"NIntegrate", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{"\[Gamma]", "+", 
                   RowBox[{
                    SuperscriptBox["a", "2"], "\[ScriptCapitalE]", " ", 
                    "z"}]}], 
                  SqrtBox[
                   RowBox[{"\[Beta]", 
                    RowBox[{"(", 
                    RowBox[{"zp", "-", "z"}], ")"}]}]]], 
                 SuperscriptBox["E", 
                  RowBox[{"I", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Omega]", " ", "t0\[Chi]m\[Pi]2"}], "-", 
                    RowBox[{"m", " ", "\[Phi]0\[Chi]m\[Pi]2"}]}], ")"}]}]], 
                 "IInPlus"}], ")"}], "/.", 
               RowBox[{"{", 
                RowBox[{"\[Chi]", "->", "\[Chi]0"}], "}"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"\[Chi]0", ",", 
                FractionBox["\[Pi]", "2"], ",", "\[Pi]"}], "}"}], ",", 
              RowBox[{"WorkingPrecision", "\[Rule]", "\[Sigma]"}]}], "]"}]}], 
           "+", 
           RowBox[{
            SuperscriptBox["E", 
             RowBox[{
              RowBox[{"-", "I"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[Omega]", " ", "t0\[Pi]2"}], "-", 
                RowBox[{"m", " ", "\[Phi]0\[Pi]2"}]}], ")"}]}]], 
            RowBox[{"NIntegrate", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{"\[Gamma]", "+", 
                   RowBox[{
                    SuperscriptBox["a", "2"], "\[ScriptCapitalE]", " ", 
                    "z"}]}], 
                  SqrtBox[
                   RowBox[{"\[Beta]", 
                    RowBox[{"(", 
                    RowBox[{"zp", "-", "z"}], ")"}]}]]], 
                 SuperscriptBox["E", 
                  RowBox[{
                   RowBox[{"-", "I"}], 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Omega]", " ", "t0\[Chi]m\[Pi]2"}], "-", 
                    RowBox[{"m", " ", "\[Phi]0\[Chi]m\[Pi]2"}]}], ")"}]}]], 
                 "IInMinus"}], ")"}], "/.", 
               RowBox[{"{", 
                RowBox[{"\[Chi]", "->", "\[Chi]0"}], "}"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"\[Chi]0", ",", 
                FractionBox["\[Pi]", "2"], ",", "\[Pi]"}], "}"}], ",", 
              RowBox[{"WorkingPrecision", "\[Rule]", "\[Sigma]"}]}], 
             "]"}]}]}], "*)"}], ")"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Zup", " ", "=", " ", 
      RowBox[{"Quiet", "[", 
       RowBox[{
        FractionBox[
         RowBox[{"I", " ", "m"}], "Const"], 
        FractionBox[
         RowBox[{"2", "\[Pi]"}], "T\[Theta]"], 
        RowBox[{"(", 
         RowBox[{"NIntegrate", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              FractionBox[
               RowBox[{"\[Gamma]", "+", 
                RowBox[{
                 SuperscriptBox["a", "2"], "\[ScriptCapitalE]", " ", "z"}]}], 
               SqrtBox[
                RowBox[{"\[Beta]", 
                 RowBox[{"(", 
                  RowBox[{"zp", "-", "z"}], ")"}]}]]], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SuperscriptBox["E", 
                  RowBox[{"I", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Omega]", " ", "t0"}], "-", 
                    RowBox[{"m", " ", "\[Phi]0"}]}], ")"}]}]], "IUpPlus"}], 
                "+", 
                RowBox[{
                 SuperscriptBox["E", 
                  RowBox[{
                   RowBox[{"-", "I"}], 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Omega]", " ", "t0"}], "-", 
                    RowBox[{"m", " ", "\[Phi]0"}]}], ")"}]}]], "IUpMinus"}]}],
                ")"}]}], ")"}], "/.", 
            RowBox[{"{", 
             RowBox[{"\[Chi]", "->", "\[Chi]0"}], "}"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Chi]0", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
           RowBox[{"WorkingPrecision", "\[Rule]", "\[Sigma]"}]}], "]"}], 
         RowBox[{"(*", 
          RowBox[{"+", 
           RowBox[{"NIntegrate", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                FractionBox[
                 RowBox[{"\[Gamma]", "+", 
                  RowBox[{
                   SuperscriptBox["a", "2"], "\[ScriptCapitalE]", " ", 
                   "z"}]}], 
                 SqrtBox[
                  RowBox[{"\[Beta]", 
                   RowBox[{"(", 
                    RowBox[{"zp", "-", "z"}], ")"}]}]]], 
                SuperscriptBox["E", 
                 RowBox[{
                  RowBox[{"-", "I"}], 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"\[Omega]", " ", "t0"}], "-", 
                    RowBox[{"m", " ", "\[Phi]0"}]}], ")"}]}]], "IUpMinus"}], 
               ")"}], "/.", 
              RowBox[{"{", 
               RowBox[{"\[Chi]", "->", "\[Chi]0"}], "}"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Chi]0", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
             RowBox[{"WorkingPrecision", "\[Rule]", "\[Sigma]"}]}], "]"}]}], 
          "*)"}], 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
            RowBox[{"+", 
             SuperscriptBox["E", 
              RowBox[{"I", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"\[Omega]", " ", "t0\[Pi]2"}], "-", 
                 RowBox[{"m", " ", "\[Phi]0\[Pi]2"}]}], ")"}]}]]}], 
            RowBox[{"NIntegrate", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{"\[Gamma]", "+", 
                   RowBox[{
                    SuperscriptBox["a", "2"], "\[ScriptCapitalE]", " ", 
                    "z"}]}], 
                  SqrtBox[
                   RowBox[{"\[Beta]", 
                    RowBox[{"(", 
                    RowBox[{"zp", "-", "z"}], ")"}]}]]], 
                 SuperscriptBox["E", 
                  RowBox[{"I", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Omega]", " ", "t0\[Chi]m\[Pi]2"}], "-", 
                    RowBox[{"m", " ", "\[Phi]0\[Chi]m\[Pi]2"}]}], ")"}]}]], 
                 "IUpPlus"}], ")"}], "/.", 
               RowBox[{"{", 
                RowBox[{"\[Chi]", "->", "\[Chi]0"}], "}"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"\[Chi]0", ",", 
                FractionBox["\[Pi]", "2"], ",", "\[Pi]"}], "}"}], ",", 
              RowBox[{"WorkingPrecision", "\[Rule]", "\[Sigma]"}]}], "]"}]}], 
           "+", 
           RowBox[{
            SuperscriptBox["E", 
             RowBox[{
              RowBox[{"-", "I"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[Omega]", " ", "t0\[Pi]2"}], "-", 
                RowBox[{"m", " ", "\[Phi]0\[Pi]2"}]}], ")"}]}]], 
            RowBox[{"NIntegrate", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{"\[Gamma]", "+", 
                   RowBox[{
                    SuperscriptBox["a", "2"], "\[ScriptCapitalE]", " ", 
                    "z"}]}], 
                  SqrtBox[
                   RowBox[{"\[Beta]", 
                    RowBox[{"(", 
                    RowBox[{"zp", "-", "z"}], ")"}]}]]], 
                 SuperscriptBox["E", 
                  RowBox[{
                   RowBox[{"-", "I"}], 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Omega]", " ", "t0\[Chi]m\[Pi]2"}], "-", 
                    RowBox[{"m", " ", "\[Phi]0\[Chi]m\[Pi]2"}]}], ")"}]}]], 
                 "IUpMinus"}], ")"}], "/.", 
               RowBox[{"{", 
                RowBox[{"\[Chi]", "->", "\[Chi]0"}], "}"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"\[Chi]0", ",", 
                FractionBox["\[Pi]", "2"], ",", "\[Pi]"}], "}"}], ",", 
              RowBox[{"WorkingPrecision", "\[Rule]", "\[Sigma]"}]}], 
             "]"}]}]}], "*)"}], ")"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"amplitudes", " ", "=", " ", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<\[ScriptCapitalI]\>\"", "->", "Zin"}], ",", 
        RowBox[{"\"\<\[ScriptCapitalH]\>\"", "->", "Zup"}]}], "|>"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"assoc", " ", "=", " ", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<l\>\"", "->", "l"}], ",", 
        RowBox[{"\"\<m\>\"", "->", "m"}], ",", 
        RowBox[{"\"\<k\>\"", "->", "k"}], ",", 
        RowBox[{"\"\<\[Omega]\>\"", "->", "\[Omega]"}], ",", 
        RowBox[{"\"\<Eigenvalue\>\"", "->", "eval"}], ",", " ", 
        RowBox[{"\"\<Orbit\>\"", "->", "orbit"}], ",", " ", 
        RowBox[{"\"\<Amplitudes\>\"", "->", "amplitudes"}]}], "|>"}]}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.863064392688677*^9, 3.8630644321799965`*^9}, {
   3.8630664684735265`*^9, 3.8630665183028584`*^9}, {3.8630665528830776`*^9, 
   3.8630665884999046`*^9}, 3.863066635902318*^9, 3.8630666792159247`*^9, {
   3.863067189225557*^9, 3.8630672384371624`*^9}, 3.863067275299808*^9, {
   3.86306730638356*^9, 3.8630674580903645`*^9}, {3.8630674976397486`*^9, 
   3.8630676785692396`*^9}, {3.8630677489235706`*^9, 
   3.8630678181629267`*^9}, {3.863067849955527*^9, 3.8630678519500203`*^9}, {
   3.8630678824147377`*^9, 3.863068172950236*^9}, {3.863068219150898*^9, 
   3.8630682604208226`*^9}, {3.8630684235914*^9, 3.8630685404537597`*^9}, {
   3.863068575129217*^9, 3.8630688440729036`*^9}, {3.8630689345192795`*^9, 
   3.863068974643854*^9}, {3.863069023305098*^9, 3.8630690539257383`*^9}, {
   3.863069468962616*^9, 3.863069603529193*^9}, 3.863069668608444*^9, {
   3.86306971383498*^9, 3.863069786577263*^9}, {3.863069835576913*^9, 
   3.863069963714973*^9}, {3.863070002189682*^9, 3.863070128074911*^9}, 
   3.8630703069492626`*^9, 3.863070337806199*^9, {3.8630703935871997`*^9, 
   3.863070524108426*^9}, {3.8630706197810955`*^9, 3.8630707301722617`*^9}, {
   3.8630707939797115`*^9, 3.8630707967605567`*^9}, {3.8630708734442744`*^9, 
   3.86307093550029*^9}, 3.8630710579715023`*^9, {3.863071294576641*^9, 
   3.863071336027204*^9}, {3.8630804946490984`*^9, 3.863080499058425*^9}, {
   3.863080559742588*^9, 3.8630805739910603`*^9}, {3.8630807687734413`*^9, 
   3.863080804531021*^9}, {3.8630821052165427`*^9, 3.863082199249623*^9}, {
   3.863082229400874*^9, 3.8630822316161633`*^9}, {3.863082769148796*^9, 
   3.863082783162854*^9}, {3.863083478012878*^9, 3.8630835286484513`*^9}, 
   3.8630842261809263`*^9, {3.8630873848220634`*^9, 3.863087454599044*^9}, {
   3.863087488366107*^9, 3.863087506902504*^9}, {3.863087582841058*^9, 
   3.8630875832900925`*^9}, {3.863087783174302*^9, 3.8630878001995387`*^9}, {
   3.863089936549639*^9, 3.8630899509174767`*^9}, {3.8630912421019773`*^9, 
   3.8630912471100216`*^9}, 3.863153507448406*^9, 3.863153609375703*^9, 
   3.863153642952876*^9, 3.86315520073193*^9, {3.8631552391393485`*^9, 
   3.863155258679782*^9}, {3.8631575336988363`*^9, 3.8631575937423697`*^9}, 
   3.8631752807750883`*^9, {3.8631755578527217`*^9, 3.8631755597710066`*^9}, {
   3.8631756020498424`*^9, 3.863175606386402*^9}, {3.863599131205424*^9, 
   3.8635991390654335`*^9}, {3.8636002885523453`*^9, 3.86360029067037*^9}, {
   3.8636004059795303`*^9, 3.863600415250534*^9}, {3.8636004725983553`*^9, 
   3.86360047577489*^9}, {3.8636037639761333`*^9, 3.8636038007051473`*^9}, {
   3.863603867502675*^9, 3.8636038835401077`*^9}, {3.8636732824677873`*^9, 
   3.8636732853960876`*^9}, {3.863673322291748*^9, 3.8636733298601136`*^9}, {
   3.8636743566289825`*^9, 3.8636743706025968`*^9}, {3.8636744046275496`*^9, 
   3.8636744188062267`*^9}, {3.8636744514546833`*^9, 3.8636744603389006`*^9}, 
   3.8653995948064113`*^9, {3.8653996769864783`*^9, 3.865399715023604*^9}, 
   3.8654003280161753`*^9, 3.8654144700045233`*^9, {3.866275365082913*^9, 
   3.866275370290986*^9}},ExpressionUUID->"1fba30e2-d5de-438d-a2f0-\
ec1dfe3da884"]
}, Open  ]],

Cell[CellGroupData[{

Cell["3rd Term Stress-Energy(\[OpenCurlyDoubleQuote]r\[CloseCurlyDoubleQuote] \
term)", "Subsubsection",
 CellChangeTimes->{{3.8654002581289926`*^9, 3.8654002639126964`*^9}, {
  3.865402904081148*^9, 
  3.8654029093433657`*^9}},ExpressionUUID->"4483f0df-3f36-4fcd-974e-\
1b6be54d3da6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Source3", "[", 
   RowBox[{"l_", ",", "m_", ",", "k_", ",", "orbit_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "a", ",", "r0", ",", "e", ",", "x", ",", "\[ScriptCapitalE]", ",", 
      "\[ScriptCapitalL]", ",", "\[ScriptCapitalQ]", ",", "\[Beta]", ",", 
      "zm", ",", "zp", ",", "\[Theta]", ",", "z", ",", "\[CapitalDelta]", ",",
       "\[CapitalSigma]", ",", "\[Rho]", ",", "\[Rho]b", ",", "ut", ",", 
      "\[CapitalTheta]", ",", "\[Chi]", ",", "CnnPlus", ",", "CnnMinus", ",", 
      "CnmPlus", ",", "CnmMinus", ",", "CmmPlus", ",", "CmmMinus", ",", 
      "drCnnPlus", ",", "drCnnMinus", ",", "drCnmPlus", ",", "drCnmMinus", 
      ",", "drCmmPlus", ",", "drCmmMinus", ",", "assoc"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"Orbital", " ", "Params"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"a", "   ", "=", " ", 
      RowBox[{"orbit", "[", "\"\<a\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"r0", " ", "=", " ", 
      RowBox[{"orbit", "[", "\"\<p\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"e", "   ", "=", " ", 
      RowBox[{"orbit", "[", "\"\<Eccentricity\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"x", "   ", "=", " ", 
      RowBox[{"orbit", "[", "\"\<Inclination\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"Constants", " ", "of", " ", "motion"}], " ", "&"}], " ", 
       "Frequencies"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"\[ScriptCapitalE]", " ", "=", " ", 
      RowBox[{"orbit", "[", "\"\<Energy\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[ScriptCapitalL]", " ", "=", " ", 
      RowBox[{"orbit", "[", "\"\<AngularMomentum\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[ScriptCapitalQ]", " ", "=", " ", 
      RowBox[{"orbit", "[", "\"\<CarterConstant\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Definitions", " ", "and", " ", "reparameterisation"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"\[Beta]", "=", 
      RowBox[{
       SuperscriptBox["a", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SuperscriptBox["\[ScriptCapitalE]", "2"]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"zm", ",", "zp"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        FractionBox[
         RowBox[{
          SuperscriptBox["\[ScriptCapitalL]", "2"], "+", "\[ScriptCapitalQ]", 
          "+", "\[Beta]", "-", 
          RowBox[{"\[Beta]", " ", 
           SqrtBox[
            FractionBox[
             RowBox[{
              SuperscriptBox["\[ScriptCapitalL]", "4"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"\[ScriptCapitalQ]", "-", "\[Beta]"}], ")"}], "2"], 
              "+", 
              RowBox[{"2", " ", 
               SuperscriptBox["\[ScriptCapitalL]", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"\[ScriptCapitalQ]", "+", "\[Beta]"}], ")"}]}]}], 
             SuperscriptBox["\[Beta]", "2"]]]}]}], 
         RowBox[{"2", " ", "\[Beta]"}]], ",", 
        FractionBox[
         RowBox[{
          SuperscriptBox["\[ScriptCapitalL]", "2"], "+", "\[ScriptCapitalQ]", 
          "+", "\[Beta]", "+", 
          RowBox[{"\[Beta]", " ", 
           SqrtBox[
            FractionBox[
             RowBox[{
              SuperscriptBox["\[ScriptCapitalL]", "4"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"\[ScriptCapitalQ]", "-", "\[Beta]"}], ")"}], "2"], 
              "+", 
              RowBox[{"2", " ", 
               SuperscriptBox["\[ScriptCapitalL]", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"\[ScriptCapitalQ]", "+", "\[Beta]"}], ")"}]}]}], 
             SuperscriptBox["\[Beta]", "2"]]]}]}], 
         RowBox[{"2", " ", "\[Beta]"}]]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\[Theta]", "=", 
      RowBox[{"ArcCos", "[", 
       RowBox[{
        SqrtBox["zm"], " ", 
        RowBox[{"Cos", "[", "\[Chi]", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\[CapitalDelta]", "=", 
      RowBox[{
       SuperscriptBox["r0", "2"], "-", 
       RowBox[{"2", "r0"}], "+", 
       SuperscriptBox["a", "2"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[CapitalSigma]", "=", 
      RowBox[{
       SuperscriptBox["r0", "2"], "+", 
       RowBox[{
        SuperscriptBox["a", "2"], 
        SuperscriptBox[
         RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Rho]", "=", 
      FractionBox[
       RowBox[{"-", "1"}], 
       RowBox[{"r0", "-", 
        RowBox[{"I", " ", "a", " ", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Rho]b", "=", 
      FractionBox[
       RowBox[{"-", "1"}], 
       RowBox[{"r0", "+", 
        RowBox[{"I", " ", "a", " ", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}]]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"ut", "=", 
      RowBox[{
       FractionBox["1", "\[CapitalSigma]"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[ScriptCapitalE]", 
          RowBox[{"(", 
           RowBox[{
            FractionBox[
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["r0", "2"], "+", 
                SuperscriptBox["a", "2"]}], ")"}], "2"], "\[CapitalDelta]"], 
            "-", 
            RowBox[{
             SuperscriptBox["a", "2"], 
             SuperscriptBox[
              RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]}], ")"}]}], "+", 
         RowBox[{"a", " ", "\[ScriptCapitalL]", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            FractionBox[
             RowBox[{
              SuperscriptBox["r0", "2"], "+", 
              SuperscriptBox["a", "2"]}], "\[CapitalDelta]"]}], ")"}]}]}], 
        ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[CapitalTheta]", "=", 
      SqrtBox[
       RowBox[{"\[ScriptCapitalQ]", "-", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"Cot", "[", "\[Theta]", "]"}], "2"], 
         SuperscriptBox["\[ScriptCapitalL]", "2"]}], "-", 
        RowBox[{
         SuperscriptBox["a", "2"], 
         SuperscriptBox[
          RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           SuperscriptBox["\[ScriptCapitalE]", "2"]}], ")"}]}]}]]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Stress", " ", "energy", " ", "projected", " ", "onto", " ", "tetrad", 
       " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[PlusMinus]", "\[CapitalTheta]"}], " ", "for", " ", 
         "travelling", " ", "up", " ", "or", " ", "down"}], ")"}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       SubscriptBox["C", "ab"], " ", "to", " ", "be", " ", "replaced", " ", 
       "by", " ", "Josh"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"CnnPlus", "=", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"4", " ", 
         SuperscriptBox["\[CapitalSigma]", "3"], "ut"}]], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[ScriptCapitalE]", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["r0", "2"], "+", 
             SuperscriptBox["a", "2"]}], ")"}]}], "-", 
          RowBox[{"a", " ", "\[ScriptCapitalL]"}]}], ")"}], "2"]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"CnmPlus", "=", 
      RowBox[{
       FractionBox["\[Rho]", 
        RowBox[{"2", 
         SqrtBox["2"], 
         SuperscriptBox["\[CapitalSigma]", "2"], "ut"}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[ScriptCapitalE]", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["r0", "2"], "+", 
            SuperscriptBox["a", "2"]}], ")"}]}], "-", 
         RowBox[{"a", " ", "\[ScriptCapitalL]"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"I", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a", " ", "\[ScriptCapitalE]"}], "-", 
            FractionBox["\[ScriptCapitalL]", 
             SuperscriptBox[
              RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]]}], ")"}]}], "+", 
         " ", "\[CapitalTheta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"CmmPlus", "=", 
      RowBox[{
       FractionBox[
        SuperscriptBox["\[Rho]", "2"], 
        RowBox[{"2", "\[CapitalSigma]", " ", "ut"}]], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"I", " ", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"a", " ", "\[ScriptCapitalE]"}], "-", 
             FractionBox["\[ScriptCapitalL]", 
              SuperscriptBox[
               RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]]}], ")"}]}], "+", 
          " ", "\[CapitalTheta]"}], ")"}], "2"]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"CnnMinus", "=", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"4", " ", 
         SuperscriptBox["\[CapitalSigma]", "3"], "ut"}]], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[ScriptCapitalE]", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["r0", "2"], "+", 
             SuperscriptBox["a", "2"]}], ")"}]}], "-", 
          RowBox[{"a", " ", "\[ScriptCapitalL]"}]}], ")"}], "2"]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"CnmMinus", "=", 
      RowBox[{
       FractionBox["\[Rho]", 
        RowBox[{"2", 
         SqrtBox["2"], 
         SuperscriptBox["\[CapitalSigma]", "2"], "ut"}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[ScriptCapitalE]", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["r0", "2"], "+", 
            SuperscriptBox["a", "2"]}], ")"}]}], "-", 
         RowBox[{"a", " ", "\[ScriptCapitalL]"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"I", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a", " ", "\[ScriptCapitalE]"}], "-", 
            FractionBox["\[ScriptCapitalL]", 
             SuperscriptBox[
              RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]]}], ")"}]}], "-", 
         " ", "\[CapitalTheta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"CmmMinus", "=", 
      RowBox[{
       FractionBox[
        SuperscriptBox["\[Rho]", "2"], 
        RowBox[{"2", "\[CapitalSigma]", " ", "ut"}]], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"I", " ", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"a", " ", "\[ScriptCapitalE]"}], "-", 
             FractionBox["\[ScriptCapitalL]", 
              SuperscriptBox[
               RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]]}], ")"}]}], "-", 
          " ", "\[CapitalTheta]"}], ")"}], "2"]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"dr", " ", "->", " ", 
       SubscriptBox["\[PartialD]", "r"]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"drCnnPlus", "=", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"4", " ", 
         SuperscriptBox["\[CapitalSigma]", "3"], "ut"}]], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[ScriptCapitalE]", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["r0", "2"], "+", 
             SuperscriptBox["a", "2"]}], ")"}]}], "-", 
          RowBox[{"a", " ", "\[ScriptCapitalL]"}]}], ")"}], "2"]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"drCnmPlus", "=", 
      RowBox[{
       FractionBox["\[Rho]", 
        RowBox[{"2", 
         SqrtBox["2"], 
         SuperscriptBox["\[CapitalSigma]", "2"], "ut"}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[ScriptCapitalE]", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["r0", "2"], "+", 
            SuperscriptBox["a", "2"]}], ")"}]}], "-", 
         RowBox[{"a", " ", "\[ScriptCapitalL]"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"I", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a", " ", "\[ScriptCapitalE]"}], "-", 
            FractionBox["\[ScriptCapitalL]", 
             SuperscriptBox[
              RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]]}], ")"}]}], "+", 
         " ", "\[CapitalTheta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"drCmmPlus", "=", 
      RowBox[{
       FractionBox[
        SuperscriptBox["\[Rho]", "2"], 
        RowBox[{"2", "\[CapitalSigma]", " ", "ut"}]], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"I", " ", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"a", " ", "\[ScriptCapitalE]"}], "-", 
             FractionBox["\[ScriptCapitalL]", 
              SuperscriptBox[
               RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]]}], ")"}]}], "+", 
          " ", "\[CapitalTheta]"}], ")"}], "2"]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"drCnnMinus", "=", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"4", " ", 
         SuperscriptBox["\[CapitalSigma]", "3"], "ut"}]], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[ScriptCapitalE]", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["r0", "2"], "+", 
             SuperscriptBox["a", "2"]}], ")"}]}], "-", 
          RowBox[{"a", " ", "\[ScriptCapitalL]"}]}], ")"}], "2"]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"drCnmMinus", "=", 
      RowBox[{
       FractionBox["\[Rho]", 
        RowBox[{"2", 
         SqrtBox["2"], 
         SuperscriptBox["\[CapitalSigma]", "2"], "ut"}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[ScriptCapitalE]", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["r0", "2"], "+", 
            SuperscriptBox["a", "2"]}], ")"}]}], "-", 
         RowBox[{"a", " ", "\[ScriptCapitalL]"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"I", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a", " ", "\[ScriptCapitalE]"}], "-", 
            FractionBox["\[ScriptCapitalL]", 
             SuperscriptBox[
              RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]]}], ")"}]}], "-", 
         " ", "\[CapitalTheta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"drCmmMinus", "=", 
      RowBox[{
       FractionBox[
        SuperscriptBox["\[Rho]", "2"], 
        RowBox[{"2", "\[CapitalSigma]", " ", "ut"}]], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"I", " ", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"a", " ", "\[ScriptCapitalE]"}], "-", 
             FractionBox["\[ScriptCapitalL]", 
              SuperscriptBox[
               RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]]}], ")"}]}], "-", 
          " ", "\[CapitalTheta]"}], ")"}], "2"]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Rewriting", " ", "source"}], "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"assoc", " ", "=", " ", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<l\>\"", "->", "l"}], ",", 
        RowBox[{"\"\<m\>\"", "->", "m"}], ",", 
        RowBox[{"\"\<k\>\"", "->", "k"}], ",", 
        RowBox[{"\"\<Orbit\>\"", "->", "orbit"}], ",", 
        RowBox[{"\"\<Cnn+\>\"", "->", "CnnPlus"}], ",", 
        RowBox[{"\"\<Cnn-\>\"", "->", "CnnMinus"}], ",", 
        RowBox[{"\"\<Cnm+\>\"", "->", "CnmPlus"}], ",", 
        RowBox[{"\"\<Cnm-\>\"", "->", "CnmMinus"}], ",", 
        RowBox[{"\"\<Cmm+\>\"", "->", "CmmPlus"}], ",", 
        RowBox[{"\"\<Cmm-\>\"", "->", "CmmMinus"}], ",", 
        RowBox[{"\"\<dCnn+\>\"", "->", "drCnnPlus"}], ",", 
        RowBox[{"\"\<dCnn-\>\"", "->", "drCnnMinus"}], ",", 
        RowBox[{"\"\<dCnm+\>\"", "->", "drCnmPlus"}], ",", 
        RowBox[{"\"\<dCnm-\>\"", "->", "drCnmMinus"}], ",", 
        RowBox[{"\"\<dCmm+\>\"", "->", "drCmmPlus"}], ",", 
        RowBox[{"\"\<dCmm-\>\"", "->", "drCmmMinus"}], ",", 
        RowBox[{"\"\<\[Chi]\>\"", "->", "\[Chi]"}]}], "|>"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.8654005769589424`*^9, 3.865400577094685*^9}, {
  3.865400614454358*^9, 3.8654006279111576`*^9}, {3.8654015484117413`*^9, 
  3.865401602495844*^9}, {3.8654169178196716`*^9, 
  3.865416946609563*^9}},ExpressionUUID->"243a11aa-cf3b-4b96-844d-\
a055d523055e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["3rd Term Convolution (\[OpenCurlyDoubleQuote]r\[CloseCurlyDoubleQuote] \
term)", "Subsubsection",
 CellChangeTimes->{{3.8654003819520617`*^9, 3.8654003866965065`*^9}, {
  3.8654029658559284`*^9, 
  3.8654029695938025`*^9}},ExpressionUUID->"5a45605e-9dfb-4cda-b8a6-\
434ae8c2ef3e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Convolver3", "[", "source_", "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "l", ",", "m", ",", "k", ",", "orbit", ",", "a", ",", "r0", ",", "e", 
      ",", "x", ",", "\[ScriptCapitalE]", ",", "\[ScriptCapitalL]", ",", 
      "\[ScriptCapitalQ]", ",", "\[Beta]", ",", "\[Gamma]", ",", "\[Delta]", 
      ",", "zm", ",", "zp", ",", "\[Theta]", ",", "z", ",", "\[CapitalDelta]",
       ",", "\[CapitalSigma]", ",", "\[Rho]", ",", "\[Rho]b", ",", 
      "\[CapitalOmega]\[Theta]", ",", "\[CapitalOmega]\[Phi]", ",", 
      "T\[Theta]", ",", "\[Omega]", ",", "S", ",", "Ld2S", ",", "Ld1Ld2S", 
      ",", "Kf", ",", "dK\[CapitalDelta]", ",", "ut", ",", "\[CapitalTheta]", 
      ",", "\[Chi]", ",", "t0", ",", "t0\[Pi]2", ",", "t0\[Chi]m\[Pi]2", ",", 
      "\[Phi]0", ",", "\[Phi]0\[Pi]2", ",", "\[Phi]0\[Chi]m\[Pi]2", ",", 
      "CnnPlus", ",", "CnnMinus", ",", "CnmPlus", ",", "CnmMinus", ",", 
      "CmmPlus", ",", "CmmMinus", ",", "drCnnPlus", ",", "drCnmPlus", ",", 
      "drCmmPlus", ",", "drCnnMinus", ",", "drCnmMinus", ",", "drCmmMinus", 
      ",", "Ann0Plus", ",", "Anm0Plus", ",", "Amm0Plus", ",", "Anm1Plus", ",",
       "Amm1Plus", ",", "Amm2Plus", ",", "Ann0Minus", ",", "Anm0Minus", ",", 
      "Amm0Minus", ",", "Anm1Minus", ",", "Amm1Minus", ",", "Amm2Minus", ",", 
      "drAnn0Plus", ",", "drAnm0Plus", ",", "drAmm0Plus", ",", "drAnm1Plus", 
      ",", "drAmm1Plus", ",", "drAmm2Plus", ",", "drAnn0Minus", ",", 
      "drAnm0Minus", ",", "drAmm0Minus", ",", "drAnm1Minus", ",", 
      "drAmm1Minus", ",", "drAmm2Minus", ",", "R", ",", "Rin", ",", "Rup", 
      ",", "Const", ",", "IUpPlus", ",", "IUpMinus", ",", "IInPlus", ",", 
      "IInMinus", ",", "Zin", ",", "Zup", ",", "assoc", ",", " ", 
      "amplitudes", ",", "eval", ",", "Bin", ",", "Bhole", ",", "\[Sigma]", 
      ",", "M"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"M", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "Print", "[", "\"\<Getting l, m, k, orbital params, constants\>\"", 
        "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"l", " ", "=", " ", 
      RowBox[{"source", "[", "\"\<l\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"m", " ", "=", " ", 
      RowBox[{"source", "[", "\"\<m\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"k", " ", "=", " ", 
      RowBox[{"source", "[", "\"\<k\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"orbit", " ", "=", " ", 
      RowBox[{"source", "[", "\"\<Orbit\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Chi]", " ", "=", " ", 
      RowBox[{"source", "[", "\"\<\[Chi]\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"a", "   ", "=", " ", 
      RowBox[{"orbit", "[", "\"\<a\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"r0", " ", "=", " ", 
      RowBox[{"orbit", "[", "\"\<p\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"e", "   ", "=", " ", 
      RowBox[{"orbit", "[", "\"\<e\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"x", "   ", "=", " ", 
      RowBox[{"orbit", "[", "\"\<Inclination\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"StringJoin", "[", 
         RowBox[{"\"\<a = \>\"", ",", 
          RowBox[{"ToString", "[", "a", "]"}], ",", "\"\<, r0 = \>\"", ",", 
          RowBox[{"ToString", "[", "r0", "]"}], ",", "\"\<, e = \>\"", ",", 
          RowBox[{"ToString", "[", "e", "]"}], ",", "\"\<, x = \>\"", ",", 
          RowBox[{"ToString", "[", "x", "]"}]}], "]"}], "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"Constants", " ", "of", " ", "motion"}], " ", "&"}], " ", 
       "Frequencies"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"\[ScriptCapitalE]", " ", "=", " ", 
      RowBox[{"orbit", "[", "\"\<Energy\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[ScriptCapitalL]", " ", "=", " ", 
      RowBox[{"orbit", "[", "\"\<AngularMomentum\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[ScriptCapitalQ]", " ", "=", " ", 
      RowBox[{"orbit", "[", "\"\<CarterConstant\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"StringJoin", "[", 
         RowBox[{"\"\<Energy = \>\"", ",", 
          RowBox[{"ToString", "[", "\[ScriptCapitalE]", "]"}], ",", 
          "\"\<, Angular Momentum = \>\"", ",", 
          RowBox[{"ToString", "[", "\[ScriptCapitalL]", "]"}], ",", 
          "\"\<, Carter constant = \>\"", ",", 
          RowBox[{"ToString", "[", "\[ScriptCapitalQ]", "]"}]}], "]"}], "]"}],
        ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "\"\<Calculating Frequencies\>\"", "]"}], ";"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[CapitalOmega]\[Theta]", ",", "\[CapitalOmega]\[Phi]"}], 
       "}"}], "=", 
      RowBox[{
       RowBox[{"Values", "[", 
        RowBox[{"KerrGeoFrequencies", "[", 
         RowBox[{"a", ",", "r0", ",", "e", ",", "x"}], "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"2", ";;", "3"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"T\[Theta]", " ", "=", " ", 
      FractionBox[
       RowBox[{"2", "\[Pi]"}], "\[CapitalOmega]\[Theta]"]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Omega]", " ", "=", " ", 
      RowBox[{
       RowBox[{"m", " ", "\[CapitalOmega]\[Phi]"}], " ", "+", " ", 
       RowBox[{"k", " ", "\[CapitalOmega]\[Theta]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Sigma]", " ", "=", 
      RowBox[{".7", " ", 
       RowBox[{"Precision", "[", "\[Omega]", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"StringJoin", "[", 
         RowBox[{"\"\<\[CapitalOmega]\[Theta] = \>\"", ",", 
          RowBox[{"ToString", "[", "\[CapitalOmega]\[Theta]", "]"}], ",", 
          "\"\<, \[CapitalOmega]\[Phi] = \>\"", ",", 
          RowBox[{"ToString", "[", "\[CapitalOmega]\[Phi]", "]"}], ",", 
          "\"\<, \[Omega] = \>\"", ",", 
          RowBox[{"ToString", "[", "\[Omega]", "]"}]}], "]"}], "]"}], ";"}], 
      "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"\[CapitalDelta]", "=", 
      RowBox[{
       SuperscriptBox["r0", "2"], "-", 
       RowBox[{"2", "r0"}], "+", 
       SuperscriptBox["a", "2"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[CapitalSigma]", "=", 
      RowBox[{
       SuperscriptBox["r0", "2"], "+", 
       RowBox[{
        SuperscriptBox["a", "2"], 
        SuperscriptBox[
         RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Rho]", "=", 
      FractionBox[
       RowBox[{"-", "1"}], 
       RowBox[{"r0", "-", 
        RowBox[{"I", " ", "a", " ", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Rho]b", "=", 
      FractionBox[
       RowBox[{"-", "1"}], 
       RowBox[{"r0", "+", 
        RowBox[{"I", " ", "a", " ", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Beta]", "=", 
      RowBox[{
       SuperscriptBox["a", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SuperscriptBox["\[ScriptCapitalE]", "2"]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]", " ", "=", " ", 
      RowBox[{
       RowBox[{"\[ScriptCapitalE]", " ", 
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["r0", "2"], "+", 
              SuperscriptBox["a", "2"]}], ")"}], "2"], "\[CapitalDelta]"], 
          "-", 
          SuperscriptBox["a", "2"]}], ")"}]}], "+", 
       RowBox[{"a", " ", "\[ScriptCapitalL]", " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          FractionBox[
           RowBox[{
            SuperscriptBox["r0", "2"], "+", 
            SuperscriptBox["a", "2"]}], "\[CapitalDelta]"]}], ")"}]}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"\[Delta]", " ", "=", " ", 
      RowBox[{
       RowBox[{"a", " ", "\[ScriptCapitalE]", 
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           RowBox[{
            SuperscriptBox["r0", "2"], "+", 
            SuperscriptBox["a", "2"]}], "\[CapitalDelta]"], "-", "1"}], 
         ")"}]}], "-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["a", "2"], "\[ScriptCapitalL]"}], 
        "\[CapitalDelta]"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"zm", ",", "zp"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        FractionBox[
         RowBox[{
          SuperscriptBox["\[ScriptCapitalL]", "2"], "+", "\[ScriptCapitalQ]", 
          "+", "\[Beta]", "-", 
          RowBox[{"\[Beta]", " ", 
           SqrtBox[
            FractionBox[
             RowBox[{
              SuperscriptBox["\[ScriptCapitalL]", "4"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"\[ScriptCapitalQ]", "-", "\[Beta]"}], ")"}], "2"], 
              "+", 
              RowBox[{"2", " ", 
               SuperscriptBox["\[ScriptCapitalL]", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"\[ScriptCapitalQ]", "+", "\[Beta]"}], ")"}]}]}], 
             SuperscriptBox["\[Beta]", "2"]]]}]}], 
         RowBox[{"2", " ", "\[Beta]"}]], ",", 
        FractionBox[
         RowBox[{
          SuperscriptBox["\[ScriptCapitalL]", "2"], "+", "\[ScriptCapitalQ]", 
          "+", "\[Beta]", "+", 
          RowBox[{"\[Beta]", " ", 
           SqrtBox[
            FractionBox[
             RowBox[{
              SuperscriptBox["\[ScriptCapitalL]", "4"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"\[ScriptCapitalQ]", "-", "\[Beta]"}], ")"}], "2"], 
              "+", 
              RowBox[{"2", " ", 
               SuperscriptBox["\[ScriptCapitalL]", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"\[ScriptCapitalQ]", "+", "\[Beta]"}], ")"}]}]}], 
             SuperscriptBox["\[Beta]", "2"]]]}]}], 
         RowBox[{"2", " ", "\[Beta]"}]]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"z", "=", 
      RowBox[{"zm", " ", 
       SuperscriptBox[
        RowBox[{"Cos", "[", "\[Chi]", "]"}], "2"]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Theta]", "=", 
      RowBox[{"ArcCos", "[", 
       RowBox[{
        SqrtBox["zm"], " ", 
        RowBox[{"Cos", "[", "\[Chi]", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"t0", "[", "\[Chi]", "]"}], "/", 
       RowBox[{"\[Phi]0", "[", "\[Chi]", "]"}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"t0", "=", 
      RowBox[{
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"zm", "-", 
           RowBox[{"2", " ", "zp"}], "+", 
           RowBox[{"zm", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "\[Chi]"}], "]"}]}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"zm", "-", "zp"}], ")"}]}], "]"}], " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"a", "^", "2"}], " ", 
           RowBox[{"(", 
            RowBox[{"zm", "-", "zp"}], ")"}], " ", "\[ScriptCapitalE]", " ", 
           RowBox[{"EllipticE", "[", 
            RowBox[{"\[Chi]", ",", 
             RowBox[{"zm", "/", 
              RowBox[{"(", 
               RowBox[{"zm", "-", "zp"}], ")"}]}]}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"a", "^", "2"}], " ", "zp", " ", "\[ScriptCapitalE]"}], 
             "+", "\[Gamma]"}], ")"}], " ", 
           RowBox[{"EllipticF", "[", 
            RowBox[{"\[Chi]", ",", 
             RowBox[{"zm", "/", 
              RowBox[{"(", 
               RowBox[{"zm", "-", "zp"}], ")"}]}]}], "]"}]}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"Sqrt", "[", 
          RowBox[{
           RowBox[{"-", "\[Beta]"}], " ", 
           RowBox[{"(", 
            RowBox[{"zm", "-", 
             RowBox[{"2", " ", "zp"}], "+", 
             RowBox[{"zm", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"2", " ", "\[Chi]"}], "]"}]}]}], ")"}]}], "]"}], 
         ")"}]}]}]}], ";", "\n", "     ", 
     RowBox[{"\[Phi]0", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"zm", "-", 
             RowBox[{"2", " ", "zp"}], "+", 
             RowBox[{"zm", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"2", " ", "\[Chi]"}], "]"}]}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"zm", "-", "zp"}], ")"}]}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "zm"}], ")"}], " ", "\[Delta]", " ", 
            RowBox[{"EllipticF", "[", 
             RowBox[{"\[Chi]", ",", 
              RowBox[{"zm", "/", 
               RowBox[{"(", 
                RowBox[{"zm", "-", "zp"}], ")"}]}]}], "]"}]}], "-", 
           RowBox[{"\[ScriptCapitalL]", " ", 
            RowBox[{"EllipticPi", "[", 
             RowBox[{
              RowBox[{"zm", "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "zm"}], ")"}]}], ",", "\[Chi]", ",", 
              RowBox[{"zm", "/", 
               RowBox[{"(", 
                RowBox[{"zm", "-", "zp"}], ")"}]}]}], "]"}]}]}], ")"}]}], 
        ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "zm"}], ")"}], " ", 
         RowBox[{"Sqrt", "[", 
          RowBox[{
           RowBox[{"-", "\[Beta]"}], " ", 
           RowBox[{"(", 
            RowBox[{"zm", "-", 
             RowBox[{"2", " ", "zp"}], "+", 
             RowBox[{"zm", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"2", " ", "\[Chi]"}], "]"}]}]}], ")"}]}], "]"}]}], 
        ")"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "Print", "[", 
        "\"\<Calculating Homogeneous Radial Solution, and SWSH\>\"", "]"}], 
       ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"R", " ", "=", " ", 
      RowBox[{"TeukolskyRadial", "[", 
       RowBox[{
        RowBox[{"-", "2"}], ",", "l", ",", "m", ",", "a", ",", "\[Omega]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Rup", " ", "=", " ", 
      RowBox[{"R", "[", "\"\<Up\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Rin", " ", "=", " ", 
      RowBox[{"R", "[", "\"\<In\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Bin", " ", "=", " ", 
      RowBox[{
       RowBox[{"Rin", "[", "\"\<Amplitudes\>\"", "]"}], "[", 
       "\"\<Incidence\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Bhole", " ", "=", " ", 
      RowBox[{
       RowBox[{"Rin", "[", "\"\<Amplitudes\>\"", "]"}], "[", 
       "\"\<Reflection\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Const", " ", "=", 
      RowBox[{"2", "I", " ", "\[Omega]", " ", "Bin"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"eval", " ", "=", " ", 
      RowBox[{"Rup", "[", "\"\<Eigenvalue\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"S", "  ", "=", " ", 
      RowBox[{"SpinWeightedSpheroidalHarmonicS", "[", 
       RowBox[{
        RowBox[{"-", "2"}], ",", "l", ",", "m", ",", 
        RowBox[{"a", " ", "\[Omega]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Ld2S", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Derivative", "[", 
          RowBox[{"1", ",", "0"}], "]"}], "[", "S", "]"}], "[", 
        RowBox[{"\[Theta]", ",", "0"}], "]"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", " ", "m"}], " ", 
           RowBox[{"Csc", "[", "\[Theta]", "]"}]}], "+", 
          RowBox[{"a", " ", "\[Omega]", " ", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"Cot", "[", "\[Theta]", "]"}]}]}], ")"}], 
        RowBox[{"S", "[", 
         RowBox[{"\[Theta]", ",", "0"}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Ld1Ld2S", " ", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Derivative", "[", 
          RowBox[{"2", ",", "0"}], "]"}], "[", "S", "]"}], "[", 
        RowBox[{"\[Theta]", ",", "0"}], "]"}], " ", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", " ", "m"}], " ", 
           RowBox[{"Csc", "[", "\[Theta]", "]"}]}], "+", 
          RowBox[{"a", " ", "\[Omega]", " ", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"Cot", "[", "\[Theta]", "]"}]}]}], ")"}], 
        RowBox[{
         RowBox[{
          RowBox[{"Derivative", "[", 
           RowBox[{"1", ",", "0"}], "]"}], "[", "S", "]"}], "[", 
         RowBox[{"\[Theta]", ",", "0"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", " ", "\[Omega]", " ", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", " ", 
          RowBox[{"m", " ", 
           RowBox[{"Cot", "[", "\[Theta]", "]"}], 
           RowBox[{"Csc", "[", "\[Theta]", "]"}]}], "-", 
          RowBox[{"2", 
           SuperscriptBox[
            RowBox[{"Csc", "[", "\[Theta]", "]"}], "2"]}]}], ")"}], 
        RowBox[{"S", "[", 
         RowBox[{"\[Theta]", ",", "0"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", " ", "m"}], " ", 
           RowBox[{"Csc", "[", "\[Theta]", "]"}]}], "+", 
          RowBox[{"a", " ", "\[Omega]", " ", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "+", " ", 
          RowBox[{"Cot", "[", "\[Theta]", "]"}]}], ")"}], "Ld2S"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Kf", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["r0", "2"], "+", 
          SuperscriptBox["a", "2"]}], ")"}], "\[Omega]"}], "-", 
       RowBox[{"m", " ", "a"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dK\[CapitalDelta]", "=", 
      FractionBox[
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", " ", "m", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "r0"}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["a", "2"], " ", "\[Omega]"}], "-", 
          RowBox[{
           SuperscriptBox["r0", "2"], " ", "\[Omega]"}]}], ")"}]}], 
       SuperscriptBox["\[CapitalDelta]", "2"]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "Print", "[", "\"\<Retrieving Stress-energy information\>\"", "]"}], 
       ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"CnnPlus", "=", 
      RowBox[{"source", "[", "\"\<Cnn+\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"CnmPlus", "=", 
      RowBox[{"source", "[", "\"\<Cnm+\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"CmmPlus", "=", 
      RowBox[{"source", "[", "\"\<Cmm+\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"CnnMinus", "=", 
      RowBox[{"source", "[", "\"\<Cnn-\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"CnmMinus", "=", 
      RowBox[{"source", "[", "\"\<Cnm-\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"CmmMinus", "=", 
      RowBox[{"source", "[", "\"\<Cmm-\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"drCnnPlus", "=", 
      RowBox[{"source", "[", "\"\<dCnn+\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"drCnmPlus", "=", 
      RowBox[{"source", "[", "\"\<dCnm+\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"drCmmPlus", "=", 
      RowBox[{"source", "[", "\"\<dCmm+\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"drCnnMinus", "=", 
      RowBox[{"source", "[", "\"\<dCnn-\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"drCnmMinus", "=", 
      RowBox[{"source", "[", "\"\<dCnm-\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"drCmmMinus", "=", 
      RowBox[{"source", "[", "\"\<dCmm-\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "Print", "[", 
        "\"\<Calculating \!\(\*SubscriptBox[\(A\), \(abi\)]\) terms\>\"", 
        "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Ann0Plus", "=", " ", 
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"-", "2"}], " ", 
         SuperscriptBox["\[Rho]", 
          RowBox[{"-", "3"}]], 
         SuperscriptBox["\[Rho]b", 
          RowBox[{"-", "1"}]], "CnnPlus"}], 
        SuperscriptBox["\[CapitalDelta]", "2"]], 
       RowBox[{"(", 
        RowBox[{"Ld1Ld2S", "+", 
         RowBox[{"2", "I", " ", "a", " ", "\[Rho]", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}], "Ld2S"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Anm0Plus", "=", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"2", 
          SqrtBox["2"], 
          SuperscriptBox["\[Rho]", 
           RowBox[{"-", "3"}]], " ", "CnmPlus"}], "\[CapitalDelta]"]}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            FractionBox[
             RowBox[{"I", " ", "Kf"}], "\[CapitalDelta]"], "-", "\[Rho]", "-",
             "\[Rho]b"}], ")"}], "Ld2S"}], "-", 
         RowBox[{
          FractionBox[
           RowBox[{" ", "Kf"}], "\[CapitalDelta]"], "a", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}], 
          RowBox[{"S", "[", 
           RowBox[{"\[Theta]", ",", "0"}], "]"}], 
          RowBox[{"(", 
           RowBox[{"\[Rho]", "-", "\[Rho]b"}], ")"}]}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Amm0Plus", "=", 
      RowBox[{
       RowBox[{"S", "[", 
        RowBox[{"\[Theta]", ",", "0"}], "]"}], 
       SuperscriptBox["\[Rho]", 
        RowBox[{"-", "3"}]], "\[Rho]b", " ", "CmmPlus", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           FractionBox["Kf", "\[CapitalDelta]"], ")"}], "2"], "+", 
         RowBox[{"2", "I", " ", "\[Rho]", 
          FractionBox["Kf", "\[CapitalDelta]"]}], "+", 
         RowBox[{"I", " ", "dK\[CapitalDelta]"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Anm1Plus", "=", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"2", 
          SqrtBox["2"], 
          SuperscriptBox["\[Rho]", 
           RowBox[{"-", "3"}]], "CnmPlus"}], "\[CapitalDelta]"]}], 
       RowBox[{"(", 
        RowBox[{"Ld2S", "+", 
         RowBox[{"I", " ", "a", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}], 
          RowBox[{"(", 
           RowBox[{"\[Rho]", "-", "\[Rho]b"}], ")"}], 
          RowBox[{"S", "[", 
           RowBox[{"\[Theta]", ",", "0"}], "]"}]}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Amm1Plus", "=", 
      RowBox[{"2", 
       RowBox[{"S", "[", 
        RowBox[{"\[Theta]", ",", "0"}], "]"}], 
       SuperscriptBox["\[Rho]", 
        RowBox[{"-", "3"}]], "\[Rho]b", " ", "CmmPlus", 
       RowBox[{"(", 
        RowBox[{"\[Rho]", "-", 
         FractionBox[
          RowBox[{"I", " ", "Kf"}], "\[CapitalDelta]"]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Amm2Plus", "=", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"S", "[", 
         RowBox[{"\[Theta]", ",", "0"}], "]"}]}], 
       SuperscriptBox["\[Rho]", 
        RowBox[{"-", "3"}]], "\[Rho]b", " ", "CmmPlus"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Ann0Minus", "=", " ", 
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"-", "2"}], " ", 
         SuperscriptBox["\[Rho]", 
          RowBox[{"-", "3"}]], 
         SuperscriptBox["\[Rho]b", 
          RowBox[{"-", "1"}]], "CnnMinus"}], 
        SuperscriptBox["\[CapitalDelta]", "2"]], 
       RowBox[{"(", 
        RowBox[{"Ld1Ld2S", "+", 
         RowBox[{"2", "I", " ", "a", " ", "\[Rho]", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}], "Ld2S"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Anm0Minus", "=", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"2", 
          SqrtBox["2"], 
          SuperscriptBox["\[Rho]", 
           RowBox[{"-", "3"}]], " ", "CnmMinus"}], "\[CapitalDelta]"]}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            FractionBox[
             RowBox[{"I", " ", "Kf"}], "\[CapitalDelta]"], "-", "\[Rho]", "-",
             "\[Rho]b"}], ")"}], "Ld2S"}], "-", 
         RowBox[{
          FractionBox[
           RowBox[{" ", "Kf"}], "\[CapitalDelta]"], "a", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}], 
          RowBox[{"S", "[", 
           RowBox[{"\[Theta]", ",", "0"}], "]"}], 
          RowBox[{"(", 
           RowBox[{"\[Rho]", "-", "\[Rho]b"}], ")"}]}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Amm0Minus", "=", 
      RowBox[{
       RowBox[{"S", "[", 
        RowBox[{"\[Theta]", ",", "0"}], "]"}], 
       SuperscriptBox["\[Rho]", 
        RowBox[{"-", "3"}]], "\[Rho]b", " ", "CmmMinus", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           FractionBox["Kf", "\[CapitalDelta]"], ")"}], "2"], "+", 
         RowBox[{"2", "I", " ", "\[Rho]", 
          FractionBox["Kf", "\[CapitalDelta]"]}], "+", 
         RowBox[{"I", " ", "dK\[CapitalDelta]"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Anm1Minus", "=", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"2", 
          SqrtBox["2"], 
          SuperscriptBox["\[Rho]", 
           RowBox[{"-", "3"}]], "CnmMinus"}], "\[CapitalDelta]"]}], 
       RowBox[{"(", 
        RowBox[{"Ld2S", "+", 
         RowBox[{"I", " ", "a", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}], 
          RowBox[{"(", 
           RowBox[{"\[Rho]", "-", "\[Rho]b"}], ")"}], 
          RowBox[{"S", "[", 
           RowBox[{"\[Theta]", ",", "0"}], "]"}]}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Amm1Minus", "=", 
      RowBox[{"2", 
       RowBox[{"S", "[", 
        RowBox[{"\[Theta]", ",", "0"}], "]"}], 
       SuperscriptBox["\[Rho]", 
        RowBox[{"-", "3"}]], "\[Rho]b", " ", "CmmMinus", 
       RowBox[{"(", 
        RowBox[{"\[Rho]", "-", 
         FractionBox[
          RowBox[{"I", " ", "Kf"}], "\[CapitalDelta]"]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Amm2Minus", "=", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"S", "[", 
         RowBox[{"\[Theta]", ",", "0"}], "]"}]}], 
       SuperscriptBox["\[Rho]", 
        RowBox[{"-", "3"}]], "\[Rho]b", " ", "CmmMinus"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Deriv", " ", "terms"}], ",", " ", 
       RowBox[{"dr", "->", 
        SubscriptBox["\[PartialD]", "r"]}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"drAnn0Plus", "=", " ", 
      FractionBox[
       RowBox[{
        RowBox[{"2", " ", "Ld1Ld2S", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "drCnnPlus"}], " ", "\[CapitalDelta]"}], "+", 
           RowBox[{"CnnPlus", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "4"}], "+", 
              RowBox[{"4", " ", "r0"}], "+", 
              RowBox[{"3", " ", "\[CapitalDelta]", " ", "\[Rho]"}], "+", 
              RowBox[{"\[CapitalDelta]", " ", "\[Rho]b"}]}], ")"}]}]}], 
          ")"}]}], "+", 
        RowBox[{
        "4", " ", "\[ImaginaryI]", " ", "a", " ", "Ld2S", " ", "\[Rho]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "drCnnPlus"}], " ", "\[CapitalDelta]"}], "+", 
           RowBox[{"CnnPlus", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "4"}], "+", 
              RowBox[{"4", " ", "r0"}], "+", 
              RowBox[{"2", " ", "\[CapitalDelta]", " ", "\[Rho]"}], "+", 
              RowBox[{"\[CapitalDelta]", " ", "\[Rho]b"}]}], ")"}]}]}], ")"}],
          " ", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], 
       RowBox[{
        SuperscriptBox["\[CapitalDelta]", "3"], " ", 
        SuperscriptBox["\[Rho]", "3"], " ", "\[Rho]b"}]]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"drAnm0Plus", "=", 
      RowBox[{
       FractionBox["1", 
        RowBox[{
         SuperscriptBox["\[CapitalDelta]", "3"], " ", 
         SuperscriptBox["\[Rho]", "3"]}]], "2", " ", 
       SqrtBox["2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Ld2S", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"drCnmPlus", " ", "\[CapitalDelta]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "\[ImaginaryI]"}], " ", "Kf"}], "+", 
               RowBox[{"\[CapitalDelta]", " ", 
                RowBox[{"(", 
                 RowBox[{"\[Rho]", "+", "\[Rho]b"}], ")"}]}]}], ")"}]}], "+", 
            RowBox[{"CnmPlus", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "\[ImaginaryI]"}], " ", "Kf", " ", 
                RowBox[{"(", 
                 RowBox[{"4", "-", 
                  RowBox[{"4", " ", "r0"}], "-", 
                  RowBox[{"3", " ", "\[CapitalDelta]", " ", "\[Rho]"}]}], 
                 ")"}]}], "+", 
               RowBox[{"\[CapitalDelta]", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"2", " ", 
                   RowBox[{"(", 
                    RowBox[{"\[Rho]", "+", "\[Rho]b"}], ")"}]}], "+", 
                  RowBox[{"\[CapitalDelta]", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", 
                    SuperscriptBox["\[Rho]", "2"]}], "-", 
                    RowBox[{"3", " ", "\[Rho]", " ", "\[Rho]b"}], "+", 
                    SuperscriptBox["\[Rho]b", "2"]}], ")"}]}], "-", 
                  RowBox[{"2", " ", "r0", " ", 
                   RowBox[{"(", 
                    RowBox[{"\[Rho]", "+", "\[Rho]b", "+", 
                    RowBox[{"\[ImaginaryI]", " ", "\[Omega]"}]}], ")"}]}]}], 
                 ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
         RowBox[{"a", " ", 
          RowBox[{"(", 
           RowBox[{"\[Rho]", "-", "\[Rho]b"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"drCnmPlus", " ", "Kf", " ", "\[CapitalDelta]"}], "+", 
            RowBox[{"CnmPlus", " ", "Kf", " ", 
             RowBox[{"(", 
              RowBox[{"4", "-", 
               RowBox[{"4", " ", "r0"}], "+", 
               RowBox[{"\[CapitalDelta]", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "2"}], " ", "\[Rho]"}], "+", "\[Rho]b"}], 
                 ")"}]}]}], ")"}]}], "+", 
            RowBox[{
            "2", " ", "CnmPlus", " ", "r0", " ", "\[CapitalDelta]", " ", 
             "\[Omega]"}]}], ")"}], " ", 
          RowBox[{"S", "[", 
           RowBox[{"\[Theta]", ",", "0"}], "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"drAmm0Plus", "=", 
      RowBox[{
       FractionBox["1", 
        RowBox[{
         SuperscriptBox["\[CapitalDelta]", "3"], " ", 
         SuperscriptBox["\[Rho]", "3"]}]], "\[Rho]b", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"drCmmPlus", " ", "\[CapitalDelta]", " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["Kf", "2"], "+", 
            RowBox[{"2", " ", "\[ImaginaryI]", " ", "Kf", " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", "r0", "+", 
               RowBox[{"\[CapitalDelta]", " ", "\[Rho]"}]}], ")"}]}], "+", 
            RowBox[{
            "2", " ", "\[ImaginaryI]", " ", "r0", " ", "\[CapitalDelta]", " ",
              "\[Omega]"}]}], ")"}]}], "+", 
         RowBox[{"CmmPlus", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["Kf", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"4", "-", 
               RowBox[{"4", " ", "r0"}], "+", 
               RowBox[{"\[CapitalDelta]", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "3"}], " ", "\[Rho]"}], "+", "\[Rho]b"}], 
                 ")"}]}]}], ")"}]}], "+", 
            RowBox[{"2", " ", "\[ImaginaryI]", " ", "Kf", " ", 
             RowBox[{"(", 
              RowBox[{"4", "-", 
               RowBox[{"8", " ", "r0"}], "+", 
               RowBox[{"4", " ", 
                SuperscriptBox["r0", "2"]}], "+", 
               RowBox[{"\[CapitalDelta]", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "\[Rho]"}], "+", "\[Rho]b"}], ")"}]}], "+", 
               RowBox[{"\[CapitalDelta]", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  RowBox[{"\[CapitalDelta]", " ", "\[Rho]", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "\[Rho]"}], "+", "\[Rho]b"}], 
                    ")"}]}]}], ")"}]}], "+", 
               RowBox[{"r0", " ", "\[CapitalDelta]", " ", 
                RowBox[{"(", 
                 RowBox[{"\[Rho]", "-", "\[Rho]b", "-", 
                  RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Omega]"}]}], 
                 ")"}]}]}], ")"}]}], "+", 
            RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[CapitalDelta]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"4", " ", "r0"}], "-", 
               RowBox[{"4", " ", 
                SuperscriptBox["r0", "2"]}], "+", "\[CapitalDelta]", "+", 
               RowBox[{"r0", " ", "\[CapitalDelta]", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "\[Rho]"}], "+", "\[Rho]b"}], ")"}]}]}], ")"}],
              " ", "\[Omega]"}]}], ")"}]}]}], ")"}], " ", 
       RowBox[{"S", "[", 
        RowBox[{"\[Theta]", ",", "0"}], "]"}]}]}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"drAnm1Plus", "=", 
      FractionBox[
       RowBox[{"2", " ", 
        SqrtBox["2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Ld2S", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "drCnmPlus"}], " ", "\[CapitalDelta]"}], "+", 
             RowBox[{"CnmPlus", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "2"}], "+", 
                RowBox[{"2", " ", "r0"}], "+", 
                RowBox[{"3", " ", "\[CapitalDelta]", " ", "\[Rho]"}]}], 
               ")"}]}]}], ")"}]}], "-", 
          RowBox[{"\[ImaginaryI]", " ", "a", " ", 
           RowBox[{"(", 
            RowBox[{"\[Rho]", "-", "\[Rho]b"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"drCnmPlus", " ", "\[CapitalDelta]"}], "+", 
             RowBox[{"CnmPlus", " ", 
              RowBox[{"(", 
               RowBox[{"2", "-", 
                RowBox[{"2", " ", "r0"}], "-", 
                RowBox[{"2", " ", "\[CapitalDelta]", " ", "\[Rho]"}], "+", 
                RowBox[{"\[CapitalDelta]", " ", "\[Rho]b"}]}], ")"}]}]}], 
            ")"}], " ", 
           RowBox[{"S", "[", 
            RowBox[{"\[Theta]", ",", "0"}], "]"}], " ", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], 
       RowBox[{
        SuperscriptBox["\[CapitalDelta]", "2"], " ", 
        SuperscriptBox["\[Rho]", "3"]}]]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"drAmm1Plus", "=", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Rho]b", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"drCmmPlus", " ", "\[CapitalDelta]", " ", 
            RowBox[{"(", 
             RowBox[{"Kf", "+", 
              RowBox[{
              "\[ImaginaryI]", " ", "\[CapitalDelta]", " ", "\[Rho]"}]}], 
             ")"}]}], "+", 
           RowBox[{"CmmPlus", " ", "Kf", " ", 
            RowBox[{"(", 
             RowBox[{"2", "-", 
              RowBox[{"2", " ", "r0"}], "+", 
              RowBox[{"\[CapitalDelta]", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "3"}], " ", "\[Rho]"}], "+", "\[Rho]b"}], 
                ")"}]}]}], ")"}]}], "+", 
           RowBox[{"CmmPlus", " ", "\[CapitalDelta]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "\[ImaginaryI]"}], " ", "\[CapitalDelta]", " ", 
               "\[Rho]", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", " ", "\[Rho]"}], "-", "\[Rho]b"}], ")"}]}], "+", 
              RowBox[{"2", " ", "r0", " ", "\[Omega]"}]}], ")"}]}]}], ")"}], 
         " ", 
         RowBox[{"S", "[", 
          RowBox[{"\[Theta]", ",", "0"}], "]"}]}], 
        RowBox[{
         SuperscriptBox["\[CapitalDelta]", "2"], " ", 
         SuperscriptBox["\[Rho]", "3"]}]]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"drAmm2Plus", "=", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[Rho]b", " ", 
         RowBox[{"(", 
          RowBox[{"drCmmPlus", "+", 
           RowBox[{"CmmPlus", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "3"}], " ", "\[Rho]"}], "+", "\[Rho]b"}], 
             ")"}]}]}], ")"}], " ", 
         RowBox[{"S", "[", 
          RowBox[{"\[Theta]", ",", "0"}], "]"}]}], 
        SuperscriptBox["\[Rho]", "3"]]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"drAnn0Minus", "=", " ", 
      FractionBox[
       RowBox[{
        RowBox[{"2", " ", "Ld1Ld2S", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "drCnnMinus"}], " ", "\[CapitalDelta]"}], "+", 
           RowBox[{"CnnMinus", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "4"}], " ", "M"}], "+", 
              RowBox[{"4", " ", "r0"}], "+", 
              RowBox[{"3", " ", "\[CapitalDelta]", " ", "\[Rho]"}], "+", 
              RowBox[{"\[CapitalDelta]", " ", "\[Rho]b"}]}], ")"}]}]}], 
          ")"}]}], "+", 
        RowBox[{
        "4", " ", "\[ImaginaryI]", " ", "a", " ", "Ld2S", " ", "\[Rho]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "drCnnMinus"}], " ", "\[CapitalDelta]"}], "+", 
           RowBox[{"CnnMinus", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "4"}], " ", "M"}], "+", 
              RowBox[{"4", " ", "r0"}], "+", 
              RowBox[{"2", " ", "\[CapitalDelta]", " ", "\[Rho]"}], "+", 
              RowBox[{"\[CapitalDelta]", " ", "\[Rho]b"}]}], ")"}]}]}], ")"}],
          " ", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], 
       RowBox[{
        SuperscriptBox["\[CapitalDelta]", "3"], " ", 
        SuperscriptBox["\[Rho]", "3"], " ", "\[Rho]b"}]]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"drAnm0Minus", "=", 
      RowBox[{
       FractionBox["1", 
        RowBox[{
         SuperscriptBox["\[CapitalDelta]", "3"], " ", 
         SuperscriptBox["\[Rho]", "3"]}]], "2", " ", 
       SqrtBox["2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Ld2S", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"drCnmMinus", " ", "\[CapitalDelta]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "\[ImaginaryI]"}], " ", "Kf"}], "+", 
               RowBox[{"\[CapitalDelta]", " ", 
                RowBox[{"(", 
                 RowBox[{"\[Rho]", "+", "\[Rho]b"}], ")"}]}]}], ")"}]}], "+", 
            RowBox[{"CnmMinus", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "\[ImaginaryI]"}], " ", "Kf", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"4", " ", "M"}], "-", 
                  RowBox[{"4", " ", "r0"}], "-", 
                  RowBox[{"3", " ", "\[CapitalDelta]", " ", "\[Rho]"}]}], 
                 ")"}]}], "+", 
               RowBox[{"\[CapitalDelta]", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"2", " ", "M", " ", 
                   RowBox[{"(", 
                    RowBox[{"\[Rho]", "+", "\[Rho]b"}], ")"}]}], "+", 
                  RowBox[{"\[CapitalDelta]", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", 
                    SuperscriptBox["\[Rho]", "2"]}], "-", 
                    RowBox[{"3", " ", "\[Rho]", " ", "\[Rho]b"}], "+", 
                    SuperscriptBox["\[Rho]b", "2"]}], ")"}]}], "-", 
                  RowBox[{"2", " ", "r0", " ", 
                   RowBox[{"(", 
                    RowBox[{"\[Rho]", "+", "\[Rho]b", "+", 
                    RowBox[{"\[ImaginaryI]", " ", "\[Omega]"}]}], ")"}]}]}], 
                 ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
         RowBox[{"a", " ", 
          RowBox[{"(", 
           RowBox[{"\[Rho]", "-", "\[Rho]b"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"drCnmMinus", " ", "Kf", " ", "\[CapitalDelta]"}], "+", 
            RowBox[{"CnmMinus", " ", "Kf", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"4", " ", "M"}], "-", 
               RowBox[{"4", " ", "r0"}], "+", 
               RowBox[{"\[CapitalDelta]", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "2"}], " ", "\[Rho]"}], "+", "\[Rho]b"}], 
                 ")"}]}]}], ")"}]}], "+", 
            RowBox[{
            "2", " ", "CnmMinus", " ", "r0", " ", "\[CapitalDelta]", " ", 
             "\[Omega]"}]}], ")"}], " ", 
          RowBox[{"S", "[", 
           RowBox[{"\[Theta]", ",", "0"}], "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"drAmm0Minus", "=", 
      RowBox[{
       FractionBox["1", 
        RowBox[{
         SuperscriptBox["\[CapitalDelta]", "3"], " ", 
         SuperscriptBox["\[Rho]", "3"]}]], "\[Rho]b", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"drCmmMinus", " ", "\[CapitalDelta]", " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["Kf", "2"], "+", 
            RowBox[{"2", " ", "\[ImaginaryI]", " ", "Kf", " ", 
             RowBox[{"(", 
              RowBox[{"M", "-", "r0", "+", 
               RowBox[{"\[CapitalDelta]", " ", "\[Rho]"}]}], ")"}]}], "+", 
            RowBox[{
            "2", " ", "\[ImaginaryI]", " ", "r0", " ", "\[CapitalDelta]", " ",
              "\[Omega]"}]}], ")"}]}], "+", 
         RowBox[{"CmmMinus", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["Kf", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"4", " ", "M"}], "-", 
               RowBox[{"4", " ", "r0"}], "+", 
               RowBox[{"\[CapitalDelta]", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "3"}], " ", "\[Rho]"}], "+", "\[Rho]b"}], 
                 ")"}]}]}], ")"}]}], "+", 
            RowBox[{"2", " ", "\[ImaginaryI]", " ", "Kf", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"4", " ", 
                SuperscriptBox["M", "2"]}], "+", 
               RowBox[{"4", " ", 
                SuperscriptBox["r0", "2"]}], "+", 
               RowBox[{"\[CapitalDelta]", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  RowBox[{"\[CapitalDelta]", " ", "\[Rho]", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "\[Rho]"}], "+", "\[Rho]b"}], 
                    ")"}]}]}], ")"}]}], "+", 
               RowBox[{"M", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "8"}], " ", "r0"}], "+", 
                  RowBox[{"\[CapitalDelta]", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "\[Rho]"}], "+", "\[Rho]b"}], ")"}]}]}], 
                 ")"}]}], "+", 
               RowBox[{"r0", " ", "\[CapitalDelta]", " ", 
                RowBox[{"(", 
                 RowBox[{"\[Rho]", "-", "\[Rho]b", "-", 
                  RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Omega]"}]}], 
                 ")"}]}]}], ")"}]}], "+", 
            RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[CapitalDelta]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"4", " ", "M", " ", "r0"}], "-", 
               RowBox[{"4", " ", 
                SuperscriptBox["r0", "2"]}], "+", "\[CapitalDelta]", "+", 
               RowBox[{"r0", " ", "\[CapitalDelta]", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "\[Rho]"}], "+", "\[Rho]b"}], ")"}]}]}], ")"}],
              " ", "\[Omega]"}]}], ")"}]}]}], ")"}], " ", 
       RowBox[{"S", "[", 
        RowBox[{"\[Theta]", ",", "0"}], "]"}]}]}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"drAnm1Minus", "=", 
      FractionBox[
       RowBox[{"2", " ", 
        SqrtBox["2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Ld2S", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "drCnmMinus"}], " ", "\[CapitalDelta]"}], "+", 
             RowBox[{"CnmMinus", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", "M"}], "+", 
                RowBox[{"2", " ", "r0"}], "+", 
                RowBox[{"3", " ", "\[CapitalDelta]", " ", "\[Rho]"}]}], 
               ")"}]}]}], ")"}]}], "-", 
          RowBox[{"\[ImaginaryI]", " ", "a", " ", 
           RowBox[{"(", 
            RowBox[{"\[Rho]", "-", "\[Rho]b"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"drCnmMinus", " ", "\[CapitalDelta]"}], "+", 
             RowBox[{"CnmMinus", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", "M"}], "-", 
                RowBox[{"2", " ", "r0"}], "-", 
                RowBox[{"2", " ", "\[CapitalDelta]", " ", "\[Rho]"}], "+", 
                RowBox[{"\[CapitalDelta]", " ", "\[Rho]b"}]}], ")"}]}]}], 
            ")"}], " ", 
           RowBox[{"S", "[", 
            RowBox[{"\[Theta]", ",", "0"}], "]"}], " ", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], 
       RowBox[{
        SuperscriptBox["\[CapitalDelta]", "2"], " ", 
        SuperscriptBox["\[Rho]", "3"]}]]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"drAmm1Minus", "=", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Rho]b", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"drCmmMinus", " ", "\[CapitalDelta]", " ", 
            RowBox[{"(", 
             RowBox[{"Kf", "+", 
              RowBox[{
              "\[ImaginaryI]", " ", "\[CapitalDelta]", " ", "\[Rho]"}]}], 
             ")"}]}], "+", 
           RowBox[{"CmmMinus", " ", "Kf", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "M"}], "-", 
              RowBox[{"2", " ", "r0"}], "+", 
              RowBox[{"\[CapitalDelta]", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "3"}], " ", "\[Rho]"}], "+", "\[Rho]b"}], 
                ")"}]}]}], ")"}]}], "+", 
           RowBox[{"CmmMinus", " ", "\[CapitalDelta]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "\[ImaginaryI]"}], " ", "\[CapitalDelta]", " ", 
               "\[Rho]", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", " ", "\[Rho]"}], "-", "\[Rho]b"}], ")"}]}], "+", 
              RowBox[{"2", " ", "r0", " ", "\[Omega]"}]}], ")"}]}]}], ")"}], 
         " ", 
         RowBox[{"S", "[", 
          RowBox[{"\[Theta]", ",", "0"}], "]"}]}], 
        RowBox[{
         SuperscriptBox["\[CapitalDelta]", "2"], " ", 
         SuperscriptBox["\[Rho]", "3"]}]]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"drAmm2Minus", "=", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[Rho]b", " ", 
         RowBox[{"(", 
          RowBox[{"drCmmMinus", "+", 
           RowBox[{"CmmMinus", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "3"}], " ", "\[Rho]"}], "+", "\[Rho]b"}], 
             ")"}]}]}], ")"}], " ", 
         RowBox[{"S", "[", 
          RowBox[{"\[Theta]", ",", "0"}], "]"}]}], 
        SuperscriptBox["\[Rho]", "3"]]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "\"\<Preparing integrand\>\"", "]"}], ";"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"IUpPlus", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Rup", "'"}], "[", "r0", "]"}], 
        RowBox[{"(", 
         RowBox[{
         "Ann0Plus", " ", "+", " ", "Anm0Plus", " ", "+", " ", "Amm0Plus"}], 
         ")"}]}], "+", 
       RowBox[{
        RowBox[{"Rup", "[", "r0", "]"}], 
        RowBox[{"(", 
         RowBox[{
         "drAnn0Plus", " ", "+", " ", "drAnm0Plus", " ", "+", " ", 
          "drAmm0Plus"}], ")"}]}], "-", 
       RowBox[{
        RowBox[{
         RowBox[{"Rup", "''"}], "[", "r0", "]"}], 
        RowBox[{"(", 
         RowBox[{"Anm1Plus", "+", "Amm1Plus"}], ")"}]}], "-", 
       RowBox[{
        RowBox[{
         RowBox[{"Rup", "'"}], "[", "r0", "]"}], 
        RowBox[{"(", 
         RowBox[{"drAnm1Plus", "+", "drAmm1Plus"}], ")"}]}], "+", 
       RowBox[{
        RowBox[{
         RowBox[{"Rup", "'''"}], "[", "r0", "]"}], "Amm2Plus"}], "+", 
       RowBox[{
        RowBox[{
         RowBox[{"Rup", "''"}], "[", "r0", "]"}], "drAmm2Plus"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"IUpMinus", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Rup", "'"}], "[", "r0", "]"}], 
        RowBox[{"(", 
         RowBox[{
         "Ann0Minus", " ", "+", " ", "Anm0Minus", " ", "+", " ", 
          "Amm0Minus"}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"Rup", "[", "r0", "]"}], 
        RowBox[{"(", 
         RowBox[{
         "drAnn0Minus", " ", "+", " ", "drAnm0Minus", " ", "+", " ", 
          "drAmm0Minus"}], ")"}]}], "-", 
       RowBox[{
        RowBox[{
         RowBox[{"Rup", "''"}], "[", "r0", "]"}], 
        RowBox[{"(", 
         RowBox[{"Anm1Minus", "+", "Amm1Minus"}], ")"}]}], "-", 
       RowBox[{
        RowBox[{
         RowBox[{"Rup", "'"}], "[", "r0", "]"}], 
        RowBox[{"(", 
         RowBox[{"drAnm1Minus", "+", "drAmm1Minus"}], ")"}]}], "+", 
       RowBox[{
        RowBox[{
         RowBox[{"Rup", "'''"}], "[", "r0", "]"}], "Amm2Minus"}], "+", 
       RowBox[{
        RowBox[{
         RowBox[{"Rup", "''"}], "[", "r0", "]"}], "drAmm2Minus"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"IInPlus", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Rin", "'"}], "[", "r0", "]"}], 
        RowBox[{"(", 
         RowBox[{
         "Ann0Plus", " ", "+", " ", "Anm0Plus", " ", "+", " ", "Amm0Plus"}], 
         ")"}]}], "+", 
       RowBox[{
        RowBox[{"Rin", "[", "r0", "]"}], 
        RowBox[{"(", 
         RowBox[{
         "drAnn0Plus", " ", "+", " ", "drAnm0Plus", " ", "+", " ", 
          "drAmm0Plus"}], ")"}]}], "-", 
       RowBox[{
        RowBox[{
         RowBox[{"Rin", "''"}], "[", "r0", "]"}], 
        RowBox[{"(", 
         RowBox[{"Anm1Plus", "+", "Amm1Plus"}], ")"}]}], "-", 
       RowBox[{
        RowBox[{
         RowBox[{"Rin", "'"}], "[", "r0", "]"}], 
        RowBox[{"(", 
         RowBox[{"drAnm1Plus", "+", "drAmm1Plus"}], ")"}]}], "+", 
       RowBox[{
        RowBox[{
         RowBox[{"Rin", "'''"}], "[", "r0", "]"}], "Amm2Plus"}], "+", 
       RowBox[{
        RowBox[{
         RowBox[{"Rin", "''"}], "[", "r0", "]"}], "drAmm2Plus"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"IInMinus", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Rin", "'"}], "[", "r0", "]"}], 
        RowBox[{"(", 
         RowBox[{
         "Ann0Minus", " ", "+", " ", "Anm0Minus", " ", "+", " ", 
          "Amm0Minus"}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"Rin", "[", "r0", "]"}], 
        RowBox[{"(", 
         RowBox[{
         "drAnn0Minus", " ", "+", " ", "drAnm0Minus", " ", "+", " ", 
          "drAmm0Minus"}], ")"}]}], "-", 
       RowBox[{
        RowBox[{
         RowBox[{"Rin", "''"}], "[", "r0", "]"}], 
        RowBox[{"(", 
         RowBox[{"Anm1Minus", "+", "Amm1Minus"}], ")"}]}], "-", 
       RowBox[{
        RowBox[{
         RowBox[{"Rin", "'"}], "[", "r0", "]"}], 
        RowBox[{"(", 
         RowBox[{"drAnm1Minus", "+", "drAmm1Minus"}], ")"}]}], "+", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"Rin", "'''"}], "[", "r0", "]"}], "Amm2Minus"}], "+", 
       RowBox[{
        RowBox[{
         RowBox[{"Rup", "''"}], "[", "r0", "]"}], "drAmm2Minus"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "\"\<Integrating\>\"", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Zin", " ", "=", " ", 
      RowBox[{"Quiet", "[", 
       RowBox[{
        FractionBox[
         RowBox[{"-", "1"}], "Const"], 
        FractionBox[
         RowBox[{"2", "\[Pi]"}], "T\[Theta]"], 
        RowBox[{"(", 
         RowBox[{"NIntegrate", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              FractionBox[
               RowBox[{"\[Gamma]", "+", 
                RowBox[{
                 SuperscriptBox["a", "2"], "\[ScriptCapitalE]", " ", "z"}]}], 
               SqrtBox[
                RowBox[{"\[Beta]", 
                 RowBox[{"(", 
                  RowBox[{"zp", "-", "z"}], ")"}]}]]], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SuperscriptBox["E", 
                  RowBox[{"I", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Omega]", " ", "t0"}], "-", 
                    RowBox[{"m", " ", "\[Phi]0"}]}], ")"}]}]], "IInPlus"}], 
                "+", 
                RowBox[{
                 SuperscriptBox["E", 
                  RowBox[{
                   RowBox[{"-", "I"}], 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Omega]", " ", "t0"}], "-", 
                    RowBox[{"m", " ", "\[Phi]0"}]}], ")"}]}]], "IInMinus"}]}],
                ")"}]}], ")"}], "/.", 
            RowBox[{"{", 
             RowBox[{"\[Chi]", "->", "\[Chi]0"}], "}"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Chi]0", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
           RowBox[{"WorkingPrecision", "\[Rule]", "\[Sigma]"}]}], "]"}], 
         RowBox[{"(*", 
          RowBox[{"+", 
           RowBox[{"NIntegrate", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                FractionBox[
                 RowBox[{"\[Gamma]", "+", 
                  RowBox[{
                   SuperscriptBox["a", "2"], "\[ScriptCapitalE]", " ", 
                   "z"}]}], 
                 SqrtBox[
                  RowBox[{"\[Beta]", 
                   RowBox[{"(", 
                    RowBox[{"zp", "-", "z"}], ")"}]}]]], 
                SuperscriptBox["E", 
                 RowBox[{
                  RowBox[{"-", "I"}], 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"\[Omega]", " ", "t0"}], "-", 
                    RowBox[{"m", " ", "\[Phi]0"}]}], ")"}]}]], "IInMinus"}], 
               ")"}], "/.", 
              RowBox[{"{", 
               RowBox[{"\[Chi]", "->", "\[Chi]0"}], "}"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Chi]0", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
             RowBox[{"WorkingPrecision", "\[Rule]", "\[Sigma]"}]}], "]"}]}], 
          "*)"}], 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
            RowBox[{"+", 
             SuperscriptBox["E", 
              RowBox[{"I", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"\[Omega]", " ", "t0\[Pi]2"}], "-", 
                 RowBox[{"m", " ", "\[Phi]0\[Pi]2"}]}], ")"}]}]]}], 
            RowBox[{"NIntegrate", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{"\[Gamma]", "+", 
                   RowBox[{
                    SuperscriptBox["a", "2"], "\[ScriptCapitalE]", " ", 
                    "z"}]}], 
                  SqrtBox[
                   RowBox[{"\[Beta]", 
                    RowBox[{"(", 
                    RowBox[{"zp", "-", "z"}], ")"}]}]]], 
                 SuperscriptBox["E", 
                  RowBox[{"I", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Omega]", " ", "t0\[Chi]m\[Pi]2"}], "-", 
                    RowBox[{"m", " ", "\[Phi]0\[Chi]m\[Pi]2"}]}], ")"}]}]], 
                 "IInPlus"}], ")"}], "/.", 
               RowBox[{"{", 
                RowBox[{"\[Chi]", "->", "\[Chi]0"}], "}"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"\[Chi]0", ",", 
                FractionBox["\[Pi]", "2"], ",", "\[Pi]"}], "}"}], ",", 
              RowBox[{"WorkingPrecision", "\[Rule]", "\[Sigma]"}]}], "]"}]}], 
           "+", 
           RowBox[{
            SuperscriptBox["E", 
             RowBox[{
              RowBox[{"-", "I"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[Omega]", " ", "t0\[Pi]2"}], "-", 
                RowBox[{"m", " ", "\[Phi]0\[Pi]2"}]}], ")"}]}]], 
            RowBox[{"NIntegrate", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{"\[Gamma]", "+", 
                   RowBox[{
                    SuperscriptBox["a", "2"], "\[ScriptCapitalE]", " ", 
                    "z"}]}], 
                  SqrtBox[
                   RowBox[{"\[Beta]", 
                    RowBox[{"(", 
                    RowBox[{"zp", "-", "z"}], ")"}]}]]], 
                 SuperscriptBox["E", 
                  RowBox[{
                   RowBox[{"-", "I"}], 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Omega]", " ", "t0\[Chi]m\[Pi]2"}], "-", 
                    RowBox[{"m", " ", "\[Phi]0\[Chi]m\[Pi]2"}]}], ")"}]}]], 
                 "IInMinus"}], ")"}], "/.", 
               RowBox[{"{", 
                RowBox[{"\[Chi]", "->", "\[Chi]0"}], "}"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"\[Chi]0", ",", 
                FractionBox["\[Pi]", "2"], ",", "\[Pi]"}], "}"}], ",", 
              RowBox[{"WorkingPrecision", "\[Rule]", "\[Sigma]"}]}], 
             "]"}]}]}], "*)"}], ")"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Zup", " ", "=", " ", 
      RowBox[{"Quiet", "[", 
       RowBox[{
        FractionBox[
         RowBox[{"-", "1"}], "Const"], 
        FractionBox[
         RowBox[{"2", "\[Pi]"}], "T\[Theta]"], 
        RowBox[{"(", 
         RowBox[{"NIntegrate", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              FractionBox[
               RowBox[{"\[Gamma]", "+", 
                RowBox[{
                 SuperscriptBox["a", "2"], "\[ScriptCapitalE]", " ", "z"}]}], 
               SqrtBox[
                RowBox[{"\[Beta]", 
                 RowBox[{"(", 
                  RowBox[{"zp", "-", "z"}], ")"}]}]]], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SuperscriptBox["E", 
                  RowBox[{"I", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Omega]", " ", "t0"}], "-", 
                    RowBox[{"m", " ", "\[Phi]0"}]}], ")"}]}]], "IUpPlus"}], 
                "+", 
                RowBox[{
                 SuperscriptBox["E", 
                  RowBox[{
                   RowBox[{"-", "I"}], 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Omega]", " ", "t0"}], "-", 
                    RowBox[{"m", " ", "\[Phi]0"}]}], ")"}]}]], "IUpMinus"}]}],
                ")"}]}], ")"}], "/.", 
            RowBox[{"{", 
             RowBox[{"\[Chi]", "->", "\[Chi]0"}], "}"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Chi]0", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
           RowBox[{"WorkingPrecision", "\[Rule]", "\[Sigma]"}]}], "]"}], 
         RowBox[{"(*", 
          RowBox[{"+", 
           RowBox[{"NIntegrate", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                FractionBox[
                 RowBox[{"\[Gamma]", "+", 
                  RowBox[{
                   SuperscriptBox["a", "2"], "\[ScriptCapitalE]", " ", 
                   "z"}]}], 
                 SqrtBox[
                  RowBox[{"\[Beta]", 
                   RowBox[{"(", 
                    RowBox[{"zp", "-", "z"}], ")"}]}]]], 
                SuperscriptBox["E", 
                 RowBox[{
                  RowBox[{"-", "I"}], 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"\[Omega]", " ", "t0"}], "-", 
                    RowBox[{"m", " ", "\[Phi]0"}]}], ")"}]}]], "IUpMinus"}], 
               ")"}], "/.", 
              RowBox[{"{", 
               RowBox[{"\[Chi]", "->", "\[Chi]0"}], "}"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Chi]0", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
             RowBox[{"WorkingPrecision", "\[Rule]", "\[Sigma]"}]}], "]"}]}], 
          "*)"}], 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
            RowBox[{"+", 
             SuperscriptBox["E", 
              RowBox[{"I", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"\[Omega]", " ", "t0\[Pi]2"}], "-", 
                 RowBox[{"m", " ", "\[Phi]0\[Pi]2"}]}], ")"}]}]]}], 
            RowBox[{"NIntegrate", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{"\[Gamma]", "+", 
                   RowBox[{
                    SuperscriptBox["a", "2"], "\[ScriptCapitalE]", " ", 
                    "z"}]}], 
                  SqrtBox[
                   RowBox[{"\[Beta]", 
                    RowBox[{"(", 
                    RowBox[{"zp", "-", "z"}], ")"}]}]]], 
                 SuperscriptBox["E", 
                  RowBox[{"I", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Omega]", " ", "t0\[Chi]m\[Pi]2"}], "-", 
                    RowBox[{"m", " ", "\[Phi]0\[Chi]m\[Pi]2"}]}], ")"}]}]], 
                 "IUpPlus"}], ")"}], "/.", 
               RowBox[{"{", 
                RowBox[{"\[Chi]", "->", "\[Chi]0"}], "}"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"\[Chi]0", ",", 
                FractionBox["\[Pi]", "2"], ",", "\[Pi]"}], "}"}], ",", 
              RowBox[{"WorkingPrecision", "\[Rule]", "\[Sigma]"}]}], "]"}]}], 
           "+", 
           RowBox[{
            SuperscriptBox["E", 
             RowBox[{
              RowBox[{"-", "I"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[Omega]", " ", "t0\[Pi]2"}], "-", 
                RowBox[{"m", " ", "\[Phi]0\[Pi]2"}]}], ")"}]}]], 
            RowBox[{"NIntegrate", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{"\[Gamma]", "+", 
                   RowBox[{
                    SuperscriptBox["a", "2"], "\[ScriptCapitalE]", " ", 
                    "z"}]}], 
                  SqrtBox[
                   RowBox[{"\[Beta]", 
                    RowBox[{"(", 
                    RowBox[{"zp", "-", "z"}], ")"}]}]]], 
                 SuperscriptBox["E", 
                  RowBox[{
                   RowBox[{"-", "I"}], 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Omega]", " ", "t0\[Chi]m\[Pi]2"}], "-", 
                    RowBox[{"m", " ", "\[Phi]0\[Chi]m\[Pi]2"}]}], ")"}]}]], 
                 "IUpMinus"}], ")"}], "/.", 
               RowBox[{"{", 
                RowBox[{"\[Chi]", "->", "\[Chi]0"}], "}"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"\[Chi]0", ",", 
                FractionBox["\[Pi]", "2"], ",", "\[Pi]"}], "}"}], ",", 
              RowBox[{"WorkingPrecision", "\[Rule]", "\[Sigma]"}]}], 
             "]"}]}]}], "*)"}], ")"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"amplitudes", " ", "=", " ", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<\[ScriptCapitalI]\>\"", "->", "Zin"}], ",", 
        RowBox[{"\"\<\[ScriptCapitalH]\>\"", "->", "Zup"}]}], "|>"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"assoc", " ", "=", " ", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<l\>\"", "->", "l"}], ",", 
        RowBox[{"\"\<m\>\"", "->", "m"}], ",", 
        RowBox[{"\"\<k\>\"", "->", "k"}], ",", 
        RowBox[{"\"\<\[Omega]\>\"", "->", "\[Omega]"}], ",", 
        RowBox[{"\"\<Eigenvalue\>\"", "->", "eval"}], ",", " ", 
        RowBox[{"\"\<Orbit\>\"", "->", "orbit"}], ",", " ", 
        RowBox[{"\"\<Amplitudes\>\"", "->", "amplitudes"}]}], "|>"}]}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{
  3.86541445609509*^9, {3.865416053339839*^9, 3.865416143682665*^9}, {
   3.8654166980445185`*^9, 3.8654168994697723`*^9}, {3.86541695905197*^9, 
   3.865416977184563*^9}, {3.8654170596482143`*^9, 3.865417094262841*^9}, {
   3.8654177749356227`*^9, 3.8654177766418276`*^9}, {3.8654178338756175`*^9, 
   3.8654178348533087`*^9}, {3.8654179960668793`*^9, 3.865418115125719*^9}, {
   3.8654181873450522`*^9, 3.86541824193364*^9}, 3.865418388641013*^9, {
   3.8662753931616497`*^9, 
   3.866275397460039*^9}},ExpressionUUID->"3805722c-2194-432d-a59c-\
d4d1e5397718"]
}, Open  ]],

Cell[CellGroupData[{

Cell["4th Term Stress-Energy (\[OpenCurlyDoubleQuote]\[Theta]\
\[CloseCurlyDoubleQuote] term)", "Subsubsection",
 CellChangeTimes->{{3.8654002715572414`*^9, 3.8654002794004917`*^9}, {
  3.8654029145973597`*^9, 
  3.8654029200144424`*^9}},ExpressionUUID->"1d97f17e-42fb-4217-87f3-\
b99cc7faf9f2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Source4", "[", 
   RowBox[{"l_", ",", "m_", ",", "k_", ",", "orbit_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "a", ",", "r0", ",", "e", ",", "x", ",", "\[ScriptCapitalE]", ",", 
      "\[ScriptCapitalL]", ",", "\[ScriptCapitalQ]", ",", "\[Beta]", ",", 
      "zm", ",", "zp", ",", "\[Theta]", ",", "z", ",", "\[CapitalDelta]", ",",
       "\[CapitalSigma]", ",", "\[Rho]", ",", "\[Rho]b", ",", "ut", ",", 
      "\[CapitalTheta]", ",", "\[Chi]", ",", "CnnPlus", ",", "CnnMinus", ",", 
      "CnmPlus", ",", "CnmMinus", ",", "CmmPlus", ",", "CmmMinus", ",", 
      "d\[Theta]CnnPlus", ",", "d\[Theta]CnnMinus", ",", "d\[Theta]CnmPlus", 
      ",", "d\[Theta]CnmMinus", ",", "d\[Theta]CmmPlus", ",", 
      "d\[Theta]CmmMinus", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"Orbital", " ", "Params"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"a", "   ", "=", " ", 
      RowBox[{"orbit", "[", "\"\<a\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"r0", " ", "=", " ", 
      RowBox[{"orbit", "[", "\"\<p\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"e", "   ", "=", " ", 
      RowBox[{"orbit", "[", "\"\<Eccentricity\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"x", "   ", "=", " ", 
      RowBox[{"orbit", "[", "\"\<Inclination\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"Constants", " ", "of", " ", "motion"}], " ", "&"}], " ", 
       "Frequencies"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"\[ScriptCapitalE]", " ", "=", " ", 
      RowBox[{"orbit", "[", "\"\<Energy\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[ScriptCapitalL]", " ", "=", " ", 
      RowBox[{"orbit", "[", "\"\<AngularMomentum\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[ScriptCapitalQ]", " ", "=", " ", 
      RowBox[{"orbit", "[", "\"\<CarterConstant\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Definitions", " ", "and", " ", "reparameterisation"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"\[Beta]", "=", 
      RowBox[{
       SuperscriptBox["a", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SuperscriptBox["\[ScriptCapitalE]", "2"]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"zm", ",", "zp"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        FractionBox[
         RowBox[{
          SuperscriptBox["\[ScriptCapitalL]", "2"], "+", "\[ScriptCapitalQ]", 
          "+", "\[Beta]", "-", 
          RowBox[{"\[Beta]", " ", 
           SqrtBox[
            FractionBox[
             RowBox[{
              SuperscriptBox["\[ScriptCapitalL]", "4"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"\[ScriptCapitalQ]", "-", "\[Beta]"}], ")"}], "2"], 
              "+", 
              RowBox[{"2", " ", 
               SuperscriptBox["\[ScriptCapitalL]", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"\[ScriptCapitalQ]", "+", "\[Beta]"}], ")"}]}]}], 
             SuperscriptBox["\[Beta]", "2"]]]}]}], 
         RowBox[{"2", " ", "\[Beta]"}]], ",", 
        FractionBox[
         RowBox[{
          SuperscriptBox["\[ScriptCapitalL]", "2"], "+", "\[ScriptCapitalQ]", 
          "+", "\[Beta]", "+", 
          RowBox[{"\[Beta]", " ", 
           SqrtBox[
            FractionBox[
             RowBox[{
              SuperscriptBox["\[ScriptCapitalL]", "4"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"\[ScriptCapitalQ]", "-", "\[Beta]"}], ")"}], "2"], 
              "+", 
              RowBox[{"2", " ", 
               SuperscriptBox["\[ScriptCapitalL]", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"\[ScriptCapitalQ]", "+", "\[Beta]"}], ")"}]}]}], 
             SuperscriptBox["\[Beta]", "2"]]]}]}], 
         RowBox[{"2", " ", "\[Beta]"}]]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\[Theta]", "=", 
      RowBox[{"ArcCos", "[", 
       RowBox[{
        SqrtBox["zm"], " ", 
        RowBox[{"Cos", "[", "\[Chi]", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\[CapitalDelta]", "=", 
      RowBox[{
       SuperscriptBox["r0", "2"], "-", 
       RowBox[{"2", "r0"}], "+", 
       SuperscriptBox["a", "2"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[CapitalSigma]", "=", 
      RowBox[{
       SuperscriptBox["r0", "2"], "+", 
       RowBox[{
        SuperscriptBox["a", "2"], 
        SuperscriptBox[
         RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Rho]", "=", 
      FractionBox[
       RowBox[{"-", "1"}], 
       RowBox[{"r0", "-", 
        RowBox[{"I", " ", "a", " ", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Rho]b", "=", 
      FractionBox[
       RowBox[{"-", "1"}], 
       RowBox[{"r0", "+", 
        RowBox[{"I", " ", "a", " ", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}]]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"ut", "=", 
      RowBox[{
       FractionBox["1", "\[CapitalSigma]"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[ScriptCapitalE]", 
          RowBox[{"(", 
           RowBox[{
            FractionBox[
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["r0", "2"], "+", 
                SuperscriptBox["a", "2"]}], ")"}], "2"], "\[CapitalDelta]"], 
            "-", 
            RowBox[{
             SuperscriptBox["a", "2"], 
             SuperscriptBox[
              RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]}], ")"}]}], "+", 
         RowBox[{"a", " ", "\[ScriptCapitalL]", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            FractionBox[
             RowBox[{
              SuperscriptBox["r0", "2"], "+", 
              SuperscriptBox["a", "2"]}], "\[CapitalDelta]"]}], ")"}]}]}], 
        ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[CapitalTheta]", "=", 
      SqrtBox[
       RowBox[{"\[ScriptCapitalQ]", "-", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"Cot", "[", "\[Theta]", "]"}], "2"], 
         SuperscriptBox["\[ScriptCapitalL]", "2"]}], "-", 
        RowBox[{
         SuperscriptBox["a", "2"], 
         SuperscriptBox[
          RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           SuperscriptBox["\[ScriptCapitalE]", "2"]}], ")"}]}]}]]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Stress", " ", "energy", " ", "projected", " ", "onto", " ", "tetrad", 
       " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[PlusMinus]", "\[CapitalTheta]"}], " ", "for", " ", 
         "travelling", " ", "up", " ", "or", " ", "down"}], ")"}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       SubscriptBox["C", "ab"], " ", "to", " ", "be", " ", "replaced", " ", 
       "by", " ", "Josh"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"CnnPlus", "=", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"4", " ", 
         SuperscriptBox["\[CapitalSigma]", "3"], "ut"}]], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[ScriptCapitalE]", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["r0", "2"], "+", 
             SuperscriptBox["a", "2"]}], ")"}]}], "-", 
          RowBox[{"a", " ", "\[ScriptCapitalL]"}]}], ")"}], "2"]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"CnmPlus", "=", 
      RowBox[{
       FractionBox["\[Rho]", 
        RowBox[{"2", 
         SqrtBox["2"], 
         SuperscriptBox["\[CapitalSigma]", "2"], "ut"}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[ScriptCapitalE]", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["r0", "2"], "+", 
            SuperscriptBox["a", "2"]}], ")"}]}], "-", 
         RowBox[{"a", " ", "\[ScriptCapitalL]"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"I", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a", " ", "\[ScriptCapitalE]"}], "-", 
            FractionBox["\[ScriptCapitalL]", 
             SuperscriptBox[
              RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]]}], ")"}]}], "+", 
         " ", "\[CapitalTheta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"CmmPlus", "=", 
      RowBox[{
       FractionBox[
        SuperscriptBox["\[Rho]", "2"], 
        RowBox[{"2", "\[CapitalSigma]", " ", "ut"}]], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"I", " ", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"a", " ", "\[ScriptCapitalE]"}], "-", 
             FractionBox["\[ScriptCapitalL]", 
              SuperscriptBox[
               RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]]}], ")"}]}], "+", 
          " ", "\[CapitalTheta]"}], ")"}], "2"]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"CnnMinus", "=", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"4", " ", 
         SuperscriptBox["\[CapitalSigma]", "3"], "ut"}]], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[ScriptCapitalE]", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["r0", "2"], "+", 
             SuperscriptBox["a", "2"]}], ")"}]}], "-", 
          RowBox[{"a", " ", "\[ScriptCapitalL]"}]}], ")"}], "2"]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"CnmMinus", "=", 
      RowBox[{
       FractionBox["\[Rho]", 
        RowBox[{"2", 
         SqrtBox["2"], 
         SuperscriptBox["\[CapitalSigma]", "2"], "ut"}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[ScriptCapitalE]", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["r0", "2"], "+", 
            SuperscriptBox["a", "2"]}], ")"}]}], "-", 
         RowBox[{"a", " ", "\[ScriptCapitalL]"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"I", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a", " ", "\[ScriptCapitalE]"}], "-", 
            FractionBox["\[ScriptCapitalL]", 
             SuperscriptBox[
              RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]]}], ")"}]}], "-", 
         " ", "\[CapitalTheta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"CmmMinus", "=", 
      RowBox[{
       FractionBox[
        SuperscriptBox["\[Rho]", "2"], 
        RowBox[{"2", "\[CapitalSigma]", " ", "ut"}]], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"I", " ", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"a", " ", "\[ScriptCapitalE]"}], "-", 
             FractionBox["\[ScriptCapitalL]", 
              SuperscriptBox[
               RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]]}], ")"}]}], "-", 
          " ", "\[CapitalTheta]"}], ")"}], "2"]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"d\[Theta]", " ", "->", " ", 
       SubscriptBox["\[PartialD]", "\[Theta]"]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"d\[Theta]CnnPlus", "=", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"4", " ", 
         SuperscriptBox["\[CapitalSigma]", "3"], "ut"}]], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[ScriptCapitalE]", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["r0", "2"], "+", 
             SuperscriptBox["a", "2"]}], ")"}]}], "-", 
          RowBox[{"a", " ", "\[ScriptCapitalL]"}]}], ")"}], "2"]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"d\[Theta]CnmPlus", "=", 
      RowBox[{
       FractionBox["\[Rho]", 
        RowBox[{"2", 
         SqrtBox["2"], 
         SuperscriptBox["\[CapitalSigma]", "2"], "ut"}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[ScriptCapitalE]", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["r0", "2"], "+", 
            SuperscriptBox["a", "2"]}], ")"}]}], "-", 
         RowBox[{"a", " ", "\[ScriptCapitalL]"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"I", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a", " ", "\[ScriptCapitalE]"}], "-", 
            FractionBox["\[ScriptCapitalL]", 
             SuperscriptBox[
              RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]]}], ")"}]}], "+", 
         " ", "\[CapitalTheta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"d\[Theta]CmmPlus", "=", 
      RowBox[{
       FractionBox[
        SuperscriptBox["\[Rho]", "2"], 
        RowBox[{"2", "\[CapitalSigma]", " ", "ut"}]], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"I", " ", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"a", " ", "\[ScriptCapitalE]"}], "-", 
             FractionBox["\[ScriptCapitalL]", 
              SuperscriptBox[
               RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]]}], ")"}]}], "+", 
          " ", "\[CapitalTheta]"}], ")"}], "2"]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"d\[Theta]CnnMinus", "=", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"4", " ", 
         SuperscriptBox["\[CapitalSigma]", "3"], "ut"}]], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[ScriptCapitalE]", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["r0", "2"], "+", 
             SuperscriptBox["a", "2"]}], ")"}]}], "-", 
          RowBox[{"a", " ", "\[ScriptCapitalL]"}]}], ")"}], "2"]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"d\[Theta]CnmMinus", "=", 
      RowBox[{
       FractionBox["\[Rho]", 
        RowBox[{"2", 
         SqrtBox["2"], 
         SuperscriptBox["\[CapitalSigma]", "2"], "ut"}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[ScriptCapitalE]", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["r0", "2"], "+", 
            SuperscriptBox["a", "2"]}], ")"}]}], "-", 
         RowBox[{"a", " ", "\[ScriptCapitalL]"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"I", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a", " ", "\[ScriptCapitalE]"}], "-", 
            FractionBox["\[ScriptCapitalL]", 
             SuperscriptBox[
              RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]]}], ")"}]}], "-", 
         " ", "\[CapitalTheta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"d\[Theta]CmmMinus", "=", 
      RowBox[{
       FractionBox[
        SuperscriptBox["\[Rho]", "2"], 
        RowBox[{"2", "\[CapitalSigma]", " ", "ut"}]], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"I", " ", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"a", " ", "\[ScriptCapitalE]"}], "-", 
             FractionBox["\[ScriptCapitalL]", 
              SuperscriptBox[
               RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]]}], ")"}]}], "-", 
          " ", "\[CapitalTheta]"}], ")"}], "2"]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Rewriting", " ", "source"}], "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"assoc", " ", "=", " ", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<l\>\"", "->", "l"}], ",", 
        RowBox[{"\"\<m\>\"", "->", "m"}], ",", 
        RowBox[{"\"\<k\>\"", "->", "k"}], ",", 
        RowBox[{"\"\<Orbit\>\"", "->", "orbit"}], ",", 
        RowBox[{"\"\<Cnn+\>\"", "->", "CnnPlus"}], ",", 
        RowBox[{"\"\<Cnn-\>\"", "->", "CnnMinus"}], ",", 
        RowBox[{"\"\<Cnm+\>\"", "->", "CnmPlus"}], ",", 
        RowBox[{"\"\<Cnm-\>\"", "->", "CnmMinus"}], ",", 
        RowBox[{"\"\<Cmm+\>\"", "->", "CmmPlus"}], ",", 
        RowBox[{"\"\<Cmm-\>\"", "->", "CmmMinus"}], ",", 
        RowBox[{"\"\<dCnn+\>\"", "->", "d\[Theta]CnnPlus"}], ",", 
        RowBox[{"\"\<dCnn-\>\"", "->", "d\[Theta]CnnMinus"}], ",", 
        RowBox[{"\"\<dCnm+\>\"", "->", "d\[Theta]CnmPlus"}], ",", 
        RowBox[{"\"\<dCnm-\>\"", "->", "d\[Theta]CnmMinus"}], ",", 
        RowBox[{"\"\<dCmm+\>\"", "->", "d\[Theta]CmmPlus"}], ",", 
        RowBox[{"\"\<dCmm-\>\"", "->", "d\[Theta]CmmMinus"}], ",", 
        RowBox[{"\"\<\[Chi]\>\"", "->", "\[Chi]"}]}], "|>"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.8654013846689186`*^9, 3.865401401515535*^9}, {
  3.86540161104801*^9, 3.865401636117961*^9}, {3.865401682929507*^9, 
  3.8654016905940776`*^9}, {3.8654106879842196`*^9, 
  3.8654107251075583`*^9}},ExpressionUUID->"b1bc7c4c-cabc-43c0-8d21-\
a3e9b0a04a54"]
}, Open  ]],

Cell[CellGroupData[{

Cell["4th Term Convolution (\[OpenCurlyDoubleQuote]\[Theta]\
\[CloseCurlyDoubleQuote] term)", "Subsubsection",
 CellChangeTimes->{{3.8654003886957903`*^9, 3.8654004013049726`*^9}, {
  3.865402975992773*^9, 
  3.8654029809202785`*^9}},ExpressionUUID->"a7f7b77c-3838-4f29-9402-\
87f035bd1256"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Convolver4", "[", "source_", "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "l", ",", "m", ",", "k", ",", "orbit", ",", "a", ",", "r0", ",", "e", 
      ",", "x", ",", "\[ScriptCapitalE]", ",", "\[ScriptCapitalL]", ",", 
      "\[ScriptCapitalQ]", ",", "\[Beta]", ",", "\[Gamma]", ",", "\[Delta]", 
      ",", "zm", ",", "zp", ",", "\[Theta]", ",", "z", ",", "\[CapitalDelta]",
       ",", "\[CapitalSigma]", ",", "\[Rho]", ",", "\[Rho]b", ",", 
      "\[CapitalOmega]\[Theta]", ",", "\[CapitalOmega]\[Phi]", ",", 
      "T\[Theta]", ",", "\[Omega]", ",", "S", ",", "Ld2S", ",", "Ld1Ld2S", 
      ",", "Kf", ",", "dK\[CapitalDelta]", ",", "ut", ",", "\[CapitalTheta]", 
      ",", "\[Chi]", ",", "t0", ",", "t0\[Pi]2", ",", "t0\[Chi]m\[Pi]2", ",", 
      "\[Phi]0", ",", "\[Phi]0\[Pi]2", ",", "\[Phi]0\[Chi]m\[Pi]2", ",", 
      "CnnPlus", ",", "CnnMinus", ",", "CnmPlus", ",", "CnmMinus", ",", 
      "CmmPlus", ",", "CmmMinus", ",", "d\[Theta]CnnPlus", ",", 
      "d\[Theta]CnmPlus", ",", "d\[Theta]CmmPlus", ",", "d\[Theta]CnnMinus", 
      ",", "d\[Theta]CnmMinus", ",", "d\[Theta]CmmMinus", ",", "Ann0Plus", 
      ",", "Anm0Plus", ",", "Amm0Plus", ",", "Anm1Plus", ",", "Amm1Plus", ",",
       "Amm2Plus", ",", "Ann0Minus", ",", "Anm0Minus", ",", "Amm0Minus", ",", 
      "Anm1Minus", ",", "Amm1Minus", ",", "Amm2Minus", ",", "R", ",", "Rin", 
      ",", "Rup", ",", "Const", ",", "IUpPlus", ",", "IUpMinus", ",", 
      "IInPlus", ",", "IInMinus", ",", "Zin", ",", "Zup", ",", "assoc", ",", 
      " ", "amplitudes", ",", "eval", ",", "Bin", ",", "Bhole", ",", 
      "\[Sigma]", ",", "M"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"M", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "Print", "[", "\"\<Getting l, m, k, orbital params, constants\>\"", 
        "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"l", " ", "=", " ", 
      RowBox[{"source", "[", "\"\<l\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"m", " ", "=", " ", 
      RowBox[{"source", "[", "\"\<m\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"k", " ", "=", " ", 
      RowBox[{"source", "[", "\"\<k\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"orbit", " ", "=", " ", 
      RowBox[{"source", "[", "\"\<Orbit\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Chi]", " ", "=", " ", 
      RowBox[{"source", "[", "\"\<\[Chi]\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"a", "   ", "=", " ", 
      RowBox[{"orbit", "[", "\"\<a\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"r0", " ", "=", " ", 
      RowBox[{"orbit", "[", "\"\<p\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"e", "   ", "=", " ", 
      RowBox[{"orbit", "[", "\"\<e\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"x", "   ", "=", " ", 
      RowBox[{"orbit", "[", "\"\<Inclination\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"StringJoin", "[", 
         RowBox[{"\"\<a = \>\"", ",", 
          RowBox[{"ToString", "[", "a", "]"}], ",", "\"\<, r0 = \>\"", ",", 
          RowBox[{"ToString", "[", "r0", "]"}], ",", "\"\<, e = \>\"", ",", 
          RowBox[{"ToString", "[", "e", "]"}], ",", "\"\<, x = \>\"", ",", 
          RowBox[{"ToString", "[", "x", "]"}]}], "]"}], "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"Constants", " ", "of", " ", "motion"}], " ", "&"}], " ", 
       "Frequencies"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"\[ScriptCapitalE]", " ", "=", " ", 
      RowBox[{"orbit", "[", "\"\<Energy\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[ScriptCapitalL]", " ", "=", " ", 
      RowBox[{"orbit", "[", "\"\<AngularMomentum\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[ScriptCapitalQ]", " ", "=", " ", 
      RowBox[{"orbit", "[", "\"\<CarterConstant\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"StringJoin", "[", 
         RowBox[{"\"\<Energy = \>\"", ",", 
          RowBox[{"ToString", "[", "\[ScriptCapitalE]", "]"}], ",", 
          "\"\<, Angular Momentum = \>\"", ",", 
          RowBox[{"ToString", "[", "\[ScriptCapitalL]", "]"}], ",", 
          "\"\<, Carter constant = \>\"", ",", 
          RowBox[{"ToString", "[", "\[ScriptCapitalQ]", "]"}]}], "]"}], "]"}],
        ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "\"\<Calculating Frequencies\>\"", "]"}], ";"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[CapitalOmega]\[Theta]", ",", "\[CapitalOmega]\[Phi]"}], 
       "}"}], "=", 
      RowBox[{
       RowBox[{"Values", "[", 
        RowBox[{"KerrGeoFrequencies", "[", 
         RowBox[{"a", ",", "r0", ",", "e", ",", "x"}], "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"2", ";;", "3"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"T\[Theta]", " ", "=", " ", 
      FractionBox[
       RowBox[{"2", "\[Pi]"}], "\[CapitalOmega]\[Theta]"]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Omega]", " ", "=", " ", 
      RowBox[{
       RowBox[{"m", " ", "\[CapitalOmega]\[Phi]"}], " ", "+", " ", 
       RowBox[{"k", " ", "\[CapitalOmega]\[Theta]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Sigma]", " ", "=", 
      RowBox[{".7", " ", 
       RowBox[{"Precision", "[", "\[Omega]", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"StringJoin", "[", 
         RowBox[{"\"\<\[CapitalOmega]\[Theta] = \>\"", ",", 
          RowBox[{"ToString", "[", "\[CapitalOmega]\[Theta]", "]"}], ",", 
          "\"\<, \[CapitalOmega]\[Phi] = \>\"", ",", 
          RowBox[{"ToString", "[", "\[CapitalOmega]\[Phi]", "]"}], ",", 
          "\"\<, \[Omega] = \>\"", ",", 
          RowBox[{"ToString", "[", "\[Omega]", "]"}]}], "]"}], "]"}], ";"}], 
      "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"\[CapitalDelta]", "=", 
      RowBox[{
       SuperscriptBox["r0", "2"], "-", 
       RowBox[{"2", "r0"}], "+", 
       SuperscriptBox["a", "2"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[CapitalSigma]", "=", 
      RowBox[{
       SuperscriptBox["r0", "2"], "+", 
       RowBox[{
        SuperscriptBox["a", "2"], 
        SuperscriptBox[
         RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Rho]", "=", 
      FractionBox[
       RowBox[{"-", "1"}], 
       RowBox[{"r0", "-", 
        RowBox[{"I", " ", "a", " ", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Rho]b", "=", 
      FractionBox[
       RowBox[{"-", "1"}], 
       RowBox[{"r0", "+", 
        RowBox[{"I", " ", "a", " ", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Beta]", "=", 
      RowBox[{
       SuperscriptBox["a", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SuperscriptBox["\[ScriptCapitalE]", "2"]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]", " ", "=", " ", 
      RowBox[{
       RowBox[{"\[ScriptCapitalE]", " ", 
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["r0", "2"], "+", 
              SuperscriptBox["a", "2"]}], ")"}], "2"], "\[CapitalDelta]"], 
          "-", 
          SuperscriptBox["a", "2"]}], ")"}]}], "+", 
       RowBox[{"a", " ", "\[ScriptCapitalL]", " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          FractionBox[
           RowBox[{
            SuperscriptBox["r0", "2"], "+", 
            SuperscriptBox["a", "2"]}], "\[CapitalDelta]"]}], ")"}]}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"\[Delta]", " ", "=", " ", 
      RowBox[{
       RowBox[{"a", " ", "\[ScriptCapitalE]", 
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           RowBox[{
            SuperscriptBox["r0", "2"], "+", 
            SuperscriptBox["a", "2"]}], "\[CapitalDelta]"], "-", "1"}], 
         ")"}]}], "-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["a", "2"], "\[ScriptCapitalL]"}], 
        "\[CapitalDelta]"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"zm", ",", "zp"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        FractionBox[
         RowBox[{
          SuperscriptBox["\[ScriptCapitalL]", "2"], "+", "\[ScriptCapitalQ]", 
          "+", "\[Beta]", "-", 
          RowBox[{"\[Beta]", " ", 
           SqrtBox[
            FractionBox[
             RowBox[{
              SuperscriptBox["\[ScriptCapitalL]", "4"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"\[ScriptCapitalQ]", "-", "\[Beta]"}], ")"}], "2"], 
              "+", 
              RowBox[{"2", " ", 
               SuperscriptBox["\[ScriptCapitalL]", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"\[ScriptCapitalQ]", "+", "\[Beta]"}], ")"}]}]}], 
             SuperscriptBox["\[Beta]", "2"]]]}]}], 
         RowBox[{"2", " ", "\[Beta]"}]], ",", 
        FractionBox[
         RowBox[{
          SuperscriptBox["\[ScriptCapitalL]", "2"], "+", "\[ScriptCapitalQ]", 
          "+", "\[Beta]", "+", 
          RowBox[{"\[Beta]", " ", 
           SqrtBox[
            FractionBox[
             RowBox[{
              SuperscriptBox["\[ScriptCapitalL]", "4"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"\[ScriptCapitalQ]", "-", "\[Beta]"}], ")"}], "2"], 
              "+", 
              RowBox[{"2", " ", 
               SuperscriptBox["\[ScriptCapitalL]", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"\[ScriptCapitalQ]", "+", "\[Beta]"}], ")"}]}]}], 
             SuperscriptBox["\[Beta]", "2"]]]}]}], 
         RowBox[{"2", " ", "\[Beta]"}]]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"z", "=", 
      RowBox[{"zm", " ", 
       SuperscriptBox[
        RowBox[{"Cos", "[", "\[Chi]", "]"}], "2"]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Theta]", "=", 
      RowBox[{"ArcCos", "[", 
       RowBox[{
        SqrtBox["zm"], " ", 
        RowBox[{"Cos", "[", "\[Chi]", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"t0", "[", "\[Chi]", "]"}], "/", 
       RowBox[{"\[Phi]0", "[", "\[Chi]", "]"}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"t0", "=", 
      RowBox[{
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"zm", "-", 
           RowBox[{"2", " ", "zp"}], "+", 
           RowBox[{"zm", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "\[Chi]"}], "]"}]}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"zm", "-", "zp"}], ")"}]}], "]"}], " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"a", "^", "2"}], " ", 
           RowBox[{"(", 
            RowBox[{"zm", "-", "zp"}], ")"}], " ", "\[ScriptCapitalE]", " ", 
           RowBox[{"EllipticE", "[", 
            RowBox[{"\[Chi]", ",", 
             RowBox[{"zm", "/", 
              RowBox[{"(", 
               RowBox[{"zm", "-", "zp"}], ")"}]}]}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"a", "^", "2"}], " ", "zp", " ", "\[ScriptCapitalE]"}], 
             "+", "\[Gamma]"}], ")"}], " ", 
           RowBox[{"EllipticF", "[", 
            RowBox[{"\[Chi]", ",", 
             RowBox[{"zm", "/", 
              RowBox[{"(", 
               RowBox[{"zm", "-", "zp"}], ")"}]}]}], "]"}]}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"Sqrt", "[", 
          RowBox[{
           RowBox[{"-", "\[Beta]"}], " ", 
           RowBox[{"(", 
            RowBox[{"zm", "-", 
             RowBox[{"2", " ", "zp"}], "+", 
             RowBox[{"zm", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"2", " ", "\[Chi]"}], "]"}]}]}], ")"}]}], "]"}], 
         ")"}]}]}]}], ";", "\n", "     ", 
     RowBox[{"\[Phi]0", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"zm", "-", 
             RowBox[{"2", " ", "zp"}], "+", 
             RowBox[{"zm", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"2", " ", "\[Chi]"}], "]"}]}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"zm", "-", "zp"}], ")"}]}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "zm"}], ")"}], " ", "\[Delta]", " ", 
            RowBox[{"EllipticF", "[", 
             RowBox[{"\[Chi]", ",", 
              RowBox[{"zm", "/", 
               RowBox[{"(", 
                RowBox[{"zm", "-", "zp"}], ")"}]}]}], "]"}]}], "-", 
           RowBox[{"\[ScriptCapitalL]", " ", 
            RowBox[{"EllipticPi", "[", 
             RowBox[{
              RowBox[{"zm", "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "zm"}], ")"}]}], ",", "\[Chi]", ",", 
              RowBox[{"zm", "/", 
               RowBox[{"(", 
                RowBox[{"zm", "-", "zp"}], ")"}]}]}], "]"}]}]}], ")"}]}], 
        ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "zm"}], ")"}], " ", 
         RowBox[{"Sqrt", "[", 
          RowBox[{
           RowBox[{"-", "\[Beta]"}], " ", 
           RowBox[{"(", 
            RowBox[{"zm", "-", 
             RowBox[{"2", " ", "zp"}], "+", 
             RowBox[{"zm", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"2", " ", "\[Chi]"}], "]"}]}]}], ")"}]}], "]"}]}], 
        ")"}]}]}], ";", "\n", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "Print", "[", 
        "\"\<Calculating Homogeneous Radial Solution, and SWSH\>\"", "]"}], 
       ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"R", " ", "=", " ", 
      RowBox[{"TeukolskyRadial", "[", 
       RowBox[{
        RowBox[{"-", "2"}], ",", "l", ",", "m", ",", "a", ",", "\[Omega]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Rup", " ", "=", " ", 
      RowBox[{"R", "[", "\"\<Up\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Rin", " ", "=", " ", 
      RowBox[{"R", "[", "\"\<In\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Bin", " ", "=", " ", 
      RowBox[{
       RowBox[{"Rin", "[", "\"\<Amplitudes\>\"", "]"}], "[", 
       "\"\<Incidence\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Bhole", " ", "=", " ", 
      RowBox[{
       RowBox[{"Rin", "[", "\"\<Amplitudes\>\"", "]"}], "[", 
       "\"\<Reflection\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Const", " ", "=", 
      RowBox[{"2", "I", " ", "\[Omega]", " ", "Bin"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"eval", " ", "=", " ", 
      RowBox[{"Rup", "[", "\"\<Eigenvalue\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"S", "  ", "=", " ", 
      RowBox[{"SpinWeightedSpheroidalHarmonicS", "[", 
       RowBox[{
        RowBox[{"-", "2"}], ",", "l", ",", "m", ",", 
        RowBox[{"a", " ", "\[Omega]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Ld2S", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Derivative", "[", 
          RowBox[{"1", ",", "0"}], "]"}], "[", "S", "]"}], "[", 
        RowBox[{"\[Theta]", ",", "0"}], "]"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", " ", "m"}], " ", 
           RowBox[{"Csc", "[", "\[Theta]", "]"}]}], "+", 
          RowBox[{"a", " ", "\[Omega]", " ", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"Cot", "[", "\[Theta]", "]"}]}]}], ")"}], 
        RowBox[{"S", "[", 
         RowBox[{"\[Theta]", ",", "0"}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Ld1Ld2S", " ", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Derivative", "[", 
          RowBox[{"2", ",", "0"}], "]"}], "[", "S", "]"}], "[", 
        RowBox[{"\[Theta]", ",", "0"}], "]"}], " ", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", " ", "m"}], " ", 
           RowBox[{"Csc", "[", "\[Theta]", "]"}]}], "+", 
          RowBox[{"a", " ", "\[Omega]", " ", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"Cot", "[", "\[Theta]", "]"}]}]}], ")"}], 
        RowBox[{
         RowBox[{
          RowBox[{"Derivative", "[", 
           RowBox[{"1", ",", "0"}], "]"}], "[", "S", "]"}], "[", 
         RowBox[{"\[Theta]", ",", "0"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", " ", "\[Omega]", " ", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", " ", 
          RowBox[{"m", " ", 
           RowBox[{"Cot", "[", "\[Theta]", "]"}], 
           RowBox[{"Csc", "[", "\[Theta]", "]"}]}], "-", 
          RowBox[{"2", 
           SuperscriptBox[
            RowBox[{"Csc", "[", "\[Theta]", "]"}], "2"]}]}], ")"}], 
        RowBox[{"S", "[", 
         RowBox[{"\[Theta]", ",", "0"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", " ", "m"}], " ", 
           RowBox[{"Csc", "[", "\[Theta]", "]"}]}], "+", 
          RowBox[{"a", " ", "\[Omega]", " ", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "+", " ", 
          RowBox[{"Cot", "[", "\[Theta]", "]"}]}], ")"}], "Ld2S"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Kf", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["r0", "2"], "+", 
          SuperscriptBox["a", "2"]}], ")"}], "\[Omega]"}], "-", 
       RowBox[{"m", " ", "a"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dK\[CapitalDelta]", "=", 
      FractionBox[
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", " ", "m", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "r0"}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["a", "2"], " ", "\[Omega]"}], "-", 
          RowBox[{
           SuperscriptBox["r0", "2"], " ", "\[Omega]"}]}], ")"}]}], 
       SuperscriptBox["\[CapitalDelta]", "2"]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "Print", "[", "\"\<Retrieving Stress-energy information\>\"", "]"}], 
       ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"CnnPlus", "=", 
      RowBox[{"source", "[", "\"\<Cnn+\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"CnmPlus", "=", 
      RowBox[{"source", "[", "\"\<Cnm+\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"CmmPlus", "=", 
      RowBox[{"source", "[", "\"\<Cmm+\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"CnnMinus", "=", 
      RowBox[{"source", "[", "\"\<Cnn-\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"CnmMinus", "=", 
      RowBox[{"source", "[", "\"\<Cnm-\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"CmmMinus", "=", 
      RowBox[{"source", "[", "\"\<Cmm-\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"d\[Theta]CnnPlus", "=", 
      RowBox[{"source", "[", "\"\<dCnn+\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"d\[Theta]CnmPlus", "=", 
      RowBox[{"source", "[", "\"\<dCnm+\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"d\[Theta]CmmPlus", "=", 
      RowBox[{"source", "[", "\"\<dCmm+\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"d\[Theta]CnnMinus", "=", 
      RowBox[{"source", "[", "\"\<dCnn-\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"d\[Theta]CnmMinus", "=", 
      RowBox[{"source", "[", "\"\<dCnm-\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"d\[Theta]CmmMinus", "=", 
      RowBox[{"source", "[", "\"\<dCmm-\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "Print", "[", 
        "\"\<Calculating \!\(\*SubscriptBox[\(A\), \(abi\)]\) terms\>\"", 
        "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Ann0Plus", "=", 
      RowBox[{
       FractionBox["1", 
        RowBox[{
         SuperscriptBox["\[CapitalDelta]", "2"], " ", 
         SuperscriptBox["\[Rho]", "3"], " ", "\[Rho]b"}]], "2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "d\[Theta]CnnPlus"}], " ", "Ld1Ld2S"}], "-", 
         RowBox[{
         "2", " ", "\[ImaginaryI]", " ", "a", " ", "CnnPlus", " ", "Ld2S", 
          " ", "\[Rho]", " ", 
          RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "-", 
         RowBox[{
         "2", " ", "\[ImaginaryI]", " ", "a", " ", "d\[Theta]CnnPlus", " ", 
          "Ld2S", " ", "\[Rho]", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "-", 
         RowBox[{
         "\[ImaginaryI]", " ", "a", " ", "CnnPlus", " ", "Ld1Ld2S", " ", 
          "\[Rho]b", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["a", "2"], " ", "CnnPlus", " ", "Ld2S", " ", 
          "\[Rho]", " ", "\[Rho]b", " ", 
          SuperscriptBox[
           RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], "-", 
         RowBox[{"a", " ", "CnnPlus", " ", "\[Rho]", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "3"}], " ", "\[ImaginaryI]", " ", "Ld1Ld2S"}], "+", 
            RowBox[{"4", " ", "a", " ", "Ld2S", " ", "\[Rho]", " ", 
             RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "+", 
         RowBox[{"CnnPlus", " ", 
          RowBox[{"S", "[", 
           RowBox[{"\[Theta]", ",", "0"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"4", " ", "\[ImaginaryI]", " ", "\[Rho]"}], "+", 
               RowBox[{"3", " ", "\[Omega]"}]}], ")"}], " ", 
             RowBox[{"Csc", "[", "\[Theta]", "]"}]}], "-", 
            RowBox[{"2", " ", "m", " ", 
             SuperscriptBox[
              RowBox[{"Cot", "[", "\[Theta]", "]"}], "2"], " ", 
             RowBox[{"Csc", "[", "\[Theta]", "]"}]}], "-", 
            RowBox[{"2", " ", "m", " ", 
             SuperscriptBox[
              RowBox[{"Csc", "[", "\[Theta]", "]"}], "3"]}], "+", 
            RowBox[{
             RowBox[{"Cot", "[", "\[Theta]", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "3"}], " ", "a", " ", "\[Omega]", " ", 
                RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
               RowBox[{"2", " ", "m", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "\[ImaginaryI]"}], " ", "a", " ", "\[Rho]"}], 
                  "+", 
                  RowBox[{"m", " ", 
                   SuperscriptBox[
                    RowBox[{"Csc", "[", "\[Theta]", "]"}], "2"]}]}], 
                 ")"}]}]}], ")"}]}], "+", 
            RowBox[{"a", " ", "\[Omega]", " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{
               "2", " ", "\[ImaginaryI]", " ", "a", " ", "\[Rho]", " ", 
                RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "-", 
               RowBox[{"2", " ", "a", " ", "\[Omega]", " ", 
                RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], ")"}], " ", 
             RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "+", 
         RowBox[{
         "2", " ", "\[ImaginaryI]", " ", "a", " ", "CnnPlus", " ", "m", " ", 
          "\[Rho]", " ", 
          RowBox[{
           SuperscriptBox["S", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"\[Theta]", ",", "0"}], "]"}]}], "+", 
         RowBox[{
         "2", " ", "a", " ", "CnnPlus", " ", "m", " ", "\[Omega]", " ", 
          RowBox[{
           SuperscriptBox["S", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"\[Theta]", ",", "0"}], "]"}]}], "-", 
         RowBox[{
         "4", " ", "\[ImaginaryI]", " ", "a", " ", "CnnPlus", " ", "\[Rho]", 
          " ", 
          RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
          RowBox[{
           SuperscriptBox["S", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"\[Theta]", ",", "0"}], "]"}]}], "-", 
         RowBox[{"6", " ", "a", " ", "CnnPlus", " ", "\[Omega]", " ", 
          RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
          RowBox[{
           SuperscriptBox["S", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"\[Theta]", ",", "0"}], "]"}]}], "-", 
         RowBox[{"2", " ", "CnnPlus", " ", 
          SuperscriptBox[
           RowBox[{"Cot", "[", "\[Theta]", "]"}], "2"], " ", 
          RowBox[{
           SuperscriptBox["S", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"\[Theta]", ",", "0"}], "]"}]}], "+", 
         RowBox[{"5", " ", "CnnPlus", " ", 
          SuperscriptBox[
           RowBox[{"Csc", "[", "\[Theta]", "]"}], "2"], " ", 
          RowBox[{
           SuperscriptBox["S", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"\[Theta]", ",", "0"}], "]"}]}], "-", 
         RowBox[{"CnnPlus", " ", 
          SuperscriptBox["m", "2"], " ", 
          SuperscriptBox[
           RowBox[{"Csc", "[", "\[Theta]", "]"}], "2"], " ", 
          RowBox[{
           SuperscriptBox["S", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"\[Theta]", ",", "0"}], "]"}]}], "-", 
         RowBox[{"2", " ", "\[ImaginaryI]", " ", 
          SuperscriptBox["a", "2"], " ", "CnnPlus", " ", "\[Rho]", " ", 
          "\[Omega]", " ", 
          SuperscriptBox[
           RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], " ", 
          RowBox[{
           SuperscriptBox["S", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"\[Theta]", ",", "0"}], "]"}]}], "-", 
         RowBox[{
          SuperscriptBox["a", "2"], " ", "CnnPlus", " ", 
          SuperscriptBox["\[Omega]", "2"], " ", 
          SuperscriptBox[
           RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], " ", 
          RowBox[{
           SuperscriptBox["S", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"\[Theta]", ",", "0"}], "]"}]}], "-", 
         RowBox[{"3", " ", "CnnPlus", " ", 
          RowBox[{"Cot", "[", "\[Theta]", "]"}], " ", 
          RowBox[{
           SuperscriptBox["S", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"2", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"\[Theta]", ",", "0"}], "]"}]}], "+", 
         RowBox[{"2", " ", "CnnPlus", " ", "m", " ", 
          RowBox[{"Csc", "[", "\[Theta]", "]"}], " ", 
          RowBox[{
           SuperscriptBox["S", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"2", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"\[Theta]", ",", "0"}], "]"}]}], "-", 
         RowBox[{
         "2", " ", "\[ImaginaryI]", " ", "a", " ", "CnnPlus", " ", "\[Rho]", 
          " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
          RowBox[{
           SuperscriptBox["S", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"2", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"\[Theta]", ",", "0"}], "]"}]}], "-", 
         RowBox[{"2", " ", "a", " ", "CnnPlus", " ", "\[Omega]", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
          RowBox[{
           SuperscriptBox["S", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"2", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"\[Theta]", ",", "0"}], "]"}]}], "-", 
         RowBox[{"CnnPlus", " ", 
          RowBox[{
           SuperscriptBox["S", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"3", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"\[Theta]", ",", "0"}], "]"}]}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Anm0Plus", "=", 
      RowBox[{
       FractionBox["1", 
        RowBox[{
         SuperscriptBox["\[CapitalDelta]", "2"], " ", 
         SuperscriptBox["\[Rho]", "3"]}]], "2", " ", 
       SqrtBox["2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "3"}], " ", "a", " ", "CnmPlus", " ", "\[Rho]", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Ld2S", " ", 
             RowBox[{"(", 
              RowBox[{"Kf", "+", 
               RowBox[{"\[ImaginaryI]", " ", "\[CapitalDelta]", " ", 
                RowBox[{"(", 
                 RowBox[{"\[Rho]", "+", "\[Rho]b"}], ")"}]}]}], ")"}]}], "+", 
            RowBox[{"\[ImaginaryI]", " ", "a", " ", "Kf", " ", 
             RowBox[{"(", 
              RowBox[{"\[Rho]", "-", "\[Rho]b"}], ")"}], " ", 
             RowBox[{"S", "[", 
              RowBox[{"\[Theta]", ",", "0"}], "]"}], " ", 
             RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "+", 
         RowBox[{"d\[Theta]CnmPlus", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", "Kf", " ", "Ld2S"}], "+", 
            RowBox[{"Ld2S", " ", "\[CapitalDelta]", " ", 
             RowBox[{"(", 
              RowBox[{"\[Rho]", "+", "\[Rho]b"}], ")"}]}], "+", 
            RowBox[{"a", " ", "Kf", " ", 
             RowBox[{"(", 
              RowBox[{"\[Rho]", "-", "\[Rho]b"}], ")"}], " ", 
             RowBox[{"S", "[", 
              RowBox[{"\[Theta]", ",", "0"}], "]"}], " ", 
             RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "+", 
         RowBox[{"CnmPlus", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a", " ", "Kf", " ", 
             RowBox[{"(", 
              RowBox[{"\[Rho]", "-", "\[Rho]b"}], ")"}], " ", 
             RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
             RowBox[{"S", "[", 
              RowBox[{"\[Theta]", ",", "0"}], "]"}]}], "+", 
            RowBox[{
            "\[ImaginaryI]", " ", "a", " ", "Ld2S", " ", "\[CapitalDelta]", 
             " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SuperscriptBox["\[Rho]", "2"], " ", 
                RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "-", 
               RowBox[{
                SuperscriptBox["\[Rho]b", "2"], " ", 
                RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "+", 
            RowBox[{"\[ImaginaryI]", " ", 
             SuperscriptBox["a", "2"], " ", "Kf", " ", 
             RowBox[{"S", "[", 
              RowBox[{"\[Theta]", ",", "0"}], "]"}], " ", 
             RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SuperscriptBox["\[Rho]", "2"], " ", 
                RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "+", 
               RowBox[{
                SuperscriptBox["\[Rho]b", "2"], " ", 
                RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "+", 
            RowBox[{"a", " ", "Kf", " ", 
             RowBox[{"(", 
              RowBox[{"\[Rho]", "-", "\[Rho]b"}], ")"}], " ", 
             RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
             RowBox[{
              SuperscriptBox["S", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"\[Theta]", ",", "0"}], "]"}]}], "-", 
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{"Kf", "+", 
               RowBox[{"\[ImaginaryI]", " ", "\[CapitalDelta]", " ", 
                RowBox[{"(", 
                 RowBox[{"\[Rho]", "+", "\[Rho]b"}], ")"}]}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"a", " ", "\[Omega]", " ", 
                   RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "+", 
                    RowBox[{"m", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], ")"}], " ", 
                   SuperscriptBox[
                    RowBox[{"Csc", "[", "\[Theta]", "]"}], "2"]}]}], ")"}], 
                " ", 
                RowBox[{"S", "[", 
                 RowBox[{"\[Theta]", ",", "0"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"2", " ", 
                   RowBox[{"Cot", "[", "\[Theta]", "]"}]}], "-", 
                  RowBox[{"m", " ", 
                   RowBox[{"Csc", "[", "\[Theta]", "]"}]}], "+", 
                  RowBox[{"a", " ", "\[Omega]", " ", 
                   RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}], " ", 
                RowBox[{
                 SuperscriptBox["S", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"\[Theta]", ",", "0"}], "]"}]}], "+", 
               RowBox[{
                SuperscriptBox["S", 
                 TagBox[
                  RowBox[{"(", 
                   RowBox[{"2", ",", "0"}], ")"}],
                  Derivative],
                 MultilineFunction->None], "[", 
                RowBox[{"\[Theta]", ",", "0"}], "]"}]}], ")"}]}]}], ")"}]}]}],
         ")"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Amm0Plus", "=", 
      RowBox[{
       FractionBox["1", 
        RowBox[{
         SuperscriptBox["\[CapitalDelta]", "2"], " ", 
         SuperscriptBox["\[Rho]", "3"]}]], "\[Rho]b", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"S", "[", 
           RowBox[{"\[Theta]", ",", "0"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a", " ", "CmmPlus", " ", "\[Rho]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "3"}], " ", "\[ImaginaryI]", " ", 
                SuperscriptBox["Kf", "2"]}], "+", 
               RowBox[{"Kf", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"6", " ", "M"}], "-", 
                  RowBox[{"6", " ", "r0"}], "+", 
                  RowBox[{"4", " ", "\[CapitalDelta]", " ", "\[Rho]"}]}], 
                 ")"}]}], "+", 
               RowBox[{
               "6", " ", "r0", " ", "\[CapitalDelta]", " ", "\[Omega]"}]}], 
              ")"}], " ", 
             RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["Kf", "2"], "+", 
               RowBox[{"2", " ", "\[ImaginaryI]", " ", "Kf", " ", 
                RowBox[{"(", 
                 RowBox[{"M", "-", "r0", "+", 
                  RowBox[{"\[CapitalDelta]", " ", "\[Rho]"}]}], ")"}]}], "+", 
               RowBox[{
               "2", " ", "\[ImaginaryI]", " ", "r0", " ", "\[CapitalDelta]", 
                " ", "\[Omega]"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"d\[Theta]CmmPlus", "-", 
               RowBox[{
               "\[ImaginaryI]", " ", "a", " ", "CmmPlus", " ", "\[Rho]b", " ", 
                RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}]}], ")"}]}],
          "+", 
         RowBox[{"CmmPlus", " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["Kf", "2"], "+", 
            RowBox[{"2", " ", "\[ImaginaryI]", " ", "Kf", " ", 
             RowBox[{"(", 
              RowBox[{"M", "-", "r0", "+", 
               RowBox[{"\[CapitalDelta]", " ", "\[Rho]"}]}], ")"}]}], "+", 
            RowBox[{
            "2", " ", "\[ImaginaryI]", " ", "r0", " ", "\[CapitalDelta]", " ",
              "\[Omega]"}]}], ")"}], " ", 
          RowBox[{
           SuperscriptBox["S", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"\[Theta]", ",", "0"}], "]"}]}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Anm1Plus", "=", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", 
         RowBox[{"\[CapitalDelta]", " ", 
          SuperscriptBox["\[Rho]", "3"]}]]}], "2", " ", 
       SqrtBox["2"], " ", 
       SuperscriptBox[
        RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"S", "[", 
           RowBox[{"\[Theta]", ",", "0"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox["a", "2"]}], " ", "CnmPlus", " ", 
             SuperscriptBox["\[Rho]b", "2"]}], "+", 
            RowBox[{"\[ImaginaryI]", " ", "a", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"d\[Theta]CnmPlus", " ", 
                RowBox[{"(", 
                 RowBox[{"\[Rho]", "-", "\[Rho]b"}], ")"}]}], "+", 
               RowBox[{"CnmPlus", " ", 
                RowBox[{"(", 
                 RowBox[{"\[Rho]", "-", "\[Rho]b", "-", 
                  RowBox[{"\[ImaginaryI]", " ", "\[Omega]"}]}], ")"}], " ", 
                RowBox[{"Cot", "[", "\[Theta]", "]"}]}]}], ")"}], " ", 
             RowBox[{"Csc", "[", "\[Theta]", "]"}]}], "+", 
            RowBox[{"CnmPlus", " ", "m", " ", 
             RowBox[{"Cot", "[", "\[Theta]", "]"}], " ", 
             SuperscriptBox[
              RowBox[{"Csc", "[", "\[Theta]", "]"}], "3"]}], "-", 
            RowBox[{"2", " ", "CnmPlus", " ", 
             SuperscriptBox[
              RowBox[{"Csc", "[", "\[Theta]", "]"}], "4"]}], "+", 
            RowBox[{
             SuperscriptBox["a", "2"], " ", "CnmPlus", " ", "\[Rho]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "\[Rho]"}], "-", 
               RowBox[{"3", " ", "\[Rho]b"}]}], ")"}], " ", 
             RowBox[{"Csc", "[", "\[Theta]", "]"}], " ", 
             RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"Csc", "[", "\[Theta]", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "3"}], " ", "\[ImaginaryI]", " ", "a", " ", 
             "CnmPlus", " ", "Ld2S", " ", "\[Rho]", " ", 
             RowBox[{"Csc", "[", "\[Theta]", "]"}], " ", 
             RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "+", 
            RowBox[{"CnmPlus", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"a", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[ImaginaryI]", " ", "\[Rho]"}], "-", 
                  RowBox[{"\[ImaginaryI]", " ", "\[Rho]b"}], "+", 
                  "\[Omega]"}], ")"}]}], "+", 
               RowBox[{"2", " ", 
                RowBox[{"Cot", "[", "\[Theta]", "]"}], " ", 
                RowBox[{"Csc", "[", "\[Theta]", "]"}]}], "-", 
               RowBox[{"m", " ", 
                SuperscriptBox[
                 RowBox[{"Csc", "[", "\[Theta]", "]"}], "2"]}]}], ")"}], " ", 
             RowBox[{
              SuperscriptBox["S", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"\[Theta]", ",", "0"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"Csc", "[", "\[Theta]", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"d\[Theta]CnmPlus", " ", "Ld2S"}], "+", 
               RowBox[{"CnmPlus", " ", 
                RowBox[{
                 SuperscriptBox["S", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"2", ",", "0"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"\[Theta]", ",", "0"}], "]"}]}]}], ")"}]}]}], 
           ")"}]}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Amm1Plus", "=", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "\[Rho]b", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"S", "[", 
             RowBox[{"\[Theta]", ",", "0"}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"a", " ", "CmmPlus", " ", "\[Rho]", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"3", " ", "Kf"}], "+", 
                 RowBox[{
                 "2", " ", "\[ImaginaryI]", " ", "\[CapitalDelta]", " ", 
                  "\[Rho]"}]}], ")"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"Kf", "+", 
                 RowBox[{
                 "\[ImaginaryI]", " ", "\[CapitalDelta]", " ", "\[Rho]"}]}], 
                ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"\[ImaginaryI]", " ", "d\[Theta]CmmPlus"}], "+", 
                 RowBox[{"a", " ", "CmmPlus", " ", "\[Rho]b", " ", 
                  RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}]}], 
             ")"}]}], "+", 
           RowBox[{"\[ImaginaryI]", " ", "CmmPlus", " ", 
            RowBox[{"(", 
             RowBox[{"Kf", "+", 
              RowBox[{
              "\[ImaginaryI]", " ", "\[CapitalDelta]", " ", "\[Rho]"}]}], 
             ")"}], " ", 
            RowBox[{
             SuperscriptBox["S", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"\[Theta]", ",", "0"}], "]"}]}]}], ")"}]}], 
        RowBox[{"\[CapitalDelta]", " ", 
         SuperscriptBox["\[Rho]", "3"]}]]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Amm2Plus", "=", 
      FractionBox[
       RowBox[{"\[Rho]b", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"S", "[", 
            RowBox[{"\[Theta]", ",", "0"}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "d\[Theta]CmmPlus"}], "+", 
             RowBox[{
             "3", " ", "\[ImaginaryI]", " ", "a", " ", "CmmPlus", " ", 
              "\[Rho]", " ", 
              RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "+", 
             RowBox[{
             "\[ImaginaryI]", " ", "a", " ", "CmmPlus", " ", "\[Rho]b", " ", 
              RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "-", 
          RowBox[{"CmmPlus", " ", 
           RowBox[{
            SuperscriptBox["S", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"\[Theta]", ",", "0"}], "]"}]}]}], ")"}]}], 
       SuperscriptBox["\[Rho]", "3"]]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Ann0Minus", "=", 
      RowBox[{
       FractionBox["1", 
        RowBox[{
         SuperscriptBox["\[CapitalDelta]", "2"], " ", 
         SuperscriptBox["\[Rho]", "3"], " ", "\[Rho]b"}]], "2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "d\[Theta]CnnMinus"}], " ", "Ld1Ld2S"}], "-", 
         RowBox[{
         "2", " ", "\[ImaginaryI]", " ", "a", " ", "CnnMinus", " ", "Ld2S", 
          " ", "\[Rho]", " ", 
          RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "-", 
         RowBox[{
         "2", " ", "\[ImaginaryI]", " ", "a", " ", "d\[Theta]CnnMinus", " ", 
          "Ld2S", " ", "\[Rho]", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "-", 
         RowBox[{
         "\[ImaginaryI]", " ", "a", " ", "CnnMinus", " ", "Ld1Ld2S", " ", 
          "\[Rho]b", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["a", "2"], " ", "CnnMinus", " ", "Ld2S", " ", 
          "\[Rho]", " ", "\[Rho]b", " ", 
          SuperscriptBox[
           RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], "-", 
         RowBox[{"a", " ", "CnnMinus", " ", "\[Rho]", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "3"}], " ", "\[ImaginaryI]", " ", "Ld1Ld2S"}], "+", 
            RowBox[{"4", " ", "a", " ", "Ld2S", " ", "\[Rho]", " ", 
             RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "+", 
         RowBox[{"CnnMinus", " ", 
          RowBox[{"S", "[", 
           RowBox[{"\[Theta]", ",", "0"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"4", " ", "\[ImaginaryI]", " ", "\[Rho]"}], "+", 
               RowBox[{"3", " ", "\[Omega]"}]}], ")"}], " ", 
             RowBox[{"Csc", "[", "\[Theta]", "]"}]}], "-", 
            RowBox[{"2", " ", "m", " ", 
             SuperscriptBox[
              RowBox[{"Cot", "[", "\[Theta]", "]"}], "2"], " ", 
             RowBox[{"Csc", "[", "\[Theta]", "]"}]}], "-", 
            RowBox[{"2", " ", "m", " ", 
             SuperscriptBox[
              RowBox[{"Csc", "[", "\[Theta]", "]"}], "3"]}], "+", 
            RowBox[{
             RowBox[{"Cot", "[", "\[Theta]", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "3"}], " ", "a", " ", "\[Omega]", " ", 
                RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
               RowBox[{"2", " ", "m", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "\[ImaginaryI]"}], " ", "a", " ", "\[Rho]"}], 
                  "+", 
                  RowBox[{"m", " ", 
                   SuperscriptBox[
                    RowBox[{"Csc", "[", "\[Theta]", "]"}], "2"]}]}], 
                 ")"}]}]}], ")"}]}], "+", 
            RowBox[{"a", " ", "\[Omega]", " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{
               "2", " ", "\[ImaginaryI]", " ", "a", " ", "\[Rho]", " ", 
                RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "-", 
               RowBox[{"2", " ", "a", " ", "\[Omega]", " ", 
                RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], ")"}], " ", 
             RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "+", 
         RowBox[{
         "2", " ", "\[ImaginaryI]", " ", "a", " ", "CnnMinus", " ", "m", " ", 
          "\[Rho]", " ", 
          RowBox[{
           SuperscriptBox["S", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"\[Theta]", ",", "0"}], "]"}]}], "+", 
         RowBox[{
         "2", " ", "a", " ", "CnnMinus", " ", "m", " ", "\[Omega]", " ", 
          RowBox[{
           SuperscriptBox["S", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"\[Theta]", ",", "0"}], "]"}]}], "-", 
         RowBox[{
         "4", " ", "\[ImaginaryI]", " ", "a", " ", "CnnMinus", " ", "\[Rho]", 
          " ", 
          RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
          RowBox[{
           SuperscriptBox["S", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"\[Theta]", ",", "0"}], "]"}]}], "-", 
         RowBox[{"6", " ", "a", " ", "CnnMinus", " ", "\[Omega]", " ", 
          RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
          RowBox[{
           SuperscriptBox["S", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"\[Theta]", ",", "0"}], "]"}]}], "-", 
         RowBox[{"2", " ", "CnnMinus", " ", 
          SuperscriptBox[
           RowBox[{"Cot", "[", "\[Theta]", "]"}], "2"], " ", 
          RowBox[{
           SuperscriptBox["S", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"\[Theta]", ",", "0"}], "]"}]}], "+", 
         RowBox[{"5", " ", "CnnMinus", " ", 
          SuperscriptBox[
           RowBox[{"Csc", "[", "\[Theta]", "]"}], "2"], " ", 
          RowBox[{
           SuperscriptBox["S", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"\[Theta]", ",", "0"}], "]"}]}], "-", 
         RowBox[{"CnnMinus", " ", 
          SuperscriptBox["m", "2"], " ", 
          SuperscriptBox[
           RowBox[{"Csc", "[", "\[Theta]", "]"}], "2"], " ", 
          RowBox[{
           SuperscriptBox["S", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"\[Theta]", ",", "0"}], "]"}]}], "-", 
         RowBox[{"2", " ", "\[ImaginaryI]", " ", 
          SuperscriptBox["a", "2"], " ", "CnnMinus", " ", "\[Rho]", " ", 
          "\[Omega]", " ", 
          SuperscriptBox[
           RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], " ", 
          RowBox[{
           SuperscriptBox["S", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"\[Theta]", ",", "0"}], "]"}]}], "-", 
         RowBox[{
          SuperscriptBox["a", "2"], " ", "CnnMinus", " ", 
          SuperscriptBox["\[Omega]", "2"], " ", 
          SuperscriptBox[
           RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], " ", 
          RowBox[{
           SuperscriptBox["S", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"\[Theta]", ",", "0"}], "]"}]}], "-", 
         RowBox[{"3", " ", "CnnMinus", " ", 
          RowBox[{"Cot", "[", "\[Theta]", "]"}], " ", 
          RowBox[{
           SuperscriptBox["S", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"2", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"\[Theta]", ",", "0"}], "]"}]}], "+", 
         RowBox[{"2", " ", "CnnMinus", " ", "m", " ", 
          RowBox[{"Csc", "[", "\[Theta]", "]"}], " ", 
          RowBox[{
           SuperscriptBox["S", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"2", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"\[Theta]", ",", "0"}], "]"}]}], "-", 
         RowBox[{
         "2", " ", "\[ImaginaryI]", " ", "a", " ", "CnnMinus", " ", "\[Rho]", 
          " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
          RowBox[{
           SuperscriptBox["S", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"2", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"\[Theta]", ",", "0"}], "]"}]}], "-", 
         RowBox[{"2", " ", "a", " ", "CnnMinus", " ", "\[Omega]", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
          RowBox[{
           SuperscriptBox["S", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"2", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"\[Theta]", ",", "0"}], "]"}]}], "-", 
         RowBox[{"CnnMinus", " ", 
          RowBox[{
           SuperscriptBox["S", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"3", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"\[Theta]", ",", "0"}], "]"}]}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Anm0Minus", "=", 
      RowBox[{
       FractionBox["1", 
        RowBox[{
         SuperscriptBox["\[CapitalDelta]", "2"], " ", 
         SuperscriptBox["\[Rho]", "3"]}]], "2", " ", 
       SqrtBox["2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "3"}], " ", "a", " ", "CnmMinus", " ", "\[Rho]", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Ld2S", " ", 
             RowBox[{"(", 
              RowBox[{"Kf", "+", 
               RowBox[{"\[ImaginaryI]", " ", "\[CapitalDelta]", " ", 
                RowBox[{"(", 
                 RowBox[{"\[Rho]", "+", "\[Rho]b"}], ")"}]}]}], ")"}]}], "+", 
            RowBox[{"\[ImaginaryI]", " ", "a", " ", "Kf", " ", 
             RowBox[{"(", 
              RowBox[{"\[Rho]", "-", "\[Rho]b"}], ")"}], " ", 
             RowBox[{"S", "[", 
              RowBox[{"\[Theta]", ",", "0"}], "]"}], " ", 
             RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "+", 
         RowBox[{"d\[Theta]CnmMinus", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", "Kf", " ", "Ld2S"}], "+", 
            RowBox[{"Ld2S", " ", "\[CapitalDelta]", " ", 
             RowBox[{"(", 
              RowBox[{"\[Rho]", "+", "\[Rho]b"}], ")"}]}], "+", 
            RowBox[{"a", " ", "Kf", " ", 
             RowBox[{"(", 
              RowBox[{"\[Rho]", "-", "\[Rho]b"}], ")"}], " ", 
             RowBox[{"S", "[", 
              RowBox[{"\[Theta]", ",", "0"}], "]"}], " ", 
             RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "+", 
         RowBox[{"CnmMinus", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a", " ", "Kf", " ", 
             RowBox[{"(", 
              RowBox[{"\[Rho]", "-", "\[Rho]b"}], ")"}], " ", 
             RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
             RowBox[{"S", "[", 
              RowBox[{"\[Theta]", ",", "0"}], "]"}]}], "+", 
            RowBox[{
            "\[ImaginaryI]", " ", "a", " ", "Ld2S", " ", "\[CapitalDelta]", 
             " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SuperscriptBox["\[Rho]", "2"], " ", 
                RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "-", 
               RowBox[{
                SuperscriptBox["\[Rho]b", "2"], " ", 
                RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "+", 
            RowBox[{"\[ImaginaryI]", " ", 
             SuperscriptBox["a", "2"], " ", "Kf", " ", 
             RowBox[{"S", "[", 
              RowBox[{"\[Theta]", ",", "0"}], "]"}], " ", 
             RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SuperscriptBox["\[Rho]", "2"], " ", 
                RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "+", 
               RowBox[{
                SuperscriptBox["\[Rho]b", "2"], " ", 
                RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "+", 
            RowBox[{"a", " ", "Kf", " ", 
             RowBox[{"(", 
              RowBox[{"\[Rho]", "-", "\[Rho]b"}], ")"}], " ", 
             RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
             RowBox[{
              SuperscriptBox["S", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"\[Theta]", ",", "0"}], "]"}]}], "-", 
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{"Kf", "+", 
               RowBox[{"\[ImaginaryI]", " ", "\[CapitalDelta]", " ", 
                RowBox[{"(", 
                 RowBox[{"\[Rho]", "+", "\[Rho]b"}], ")"}]}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"a", " ", "\[Omega]", " ", 
                   RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "+", 
                    RowBox[{"m", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], ")"}], " ", 
                   SuperscriptBox[
                    RowBox[{"Csc", "[", "\[Theta]", "]"}], "2"]}]}], ")"}], 
                " ", 
                RowBox[{"S", "[", 
                 RowBox[{"\[Theta]", ",", "0"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"2", " ", 
                   RowBox[{"Cot", "[", "\[Theta]", "]"}]}], "-", 
                  RowBox[{"m", " ", 
                   RowBox[{"Csc", "[", "\[Theta]", "]"}]}], "+", 
                  RowBox[{"a", " ", "\[Omega]", " ", 
                   RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}], " ", 
                RowBox[{
                 SuperscriptBox["S", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"\[Theta]", ",", "0"}], "]"}]}], "+", 
               RowBox[{
                SuperscriptBox["S", 
                 TagBox[
                  RowBox[{"(", 
                   RowBox[{"2", ",", "0"}], ")"}],
                  Derivative],
                 MultilineFunction->None], "[", 
                RowBox[{"\[Theta]", ",", "0"}], "]"}]}], ")"}]}]}], ")"}]}]}],
         ")"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Amm0Minus", "=", 
      RowBox[{
       FractionBox["1", 
        RowBox[{
         SuperscriptBox["\[CapitalDelta]", "2"], " ", 
         SuperscriptBox["\[Rho]", "3"]}]], "\[Rho]b", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"S", "[", 
           RowBox[{"\[Theta]", ",", "0"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a", " ", "CmmMinus", " ", "\[Rho]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "3"}], " ", "\[ImaginaryI]", " ", 
                SuperscriptBox["Kf", "2"]}], "+", 
               RowBox[{"Kf", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"6", " ", "M"}], "-", 
                  RowBox[{"6", " ", "r0"}], "+", 
                  RowBox[{"4", " ", "\[CapitalDelta]", " ", "\[Rho]"}]}], 
                 ")"}]}], "+", 
               RowBox[{
               "6", " ", "r0", " ", "\[CapitalDelta]", " ", "\[Omega]"}]}], 
              ")"}], " ", 
             RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["Kf", "2"], "+", 
               RowBox[{"2", " ", "\[ImaginaryI]", " ", "Kf", " ", 
                RowBox[{"(", 
                 RowBox[{"M", "-", "r0", "+", 
                  RowBox[{"\[CapitalDelta]", " ", "\[Rho]"}]}], ")"}]}], "+", 
               RowBox[{
               "2", " ", "\[ImaginaryI]", " ", "r0", " ", "\[CapitalDelta]", 
                " ", "\[Omega]"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"d\[Theta]CmmMinus", "-", 
               RowBox[{
               "\[ImaginaryI]", " ", "a", " ", "CmmMinus", " ", "\[Rho]b", 
                " ", 
                RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}]}], ")"}]}],
          "+", 
         RowBox[{"CmmMinus", " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["Kf", "2"], "+", 
            RowBox[{"2", " ", "\[ImaginaryI]", " ", "Kf", " ", 
             RowBox[{"(", 
              RowBox[{"M", "-", "r0", "+", 
               RowBox[{"\[CapitalDelta]", " ", "\[Rho]"}]}], ")"}]}], "+", 
            RowBox[{
            "2", " ", "\[ImaginaryI]", " ", "r0", " ", "\[CapitalDelta]", " ",
              "\[Omega]"}]}], ")"}], " ", 
          RowBox[{
           SuperscriptBox["S", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"\[Theta]", ",", "0"}], "]"}]}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Anm1Minus", "=", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", 
         RowBox[{"\[CapitalDelta]", " ", 
          SuperscriptBox["\[Rho]", "3"]}]]}], "2", " ", 
       SqrtBox["2"], " ", 
       SuperscriptBox[
        RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"S", "[", 
           RowBox[{"\[Theta]", ",", "0"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox["a", "2"]}], " ", "CnmMinus", " ", 
             SuperscriptBox["\[Rho]b", "2"]}], "+", 
            RowBox[{"\[ImaginaryI]", " ", "a", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"d\[Theta]CnmMinus", " ", 
                RowBox[{"(", 
                 RowBox[{"\[Rho]", "-", "\[Rho]b"}], ")"}]}], "+", 
               RowBox[{"CnmMinus", " ", 
                RowBox[{"(", 
                 RowBox[{"\[Rho]", "-", "\[Rho]b", "-", 
                  RowBox[{"\[ImaginaryI]", " ", "\[Omega]"}]}], ")"}], " ", 
                RowBox[{"Cot", "[", "\[Theta]", "]"}]}]}], ")"}], " ", 
             RowBox[{"Csc", "[", "\[Theta]", "]"}]}], "+", 
            RowBox[{"CnmMinus", " ", "m", " ", 
             RowBox[{"Cot", "[", "\[Theta]", "]"}], " ", 
             SuperscriptBox[
              RowBox[{"Csc", "[", "\[Theta]", "]"}], "3"]}], "-", 
            RowBox[{"2", " ", "CnmMinus", " ", 
             SuperscriptBox[
              RowBox[{"Csc", "[", "\[Theta]", "]"}], "4"]}], "+", 
            RowBox[{
             SuperscriptBox["a", "2"], " ", "CnmMinus", " ", "\[Rho]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "\[Rho]"}], "-", 
               RowBox[{"3", " ", "\[Rho]b"}]}], ")"}], " ", 
             RowBox[{"Csc", "[", "\[Theta]", "]"}], " ", 
             RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"Csc", "[", "\[Theta]", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "3"}], " ", "\[ImaginaryI]", " ", "a", " ", 
             "CnmMinus", " ", "Ld2S", " ", "\[Rho]", " ", 
             RowBox[{"Csc", "[", "\[Theta]", "]"}], " ", 
             RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "+", 
            RowBox[{"CnmMinus", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"a", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[ImaginaryI]", " ", "\[Rho]"}], "-", 
                  RowBox[{"\[ImaginaryI]", " ", "\[Rho]b"}], "+", 
                  "\[Omega]"}], ")"}]}], "+", 
               RowBox[{"2", " ", 
                RowBox[{"Cot", "[", "\[Theta]", "]"}], " ", 
                RowBox[{"Csc", "[", "\[Theta]", "]"}]}], "-", 
               RowBox[{"m", " ", 
                SuperscriptBox[
                 RowBox[{"Csc", "[", "\[Theta]", "]"}], "2"]}]}], ")"}], " ", 
             RowBox[{
              SuperscriptBox["S", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"1", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"\[Theta]", ",", "0"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"Csc", "[", "\[Theta]", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"d\[Theta]CnmMinus", " ", "Ld2S"}], "+", 
               RowBox[{"CnmMinus", " ", 
                RowBox[{
                 SuperscriptBox["S", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"2", ",", "0"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"\[Theta]", ",", "0"}], "]"}]}]}], ")"}]}]}], 
           ")"}]}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Amm1Minus", "=", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "\[Rho]b", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"S", "[", 
             RowBox[{"\[Theta]", ",", "0"}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"a", " ", "CmmMinus", " ", "\[Rho]", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"3", " ", "Kf"}], "+", 
                 RowBox[{
                 "2", " ", "\[ImaginaryI]", " ", "\[CapitalDelta]", " ", 
                  "\[Rho]"}]}], ")"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"Kf", "+", 
                 RowBox[{
                 "\[ImaginaryI]", " ", "\[CapitalDelta]", " ", "\[Rho]"}]}], 
                ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"\[ImaginaryI]", " ", "d\[Theta]CmmMinus"}], "+", 
                 RowBox[{"a", " ", "CmmMinus", " ", "\[Rho]b", " ", 
                  RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}]}], 
             ")"}]}], "+", 
           RowBox[{"\[ImaginaryI]", " ", "CmmMinus", " ", 
            RowBox[{"(", 
             RowBox[{"Kf", "+", 
              RowBox[{
              "\[ImaginaryI]", " ", "\[CapitalDelta]", " ", "\[Rho]"}]}], 
             ")"}], " ", 
            RowBox[{
             SuperscriptBox["S", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"\[Theta]", ",", "0"}], "]"}]}]}], ")"}]}], 
        RowBox[{"\[CapitalDelta]", " ", 
         SuperscriptBox["\[Rho]", "3"]}]]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Amm2Minus", "=", 
      FractionBox[
       RowBox[{"\[Rho]b", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"S", "[", 
            RowBox[{"\[Theta]", ",", "0"}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "d\[Theta]CmmMinus"}], "+", 
             RowBox[{
             "3", " ", "\[ImaginaryI]", " ", "a", " ", "CmmMinus", " ", 
              "\[Rho]", " ", 
              RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "+", 
             RowBox[{
             "\[ImaginaryI]", " ", "a", " ", "CmmMinus", " ", "\[Rho]b", " ", 
              RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "-", 
          RowBox[{"CmmMinus", " ", 
           RowBox[{
            SuperscriptBox["S", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"\[Theta]", ",", "0"}], "]"}]}]}], ")"}]}], 
       SuperscriptBox["\[Rho]", "3"]]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "\"\<Preparing integrand\>\"", "]"}], ";"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"IUpPlus", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Rup", "[", "r0", "]"}], 
        RowBox[{"(", 
         RowBox[{
         "Ann0Plus", " ", "+", " ", "Anm0Plus", " ", "+", " ", "Amm0Plus"}], 
         ")"}]}], "-", 
       RowBox[{
        RowBox[{
         RowBox[{"Rup", "'"}], "[", "r0", "]"}], 
        RowBox[{"(", 
         RowBox[{"Anm1Plus", "+", "Amm1Plus"}], ")"}]}], "+", 
       RowBox[{
        RowBox[{
         RowBox[{"Rup", "''"}], "[", "r0", "]"}], "Amm2Plus"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"IUpMinus", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Rup", "[", "r0", "]"}], 
        RowBox[{"(", 
         RowBox[{
         "Ann0Minus", " ", "+", " ", "Anm0Minus", " ", "+", " ", 
          "Amm0Minus"}], ")"}]}], "-", 
       RowBox[{
        RowBox[{
         RowBox[{"Rup", "'"}], "[", "r0", "]"}], 
        RowBox[{"(", 
         RowBox[{"Anm1Minus", "+", "Amm1Minus"}], ")"}]}], "+", 
       RowBox[{
        RowBox[{
         RowBox[{"Rup", "''"}], "[", "r0", "]"}], "Amm2Minus"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"IInPlus", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Rin", "[", "r0", "]"}], 
        RowBox[{"(", 
         RowBox[{
         "Ann0Plus", " ", "+", " ", "Anm0Plus", " ", "+", " ", "Amm0Plus"}], 
         ")"}]}], "-", 
       RowBox[{
        RowBox[{
         RowBox[{"Rin", "'"}], "[", "r0", "]"}], 
        RowBox[{"(", 
         RowBox[{"Anm1Plus", "+", "Amm1Plus"}], ")"}]}], "+", 
       RowBox[{
        RowBox[{
         RowBox[{"Rin", "''"}], "[", "r0", "]"}], "Amm2Plus"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"IInMinus", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Rin", "[", "r0", "]"}], 
        RowBox[{"(", 
         RowBox[{
         "Ann0Minus", " ", "+", " ", "Anm0Minus", " ", "+", " ", 
          "Amm0Minus"}], ")"}]}], "-", 
       RowBox[{
        RowBox[{
         RowBox[{"Rin", "'"}], "[", "r0", "]"}], 
        RowBox[{"(", 
         RowBox[{"Anm1Minus", "+", "Amm1Minus"}], ")"}]}], "+", 
       RowBox[{
        RowBox[{
         RowBox[{"Rin", "''"}], "[", "r0", "]"}], "Amm2Minus"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "\"\<Integrating\>\"", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Zin", " ", "=", " ", 
      RowBox[{"Quiet", "[", 
       RowBox[{
        FractionBox[
         RowBox[{"-", "1"}], "Const"], 
        FractionBox[
         RowBox[{"2", "\[Pi]"}], "T\[Theta]"], 
        RowBox[{"(", 
         RowBox[{"NIntegrate", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              FractionBox[
               RowBox[{"\[Gamma]", "+", 
                RowBox[{
                 SuperscriptBox["a", "2"], "\[ScriptCapitalE]", " ", "z"}]}], 
               SqrtBox[
                RowBox[{"\[Beta]", 
                 RowBox[{"(", 
                  RowBox[{"zp", "-", "z"}], ")"}]}]]], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SuperscriptBox["E", 
                  RowBox[{"I", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Omega]", " ", "t0"}], "-", 
                    RowBox[{"m", " ", "\[Phi]0"}]}], ")"}]}]], "IInPlus"}], 
                "+", 
                RowBox[{
                 SuperscriptBox["E", 
                  RowBox[{
                   RowBox[{"-", "I"}], 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Omega]", " ", "t0"}], "-", 
                    RowBox[{"m", " ", "\[Phi]0"}]}], ")"}]}]], "IInMinus"}]}],
                ")"}]}], ")"}], "/.", 
            RowBox[{"{", 
             RowBox[{"\[Chi]", "->", "\[Chi]0"}], "}"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Chi]0", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
           RowBox[{"WorkingPrecision", "\[Rule]", "\[Sigma]"}]}], "]"}], 
         RowBox[{"(*", 
          RowBox[{"+", 
           RowBox[{"NIntegrate", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                FractionBox[
                 RowBox[{"\[Gamma]", "+", 
                  RowBox[{
                   SuperscriptBox["a", "2"], "\[ScriptCapitalE]", " ", 
                   "z"}]}], 
                 SqrtBox[
                  RowBox[{"\[Beta]", 
                   RowBox[{"(", 
                    RowBox[{"zp", "-", "z"}], ")"}]}]]], 
                SuperscriptBox["E", 
                 RowBox[{
                  RowBox[{"-", "I"}], 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"\[Omega]", " ", "t0"}], "-", 
                    RowBox[{"m", " ", "\[Phi]0"}]}], ")"}]}]], "IInMinus"}], 
               ")"}], "/.", 
              RowBox[{"{", 
               RowBox[{"\[Chi]", "->", "\[Chi]0"}], "}"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Chi]0", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
             RowBox[{"WorkingPrecision", "\[Rule]", "\[Sigma]"}]}], "]"}]}], 
          "*)"}], 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
            RowBox[{"+", 
             SuperscriptBox["E", 
              RowBox[{"I", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"\[Omega]", " ", "t0\[Pi]2"}], "-", 
                 RowBox[{"m", " ", "\[Phi]0\[Pi]2"}]}], ")"}]}]]}], 
            RowBox[{"NIntegrate", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{"\[Gamma]", "+", 
                   RowBox[{
                    SuperscriptBox["a", "2"], "\[ScriptCapitalE]", " ", 
                    "z"}]}], 
                  SqrtBox[
                   RowBox[{"\[Beta]", 
                    RowBox[{"(", 
                    RowBox[{"zp", "-", "z"}], ")"}]}]]], 
                 SuperscriptBox["E", 
                  RowBox[{"I", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Omega]", " ", "t0\[Chi]m\[Pi]2"}], "-", 
                    RowBox[{"m", " ", "\[Phi]0\[Chi]m\[Pi]2"}]}], ")"}]}]], 
                 "IInPlus"}], ")"}], "/.", 
               RowBox[{"{", 
                RowBox[{"\[Chi]", "->", "\[Chi]0"}], "}"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"\[Chi]0", ",", 
                FractionBox["\[Pi]", "2"], ",", "\[Pi]"}], "}"}], ",", 
              RowBox[{"WorkingPrecision", "\[Rule]", "\[Sigma]"}]}], "]"}]}], 
           "+", 
           RowBox[{
            SuperscriptBox["E", 
             RowBox[{
              RowBox[{"-", "I"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[Omega]", " ", "t0\[Pi]2"}], "-", 
                RowBox[{"m", " ", "\[Phi]0\[Pi]2"}]}], ")"}]}]], 
            RowBox[{"NIntegrate", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{"\[Gamma]", "+", 
                   RowBox[{
                    SuperscriptBox["a", "2"], "\[ScriptCapitalE]", " ", 
                    "z"}]}], 
                  SqrtBox[
                   RowBox[{"\[Beta]", 
                    RowBox[{"(", 
                    RowBox[{"zp", "-", "z"}], ")"}]}]]], 
                 SuperscriptBox["E", 
                  RowBox[{
                   RowBox[{"-", "I"}], 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Omega]", " ", "t0\[Chi]m\[Pi]2"}], "-", 
                    RowBox[{"m", " ", "\[Phi]0\[Chi]m\[Pi]2"}]}], ")"}]}]], 
                 "IInMinus"}], ")"}], "/.", 
               RowBox[{"{", 
                RowBox[{"\[Chi]", "->", "\[Chi]0"}], "}"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"\[Chi]0", ",", 
                FractionBox["\[Pi]", "2"], ",", "\[Pi]"}], "}"}], ",", 
              RowBox[{"WorkingPrecision", "\[Rule]", "\[Sigma]"}]}], 
             "]"}]}]}], "*)"}], ")"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Zup", " ", "=", " ", 
      RowBox[{"Quiet", "[", 
       RowBox[{
        FractionBox[
         RowBox[{"-", "1"}], "Const"], 
        FractionBox[
         RowBox[{"2", "\[Pi]"}], "T\[Theta]"], 
        RowBox[{"(", 
         RowBox[{"NIntegrate", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              FractionBox[
               RowBox[{"\[Gamma]", "+", 
                RowBox[{
                 SuperscriptBox["a", "2"], "\[ScriptCapitalE]", " ", "z"}]}], 
               SqrtBox[
                RowBox[{"\[Beta]", 
                 RowBox[{"(", 
                  RowBox[{"zp", "-", "z"}], ")"}]}]]], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SuperscriptBox["E", 
                  RowBox[{"I", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Omega]", " ", "t0"}], "-", 
                    RowBox[{"m", " ", "\[Phi]0"}]}], ")"}]}]], "IUpPlus"}], 
                "+", 
                RowBox[{
                 SuperscriptBox["E", 
                  RowBox[{
                   RowBox[{"-", "I"}], 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Omega]", " ", "t0"}], "-", 
                    RowBox[{"m", " ", "\[Phi]0"}]}], ")"}]}]], "IUpMinus"}]}],
                ")"}]}], ")"}], "/.", 
            RowBox[{"{", 
             RowBox[{"\[Chi]", "->", "\[Chi]0"}], "}"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Chi]0", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
           RowBox[{"WorkingPrecision", "\[Rule]", "\[Sigma]"}]}], "]"}], 
         RowBox[{"(*", 
          RowBox[{"+", 
           RowBox[{"NIntegrate", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                FractionBox[
                 RowBox[{"\[Gamma]", "+", 
                  RowBox[{
                   SuperscriptBox["a", "2"], "\[ScriptCapitalE]", " ", 
                   "z"}]}], 
                 SqrtBox[
                  RowBox[{"\[Beta]", 
                   RowBox[{"(", 
                    RowBox[{"zp", "-", "z"}], ")"}]}]]], 
                SuperscriptBox["E", 
                 RowBox[{
                  RowBox[{"-", "I"}], 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"\[Omega]", " ", "t0"}], "-", 
                    RowBox[{"m", " ", "\[Phi]0"}]}], ")"}]}]], "IUpMinus"}], 
               ")"}], "/.", 
              RowBox[{"{", 
               RowBox[{"\[Chi]", "->", "\[Chi]0"}], "}"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Chi]0", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
             RowBox[{"WorkingPrecision", "\[Rule]", "\[Sigma]"}]}], "]"}]}], 
          "*)"}], 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
            RowBox[{"+", 
             SuperscriptBox["E", 
              RowBox[{"I", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"\[Omega]", " ", "t0\[Pi]2"}], "-", 
                 RowBox[{"m", " ", "\[Phi]0\[Pi]2"}]}], ")"}]}]]}], 
            RowBox[{"NIntegrate", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{"\[Gamma]", "+", 
                   RowBox[{
                    SuperscriptBox["a", "2"], "\[ScriptCapitalE]", " ", 
                    "z"}]}], 
                  SqrtBox[
                   RowBox[{"\[Beta]", 
                    RowBox[{"(", 
                    RowBox[{"zp", "-", "z"}], ")"}]}]]], 
                 SuperscriptBox["E", 
                  RowBox[{"I", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Omega]", " ", "t0\[Chi]m\[Pi]2"}], "-", 
                    RowBox[{"m", " ", "\[Phi]0\[Chi]m\[Pi]2"}]}], ")"}]}]], 
                 "IUpPlus"}], ")"}], "/.", 
               RowBox[{"{", 
                RowBox[{"\[Chi]", "->", "\[Chi]0"}], "}"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"\[Chi]0", ",", 
                FractionBox["\[Pi]", "2"], ",", "\[Pi]"}], "}"}], ",", 
              RowBox[{"WorkingPrecision", "\[Rule]", "\[Sigma]"}]}], "]"}]}], 
           "+", 
           RowBox[{
            SuperscriptBox["E", 
             RowBox[{
              RowBox[{"-", "I"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[Omega]", " ", "t0\[Pi]2"}], "-", 
                RowBox[{"m", " ", "\[Phi]0\[Pi]2"}]}], ")"}]}]], 
            RowBox[{"NIntegrate", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{"\[Gamma]", "+", 
                   RowBox[{
                    SuperscriptBox["a", "2"], "\[ScriptCapitalE]", " ", 
                    "z"}]}], 
                  SqrtBox[
                   RowBox[{"\[Beta]", 
                    RowBox[{"(", 
                    RowBox[{"zp", "-", "z"}], ")"}]}]]], 
                 SuperscriptBox["E", 
                  RowBox[{
                   RowBox[{"-", "I"}], 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Omega]", " ", "t0\[Chi]m\[Pi]2"}], "-", 
                    RowBox[{"m", " ", "\[Phi]0\[Chi]m\[Pi]2"}]}], ")"}]}]], 
                 "IUpMinus"}], ")"}], "/.", 
               RowBox[{"{", 
                RowBox[{"\[Chi]", "->", "\[Chi]0"}], "}"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"\[Chi]0", ",", 
                FractionBox["\[Pi]", "2"], ",", "\[Pi]"}], "}"}], ",", 
              RowBox[{"WorkingPrecision", "\[Rule]", "\[Sigma]"}]}], 
             "]"}]}]}], "*)"}], ")"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"amplitudes", " ", "=", " ", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<\[ScriptCapitalI]\>\"", "->", "Zin"}], ",", 
        RowBox[{"\"\<\[ScriptCapitalH]\>\"", "->", "Zup"}]}], "|>"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"assoc", " ", "=", " ", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<l\>\"", "->", "l"}], ",", 
        RowBox[{"\"\<m\>\"", "->", "m"}], ",", 
        RowBox[{"\"\<k\>\"", "->", "k"}], ",", 
        RowBox[{"\"\<\[Omega]\>\"", "->", "\[Omega]"}], ",", 
        RowBox[{"\"\<Eigenvalue\>\"", "->", "eval"}], ",", " ", 
        RowBox[{"\"\<Orbit\>\"", "->", "orbit"}], ",", " ", 
        RowBox[{"\"\<Amplitudes\>\"", "->", "amplitudes"}]}], "|>"}]}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.865410529115667*^9, 3.8654105306126842`*^9}, {
   3.865410734642662*^9, 3.8654108331845794`*^9}, 3.865411347638811*^9, 
   3.8654114510498505`*^9, 3.8654114852274923`*^9, {3.8654115567794724`*^9, 
   3.8654115875429907`*^9}, {3.865411720424136*^9, 3.8654117684304256`*^9}, {
   3.865413539550538*^9, 3.8654135531137495`*^9}, {3.865414332336353*^9, 
   3.8654143476366596`*^9}, {3.86541499768212*^9, 3.865415042631807*^9}, {
   3.8654150984243116`*^9, 3.865415134209221*^9}, {3.8654177526736145`*^9, 
   3.8654177686699295`*^9}, {3.8662754104287553`*^9, 
   3.8662754142344246`*^9}},ExpressionUUID->"ecce760e-a185-4cac-8070-\
8bfd8c21abb4"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Getting fluxes from amplitudes", "Subsubsection",
 CellChangeTimes->{{3.8654019783845897`*^9, 
  3.86540198491824*^9}},ExpressionUUID->"a0540c42-87cb-464b-8675-\
bed911a6dd23"],

Cell["!!! Modify this code to take 4 inputs and add them up !!!", "Text",
 CellChangeTimes->{{3.8654019966984625`*^9, 
  3.8654020201477814`*^9}},ExpressionUUID->"e9a6165b-1c28-45c0-bd68-\
2fd7f16699c8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Fluxes", "[", "amplitudes_", "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "l", ",", "m", ",", "k", ",", "\[Omega]", ",", "orbit", ",", " ", 
      "assoc", ",", "EnergyIn", ",", "EnergyOut", ",", "AngIn", ",", "AngOut",
       ",", "Zh", ",", "Zi", ",", " ", "\[Lambda]", ",", "a", " ", ",", " ", 
      "eval", ",", "rp", ",", "p", ",", "\[Epsilon]", ",", "C2", ",", 
      "\[Alpha]"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"l", "=", " ", 
      RowBox[{"amplitudes", "[", "\"\<l\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"m", " ", "=", 
      RowBox[{"amplitudes", "[", "\"\<m\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"k", " ", "=", " ", 
      RowBox[{"amplitudes", "[", "\"\<k\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Omega]", " ", "=", " ", 
      RowBox[{"amplitudes", "[", "\"\<\[Omega]\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Zi", " ", "=", " ", 
      RowBox[{
       RowBox[{"amplitudes", "[", "\"\<Amplitudes\>\"", "]"}], "[", 
       "\"\<\[ScriptCapitalH]\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Zh", " ", "=", " ", 
      RowBox[{
       RowBox[{"amplitudes", "[", "\"\<Amplitudes\>\"", "]"}], "[", 
       "\"\<\[ScriptCapitalI]\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"a", "=", " ", 
      RowBox[{
       RowBox[{"amplitudes", "[", "\"\<Orbit\>\"", "]"}], "[", "\"\<a\>\"", 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"eval", " ", "=", " ", 
      RowBox[{"amplitudes", "[", "\"\<Eigenvalue\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Lambda]", " ", "=", "eval"}], 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "a", " ", "m", " ", "\[Omega]"}], "+", 
       RowBox[{
        SuperscriptBox["a", "2"], 
        SuperscriptBox["\[Omega]", "2"]}], "-", "2"}], "*)"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"rp", " ", "=", " ", 
      RowBox[{"1", "+", 
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["a", "2"]}]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"p", " ", "=", " ", 
      RowBox[{"\[Omega]", " ", "-", " ", 
       FractionBox[
        RowBox[{"m", " ", "a"}], 
        RowBox[{"2", " ", "rp"}]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Epsilon]", " ", "=", " ", 
      FractionBox[
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["a", "2"]}]], 
       RowBox[{"4", "rp"}]]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"C2", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"\[Lambda]", "+", "2"}], ")"}], "2"], "+", 
          RowBox[{"4", " ", "a", " ", "m", " ", "\[Omega]"}], "-", 
          RowBox[{"4", 
           SuperscriptBox["a", "2"], 
           SuperscriptBox["\[Omega]", "2"]}]}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["\[Lambda]", "2"], "+", 
          RowBox[{"36", "m", " ", "a", " ", "\[Omega]"}], "-", 
          RowBox[{"36", " ", 
           SuperscriptBox["a", "2"], 
           SuperscriptBox["\[Omega]", "2"]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", "\[Lambda]"}], "+", "3"}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"96", 
           SuperscriptBox["a", "2"], 
           SuperscriptBox["\[Omega]", "2"]}], "-", 
          RowBox[{"48", "m", " ", "a", " ", "\[Omega]"}]}], ")"}]}], "+", 
       RowBox[{"144", " ", 
        SuperscriptBox["\[Omega]", "2"], 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          SuperscriptBox["a", "2"]}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"4", " ", 
         SuperscriptBox["\[Lambda]", "3"]}], "+", 
        SuperscriptBox["\[Lambda]", "4"], "+", 
        RowBox[{"48", " ", "a", " ", "\[Lambda]", " ", "\[Omega]", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"a", " ", "\[Omega]"}]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[Lambda]", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"4", "+", 
           RowBox[{"40", " ", "a", " ", "m", " ", "\[Omega]"}], "-", 
           RowBox[{"40", " ", 
            SuperscriptBox["a", "2"], " ", 
            SuperscriptBox["\[Omega]", "2"]}]}], ")"}]}], "+", 
        RowBox[{"144", " ", 
         SuperscriptBox["\[Omega]", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{
            SuperscriptBox["a", "2"], " ", 
            SuperscriptBox["m", "2"]}], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["a", "3"], " ", "m", " ", "\[Omega]"}], "+", 
           RowBox[{
            SuperscriptBox["a", "4"], " ", 
            SuperscriptBox["\[Omega]", "2"]}]}], ")"}]}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\[Alpha]", " ", "=", " ", 
      FractionBox[
       RowBox[{"256", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"2", " ", "rp"}], ")"}], "5"], "p", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["p", "2"], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["\[Epsilon]", "2"]}]}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["p", "2"], "+", 
          RowBox[{"16", 
           SuperscriptBox["\[Epsilon]", "2"]}]}], ")"}], 
        SuperscriptBox["\[Omega]", "3"]}], "C2"]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"EnergyOut", " ", "=", " ", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Abs", "[", "Zi", "]"}], "2"], 
       RowBox[{"4", "\[Pi]", " ", 
        SuperscriptBox["\[Omega]", "2"]}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"EnergyIn", " ", "=", " ", 
      FractionBox[
       RowBox[{"\[Alpha]", " ", 
        SuperscriptBox[
         RowBox[{"Abs", "[", "Zh", "]"}], "2"]}], 
       RowBox[{"4", "\[Pi]", " ", 
        SuperscriptBox["\[Omega]", "2"]}]]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"AngOut", "=", " ", 
      FractionBox[
       RowBox[{"m", " ", 
        SuperscriptBox[
         RowBox[{"Abs", "[", "Zi", "]"}], "2"]}], 
       RowBox[{"4", "\[Pi]", " ", 
        SuperscriptBox["\[Omega]", "3"]}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"AngIn", "=", 
      RowBox[{"\[Alpha]", 
       FractionBox[
        RowBox[{"m", " ", 
         SuperscriptBox[
          RowBox[{"Abs", "[", "Zh", "]"}], "2"]}], 
        RowBox[{"4", "\[Pi]", " ", 
         SuperscriptBox["\[Omega]", "3"]}]]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"assoc", " ", "=", " ", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<Energy\>\"", "->", 
         RowBox[{"<|", 
          RowBox[{
           RowBox[{"\"\<\[ScriptCapitalI]\>\"", "->", "EnergyOut"}], ",", 
           RowBox[{"\"\<\[ScriptCapitalH]\>\"", "->", "EnergyIn"}]}], 
          "|>"}]}], ",", 
        RowBox[{"\"\<AngularMomentum\>\"", "->", 
         RowBox[{"<|", 
          RowBox[{
           RowBox[{"\"\<\[ScriptCapitalI]\>\"", "->", "AngOut"}], ",", 
           RowBox[{"\"\<\[ScriptCapitalH]\>\"", "->", "AngIn"}]}], "|>"}]}]}],
        "|>"}]}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.8630715381224833`*^9, 3.863071593857103*^9}, {
   3.8630822528176765`*^9, 3.8630822533228197`*^9}, {3.8630822976028137`*^9, 
   3.8630824655858974`*^9}, {3.8630827493640633`*^9, 3.863082750001376*^9}, {
   3.863082800769936*^9, 3.86308285507769*^9}, {3.8630828898687315`*^9, 
   3.8630830037319*^9}, {3.8630830432675457`*^9, 3.863083045627942*^9}, {
   3.8630831237397814`*^9, 3.8630832223093395`*^9}, {3.863083540028936*^9, 
   3.8630835503607073`*^9}, {3.863083708251685*^9, 3.863083994345911*^9}, {
   3.863084031990288*^9, 3.8630840342924848`*^9}, {3.8630841422223597`*^9, 
   3.863084176357382*^9}, {3.86309222881538*^9, 3.8630922375792847`*^9}, {
   3.863092640553463*^9, 3.863092640890847*^9}, 3.863156844193611*^9, {
   3.86315715314026*^9, 3.8631571560903773`*^9}, {3.86316920339461*^9, 
   3.8631693125980415`*^9}, {3.8631696654308257`*^9, 
   3.8631696775959196`*^9}, {3.8631705426875076`*^9, 
   3.8631705464407735`*^9}, {3.8631707934566107`*^9, 3.863170794994735*^9}, {
   3.863170916349715*^9, 3.863170918156417*^9}, {3.8631710015514627`*^9, 
   3.8631710017861567`*^9}, {3.863171038882184*^9, 3.8631710617998867`*^9}, {
   3.863171191378767*^9, 3.863171194910915*^9}, {3.8631712462865324`*^9, 
   3.863171247376293*^9}, {3.8631713105116415`*^9, 3.8631713248338356`*^9}, {
   3.8631714354876766`*^9, 3.8631714544538765`*^9}, {3.863674065918064*^9, 
   3.8636740691294603`*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"946c72d0-e2e4-4fd7-b781-4a1396fd9e7d"]
}, Open  ]]
},
Evaluator->"local2",
WindowSize->{1141.2, 580.8},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
TaggingRules-><|"TryRealOnly" -> False|>,
FrontEndVersion->"13.0 for Microsoft Windows (64-bit) (February 4, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"67229437-3b53-45e2-92d7-dd8f13ee1183"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 381, 11, 35, "Text",ExpressionUUID->"ecbcd7f2-558d-4e34-8a9c-1a49d73942f6"],
Cell[942, 33, 233, 5, 28, "Input",ExpressionUUID->"164ca871-b8f6-4082-a520-06881cd4ed43"],
Cell[CellGroupData[{
Cell[1200, 42, 293, 5, 45, "Subsubsection",ExpressionUUID->"ffe987ed-03a8-41a4-b0f3-f49110920027"],
Cell[1496, 49, 13000, 328, 1122, "Input",ExpressionUUID->"5174a2c4-79fb-432f-acbe-f3cff5cf3533"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14533, 382, 335, 5, 45, "Subsubsection",ExpressionUUID->"275a2d89-4f47-4862-85e4-6732839700a1"],
Cell[14871, 389, 45169, 1122, 3004, "Input",ExpressionUUID->"6ac2a461-428a-44f6-a4a4-a405bac3aa14"]
}, Open  ]],
Cell[CellGroupData[{
Cell[60077, 1516, 290, 5, 45, "Subsubsection",ExpressionUUID->"0a279877-a40b-4778-aed3-118a411b2399"],
Cell[60370, 1523, 12415, 320, 1122, "Input",ExpressionUUID->"2e5bebd0-f957-40b3-a833-19256ef4691a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[72822, 1848, 285, 5, 45, "Subsubsection",ExpressionUUID->"ee314e84-787c-4545-af72-1cf992f2ee8b"],
Cell[73110, 1855, 45121, 1122, 3004, "Input",ExpressionUUID->"1fba30e2-d5de-438d-a2f0-ec1dfe3da884"]
}, Open  ]],
Cell[CellGroupData[{
Cell[118268, 2982, 285, 5, 45, "Subsubsection",ExpressionUUID->"4483f0df-3f36-4fcd-974e-1b6be54d3da6"],
Cell[118556, 2989, 17365, 449, 1461, "Input",ExpressionUUID->"243a11aa-cf3b-4b96-844d-a055d523055e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[135958, 3443, 286, 5, 45, "Subsubsection",ExpressionUUID->"5a45605e-9dfb-4cda-b8a6-434ae8c2ef3e"],
Cell[136247, 3450, 68709, 1737, 4325, "Input",ExpressionUUID->"3805722c-2194-432d-a59c-d4d1e5397718"]
}, Open  ]],
Cell[CellGroupData[{
Cell[204993, 5192, 295, 5, 45, "Subsubsection",ExpressionUUID->"1d97f17e-42fb-4217-87f3-b99cc7faf9f2"],
Cell[205291, 5199, 17535, 450, 1480, "Input",ExpressionUUID->"b1bc7c4c-cabc-43c0-8d21-a3e9b0a04a54"]
}, Open  ]],
Cell[CellGroupData[{
Cell[222863, 5654, 291, 5, 45, "Subsubsection",ExpressionUUID->"a7f7b77c-3838-4f29-9402-87f035bd1256"],
Cell[223157, 5661, 86256, 2145, 4064, "Input",ExpressionUUID->"ecce760e-a185-4cac-8070-8bfd8c21abb4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[309450, 7811, 182, 3, 45, "Subsubsection",ExpressionUUID->"a0540c42-87cb-464b-8675-bed911a6dd23"],
Cell[309635, 7816, 203, 3, 35, "Text",ExpressionUUID->"e9a6165b-1c28-45c0-bd68-2fd7f16699c8"],
Cell[309841, 7821, 9029, 215, 741, "Input",ExpressionUUID->"946c72d0-e2e4-4fd7-b781-4a1396fd9e7d"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)

